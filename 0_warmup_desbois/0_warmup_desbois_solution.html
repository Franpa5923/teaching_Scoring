<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Your NAME">

<title>Warm up - The Desbois Case study</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="0_warmup_desbois_solution_files/libs/clipboard/clipboard.min.js"></script>
<script src="0_warmup_desbois_solution_files/libs/quarto-html/quarto.js"></script>
<script src="0_warmup_desbois_solution_files/libs/quarto-html/popper.min.js"></script>
<script src="0_warmup_desbois_solution_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="0_warmup_desbois_solution_files/libs/quarto-html/anchor.min.js"></script>
<link href="0_warmup_desbois_solution_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="0_warmup_desbois_solution_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="0_warmup_desbois_solution_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="0_warmup_desbois_solution_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="0_warmup_desbois_solution_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script>
  MathJax = {
    tex: {
      tags: 'ams'  // should be 'ams', 'none', or 'all'
    }
  };
</script>

<link href="0_warmup_desbois_solution_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="0_warmup_desbois_solution_files/libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#quarto" id="toc-quarto" class="nav-link active" data-scroll-target="#quarto"><span class="header-section-number">1</span> Quarto</a></li>
  <li><a href="#running-code" id="toc-running-code" class="nav-link" data-scroll-target="#running-code"><span class="header-section-number">2</span> Running Code</a></li>
  <li><a href="#desbois-case-study" id="toc-desbois-case-study" class="nav-link" data-scroll-target="#desbois-case-study"><span class="header-section-number">3</span> Desbois case study</a>
  <ul class="collapse">
  <li><a href="#loading-data-short-exploratory-data-analysis-eda" id="toc-loading-data-short-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#loading-data-short-exploratory-data-analysis-eda"><span class="header-section-number">3.1</span> Loading data + short Exploratory Data Analysis (EDA)</a></li>
  <li><a href="#coefficient-interpretation" id="toc-coefficient-interpretation" class="nav-link" data-scroll-target="#coefficient-interpretation"><span class="header-section-number">3.2</span> Coefficient interpretation</a></li>
  <li><a href="#tests" id="toc-tests" class="nav-link" data-scroll-target="#tests"><span class="header-section-number">3.3</span> Tests</a></li>
  <li><a href="#stepwise-logistic-regression" id="toc-stepwise-logistic-regression" class="nav-link" data-scroll-target="#stepwise-logistic-regression"><span class="header-section-number">3.4</span> Stepwise Logistic Regression</a></li>
  <li><a href="#penalized-logistic-regression" id="toc-penalized-logistic-regression" class="nav-link" data-scroll-target="#penalized-logistic-regression"><span class="header-section-number">3.5</span> Penalized Logistic Regression</a></li>
  <li><a href="#model-assessment" id="toc-model-assessment" class="nav-link" data-scroll-target="#model-assessment"><span class="header-section-number">3.6</span> Model assessment</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Warm up - The Desbois Case study</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Your NAME </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="quarto" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="quarto"><span class="header-section-number">1</span> Quarto</h2>
<p>Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <a href="https://quarto.org" class="uri">https://quarto.org</a>.</p>
</section>
<section id="running-code" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="running-code"><span class="header-section-number">2</span> Running Code</h2>
<p>When you click the <strong>Render</strong> button a document will be generated that includes both content and the output of embedded code. You can embed code like this:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>You can add options to executable code like this</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>The <code>echo: false</code> option disables the printing of code (only output is displayed).</p>
</section>
<section id="desbois-case-study" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="desbois-case-study"><span class="header-section-number">3</span> Desbois case study</h2>
<section id="loading-data-short-exploratory-data-analysis-eda" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="loading-data-short-exploratory-data-analysis-eda"><span class="header-section-number">3.1</span> Loading data + short Exploratory Data Analysis (EDA)</h3>
<p>Loading Desbois data and first glimpse at it:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># package used to import spss file</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>don_desbois <span class="ot">&lt;-</span> <span class="fu">read.spss</span>(<span class="st">"../data/presentation_data/Agriculture Farm Lending/desbois.sav"</span>, <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(don_desbois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,260
Columns: 30
$ CNTY    &lt;fct&gt; Eure, Eure, Eure, Eure, Eure, Eure, Eure, Eure, Eure, Eure, Eu…
$ DIFF    &lt;fct&gt; healthy, healthy, healthy, healthy, healthy, healthy, healthy,…
$ STATUS  &lt;fct&gt; Entreprise individuelle, Entreprise individuelle, Entreprise i…
$ HECTARE &lt;dbl&gt; 166, 101, 138, 166, 137, 107, 100, 69, 176, 177, 108, 123, 87,…
$ ToF     &lt;fct&gt; cereals, cereals, dairy farm, cereals, mixed livestock, cereal…
$ OWNLAND &lt;fct&gt; yes, no, yes, yes, yes, yes, no, yes, yes, yes, yes, yes, yes,…
$ AGE     &lt;dbl&gt; 35, 35, 42, 50, 33, 45, 34, 30, 44, 39, 40, 40, 40, 52, 49, 44…
$ HARVEST &lt;fct&gt; 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988, 19…
$ r1      &lt;dbl&gt; 0.449, 0.450, 0.332, 0.363, 0.440, 0.306, 0.717, 0.566, 0.145,…
$ r2      &lt;dbl&gt; 0.622, 0.617, 0.819, 0.733, 0.650, 0.755, 0.320, 0.465, 0.881,…
$ r3      &lt;dbl&gt; 0.25500, 0.24110, 0.55680, 0.35960, 0.31420, 0.26350, 0.16280,…
$ r4      &lt;dbl&gt; 0.11450, 0.10840, 0.18510, 0.13050, 0.13820, 0.08055, 0.11680,…
$ r5      &lt;dbl&gt; 0.334, 0.341, 0.147, 0.232, 0.302, 0.225, 0.601, 0.499, 0.115,…
$ r6      &lt;dbl&gt; 0.785, 0.518, 0.700, 0.773, 0.846, 0.709, 0.894, 0.863, 0.439,…
$ r7      &lt;dbl&gt; 0.585, 0.393, 0.310, 0.495, 0.580, 0.523, 0.748, 0.761, 0.348,…
$ r8      &lt;dbl&gt; 0.20020, 0.12500, 0.38950, 0.27790, 0.26580, 0.18700, 0.14550,…
$ r11     &lt;dbl&gt; 0.6628, 0.7098, 0.4142, 0.4661, 0.7715, 0.8178, 0.6598, 0.6619…
$ r12     &lt;dbl&gt; 1.3698, 1.2534, 0.6370, 1.0698, 1.4752, 1.4682, 1.1018, 1.2360…
$ r14     &lt;dbl&gt; 0.23200, 0.14970, 0.48470, 0.37350, 0.25630, 0.18610, 0.18070,…
$ r17     &lt;dbl&gt; 0.0884, 0.0671, 0.0445, 0.0621, 0.0489, 0.0243, 0.0352, 0.0879…
$ r18     &lt;dbl&gt; 0.0694, 0.0348, 0.0311, 0.0480, 0.0414, 0.0173, 0.0315, 0.0758…
$ r19     &lt;dbl&gt; 0.1660, 0.1360, 0.1030, 0.1080, 0.1270, 0.0652, 0.1290, 0.2400…
$ r21     &lt;dbl&gt; 0.1340, 0.0802, 0.0890, 0.0851, 0.0838, 0.0390, 0.0784, 0.1630…
$ r22     &lt;dbl&gt; 0.3219, 0.3133, 0.2945, 0.1909, 0.2567, 0.1472, 0.3211, 0.5170…
$ r24     &lt;dbl&gt; 0.295, 0.365, 0.166, 0.265, 0.257, 0.191, 0.322, 0.305, 0.180,…
$ r28     &lt;dbl&gt; 0.475, 0.434, 0.350, 0.475, 0.475, 0.443, 0.401, 0.464, 0.475,…
$ r30     &lt;dbl&gt; 0.35000, 0.29780, 0.24680, 0.37590, 0.36690, 0.37590, 0.27240,…
$ r32     &lt;dbl&gt; 0.4313, 0.3989, 0.3187, 0.4313, 0.4313, 0.4257, 0.3697, 0.3886…
$ r36     &lt;dbl&gt; 0.886, 0.351, 1.300, 1.385, 0.886, 1.316, 0.441, 0.761, 2.147,…
$ r37     &lt;dbl&gt; 0.572, 0.867, 0.475, 0.470, 0.520, 0.431, 0.803, 0.656, 0.359,…</code></pre>
</div>
</div>
<p>Replacing for convenience <code>DIFF</code> target by factor <code>Y</code> with <code>O</code> (healthy) or <code>1</code> (failing):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>don_desbois <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">as.factor</span>(<span class="fu">if_else</span>(DIFF<span class="sc">==</span><span class="st">'healthy'</span>, <span class="dv">0</span>, <span class="dv">1</span>)), <span class="at">DIFF =</span> <span class="cn">NULL</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">.before =</span> <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Your turn to play</p>
<p>Using the data set at hand, try to retrieve some findings of the Desbois case study.</p>
<p>You might need <code>R</code> packages <code>FactoMineR</code>, <code>ROCR</code> and <code>MASS::lda</code> function to perform the tasks (“YOUR CODE HERE”) described in the following slides.</p>
<p>Each time I show an example of what is expected.</p>
<p>I suggest that you start using <code>Quarto</code> (setup <a href="https://quarto.org/docs/get-started/">here</a>) to code and track/publish your results. It will be requested for your projects (it is very similar to <code>RMarkdown</code>). It integrates perfectly with <code>RStudio</code>.</p>
<section id="principal-component-analysis-pca-of-financial-ratios" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="principal-component-analysis-pca-of-financial-ratios"><span class="header-section-number">3.1.1</span> Principal Component Analysis (PCA) of financial ratios</h4>
<p>First perform PCA on financial ratios (use for example package <a href="http://factominer.free.fr/factomethods/principal-components-analysis.html">FactoMineR</a>), then display correlations between ratios and the two first principal components :</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## YOUR CODE HERE #####################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># More details here http://factominer.free.fr/factomethods/principal-components-analysis.html</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>res.pca <span class="ot">=</span> FactoMineR<span class="sc">::</span><span class="fu">PCA</span>(don_desbois,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">scale.unit =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">quanti.sup =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>), <span class="co"># HECTARE / AGE excluded from Desbois analysis</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">quali.sup =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>), </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ncp =</span> <span class="dv">5</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">graph=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.pca, <span class="at">choix =</span> <span class="st">"var"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FactoMineR::dimdesc(res.pca, axes=c(1,2))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To be compared with article Figure 1</p>
<p><img src="../images/desbois_pca_projection_pc1_pc2.png" class="r-stretch img-fluid"></p>
<p>Following Desbois path, visualize the farm holdings in data set as a bivariate plot on the first two components of PCA (based on financial ratios), use variable Y (0=”healthy”; 1=”failing”) to colour your observations:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## YOUR CODE HERE #####################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Similar to Desbois Fig 2. </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of the farm holdings in the first factorial plane of the normalized PCA based on financial ratios</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># with illustrative variable Y (0=”healthy”; 1=”failing”)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>FactoMineR<span class="sc">::</span><span class="fu">plot.PCA</span>(res.pca, <span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">choix=</span><span class="st">"ind"</span>, <span class="at">habillage=</span><span class="dv">1</span>, <span class="at">invisible =</span> <span class="fu">c</span>(<span class="st">"quali"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FactoMineR::plot.PCA(res.pca, axes=c(1, 2), choix="ind", habillage=1, invisible = c("ind"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To be compared with article Figure 2</p>
<p>It strikes Desbois that the PCA (even if not a discriminative/scoring procedure), seems to do a rather good job identifying defaulting farms on the training set.</p>
<p>Disclaimer: in general it won’t be necessarily the case as PCA operates only on the predictors without “knowledge” of target variable.</p>
<p><img src="../images/desbois_pca_individuals_pc1_pc2.png" class="r-stretch img-fluid"></p>
<p>As suggested by Desbois, extract the first principal component (some help <a href="https://stats.stackexchange.com/questions/460787/pcr-after-pca-with-mixed-data-how-to-extract-export-the-pcs-as-new-variables-i">here</a>), and use it as a Scoring function.</p>
</section>
<section id="first-score" class="level4" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="first-score"><span class="header-section-number">3.1.2</span> First Score</h4>
<p>Today it will allow us to use a first Scoring function without introducing the Logistic Regression that you have not yet studied in class.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## YOUR CODE HERE #####################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/460787/pcr-after-pca-with-mixed-data-how-to-extract-export-the-pcs-as-new-variables-i</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/494866/how-to-explain-the-numerical-discrepancy-between-factominerpca-and-the-svd</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stats.stackexchange.com/questions/134282/relationship-between-svd-and-pca-how-to-use-svd-to-perform-pca</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting first five Principal components from FactomineR object </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Using FactomineR 'notation' (U,sv,V)</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># (X nxp matrix of Desbois observations (only r1...r37), SVD decomposition X = U %*% diag(vs) %*% t(V), </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># where U: unitary matrix of left-singular vectors, vs: singular values, V: unitary matrix of left-singular vectors)</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># SVD object from FactomineR res.pca$svd</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Principal components X %*% V = U %*% diag(vs) %*% t(V) %*% V = U %*% diag(vs) </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>principal_components_1 <span class="ot">&lt;-</span> res.pca<span class="sc">$</span>svd<span class="sc">$</span>U <span class="sc">%*%</span> <span class="fu">diag</span>(res.pca<span class="sc">$</span>svd<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Can also be directly extracted from:</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>principal_components_2 <span class="ot">&lt;-</span> res.pca<span class="sc">$</span>ind<span class="sc">$</span>coord</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Or using PC = X %*% V (where X has been centered and scaled</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># base R 'scale' uses a different scaling factor than FactomineR hence sqrt(n / n-1) correction)</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>X_for_PCA <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span> <span class="fu">select</span>(r1<span class="sc">:</span>r37) <span class="sc">%&gt;%</span> <span class="fu">as.matrix</span>()</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>principal_components_3 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(X_for_PCA) <span class="sc">/</span> (<span class="fu">nrow</span>(X_for_PCA) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">scale</span>(X_for_PCA) <span class="sc">%*%</span> res.pca<span class="sc">$</span>svd<span class="sc">$</span>V</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># perform svd using base R on scaled matrix</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">svd</span>(<span class="fu">scale</span>(X_for_PCA))</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co"># correct for negative signs</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>s<span class="sc">$</span>v[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)] <span class="ot">&lt;-</span> s<span class="sc">$</span>v[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> s<span class="sc">$</span>v[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>principal_components_4 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(X_for_PCA) <span class="sc">/</span> (<span class="fu">nrow</span>(X_for_PCA) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">scale</span>(X_for_PCA) <span class="sc">%*%</span> V</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below the score for each observation is the x-axis or first principal component:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>naive_score <span class="ot">&lt;-</span>  <span class="fu">bind_cols</span>(don_desbois, <span class="fu">as_tibble</span>(principal_components_2))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(naive_score) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Dim<span class="fl">.1</span>, <span class="at">y =</span> Dim<span class="fl">.2</span>, <span class="at">col =</span> Y)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dodgerblue"</span>, <span class="st">"orange"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking at this plot Desbois concludes that a simple classifier can be devised using the first PCA coordinate as a classifier (setting a threshold at <span class="math inline">\(PC_1 &gt; 0.02\)</span>):</p>
<p><img src="../images/desbois_pca_rule.png" class="r-stretch img-fluid"></p>
<p>Going further than Desbois and for illustrative purposes only, use <span class="math inline">\(PC_1\)</span> as a very naive Scoring function.</p>
</section>
<section id="first-roc-curve" class="level4" data-number="3.1.3">
<h4 data-number="3.1.3" class="anchored" data-anchor-id="first-roc-curve"><span class="header-section-number">3.1.3</span> First ROC curve</h4>
<p>Plot below the ROC curve as defined in the Scoring part of the presentation (you can use package <code>ROCR</code>, but a simple for-loop for different cutoff values <span class="math inline">\(s\)</span> will do the job):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## YOUR CODE HERE #####################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ROCR"</span>)    </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># naive score</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(naive_score<span class="sc">$</span>Dim<span class="fl">.1</span>, naive_score<span class="sc">$</span>Y)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">main=</span><span class="st">"ROC curve"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>, </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.00</span>,<span class="dv">1</span>,<span class="dv">5</span>), </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"              s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#add a 45 degree line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We follow closely the case study, but we will see that ROC curves are usually evaluated on a hold-out data set.</p>
<p>Then compare with a Scoring function obtained with Linear Discriminant Analysis (LDA). For a reminder on LDA see for example <span class="citation" data-cites="hastie2009">Hastie et al. (<a href="#ref-hastie2009" role="doc-biblioref">2009, Chapter 4.3</a> LDA, p.&nbsp;103-111)</span>.</p>
<p>You can use Desbois variables selected in the article by a stepwise procedure (using Wilk’s lambda<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>). Selected variables are:</p>
<p><img src="../images/desbois_lda_stepwise.png" class="r-stretch img-fluid"></p>
<p>So basically you can fit LDA with <code>r2+r3+r7+r14+r17+r18+r21+r32+r36</code> as predictors (I use <code>R</code> formula notation to ease your copy-paste).</p>
</section>
<section id="linear-discriminant-analysis" class="level4" data-number="3.1.4">
<h4 data-number="3.1.4" class="anchored" data-anchor-id="linear-discriminant-analysis"><span class="header-section-number">3.1.4</span> Linear Discriminant Analysis</h4>
<p>Fit LDA (<code>MASS::lda</code>) with model specification of your choice. Then display model coefficients:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## YOUR CODE HERE #####################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lda_desbois <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">lda</span>(Y<span class="sc">~</span>r2<span class="sc">+</span>r3<span class="sc">+</span>r7<span class="sc">+</span>r14<span class="sc">+</span>r17<span class="sc">+</span>r18<span class="sc">+</span>r21<span class="sc">+</span>r32<span class="sc">+</span>r36, <span class="at">data=</span>don_desbois)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(lda_desbois<span class="sc">$</span>scaling,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       LD1
r2  -2.542
r3   2.398
r7   1.099
r14  0.604
r17 18.702
r18 -6.798
r21 -0.622
r32 -4.163
r36  0.192</code></pre>
</div>
</div>
<p>Now compare the LDA Scoring function with the naive Score build with first component of PCA using a ROC curve (on training set):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## YOUR CODE HERE #####################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for ROCR</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>labels_desbois <span class="ot">&lt;-</span> don_desbois<span class="sc">$</span>Y</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># naive score</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>predictions_naive_score <span class="ot">&lt;-</span> naive_score<span class="sc">$</span>Dim<span class="fl">.1</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>naive_score_group <span class="ot">&lt;-</span> naive_score <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(Dim<span class="fl">.1</span>), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>cutoff_naive <span class="ot">&lt;-</span> <span class="fu">mean</span>(naive_score_group<span class="sc">$</span>mean_score)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predictions_naive_score, labels_desbois)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"darkolivegreen"</span>, </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(cutoff_naive), </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"                s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#add a 45 degree line</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># lda</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>predictions_lda <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_desbois)<span class="sc">$</span>x</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>lda_score_group <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(don_desbois, predictions_lda) <span class="sc">%&gt;%</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(LD1), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>cutoff_lda <span class="ot">&lt;-</span> <span class="fu">mean</span>(lda_score_group<span class="sc">$</span>mean_score)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predictions_lda, labels_desbois)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"plum4"</span>,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(cutoff_lda), </span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"                s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.6</span>,<span class="fl">0.6</span>,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">'naive - PCA'</span>, <span class="st">'LDA'</span>),</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"darkolivegreen"</span>, <span class="st">"plum4"</span>),<span class="at">lwd=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="additional-eda" class="level4" data-number="3.1.5">
<h4 data-number="3.1.5" class="anchored" data-anchor-id="additional-eda"><span class="header-section-number">3.1.5</span> Additional EDA</h4>
<p>Weplot the bivariate (scatter plots) relationships between the variable of interest and the quantitative predictors:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>vars_quanti <span class="ot">&lt;-</span> <span class="fu">names</span>(don_desbois <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var <span class="cf">in</span> vars_quanti){</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">as.name</span>(var)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">ggplot</span>(don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># filter(r17 &lt;0.14) %&gt;% </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">as.numeric</span>(Y)<span class="sc">-</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="sc">!!</span> var,<span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.1</span>, <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"binomial"</span>), </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col =</span> <span class="st">"dodgerblue"</span>)) <span class="co"># this one adda a bivariate glm fit to the plot</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-19.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-20.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-21.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-22.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-23.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-18-24.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>At first sight there seem to be outliers in the financial ratios values (for example r18, r19, r21). We can deal with that for example by winsorizing variables, in real life, if we were responsible for the data collection, it would be a good idea to investigate closely these outliers.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>don_desbois_winsorized <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(r1<span class="sc">:</span>r37, <span class="sc">~</span> DescTools<span class="sc">::</span><span class="fu">Winsorize</span>(.x , <span class="fu">quantile</span>( .x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.975</span>)))))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>vars_quanti <span class="ot">&lt;-</span> <span class="fu">names</span>(don_desbois_winsorized <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var <span class="cf">in</span> vars_quanti){</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">as.name</span>(var)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">ggplot</span>(don_desbois_winsorized <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># filter(r17 &lt;0.14) %&gt;% </span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">as.numeric</span>(Y)<span class="sc">-</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="sc">!!</span> var,<span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.1</span>, <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"binomial"</span>), </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col =</span> <span class="st">"dodgerblue"</span>))</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-19.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-20.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-21.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-22.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-23.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-19-24.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We also show the prevalence of default for each categorical variables:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>vars_quali <span class="ot">&lt;-</span> <span class="fu">names</span>(don_desbois <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.factor) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Y))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var <span class="cf">in</span> vars_quali){</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">as.name</span>(var)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">ggplot</span>(don_desbois <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">group_by</span>(<span class="sc">!!</span>var, Y) <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ungroup</span>()) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> Y, <span class="at">y =</span> count, <span class="at">fill =</span> <span class="sc">!!</span>var), <span class="at">position=</span><span class="st">"dodge"</span>,<span class="at">stat=</span><span class="st">"identity"</span>))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-20-5.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="logistic-regression" class="level4" data-number="3.1.6">
<h4 data-number="3.1.6" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">3.1.6</span> Logistic Regression</h4>
<p>As a very soft and intuitive introduction to logistic regression. First discretize a ratio <span class="math inline">\(r\)</span> of your choice.</p>
<ul>
<li>Compute proportion of defaults among each class. For example using <span class="math inline">\(0.01\)</span> steps for ratio <span class="math inline">\(r17\)</span>:</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## YOUR CODE HERE #####################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>class_width <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>don_desbois_binned <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">r17_bins =</span> <span class="fu">cut</span>(r17, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, class_width),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">dig.lab =</span> <span class="dv">4</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">floor</span>(r17 <span class="sc">/</span> class_width) <span class="sc">*</span> class_width,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">if_else</span>(r17 <span class="sc">==</span> <span class="dv">0</span> , <span class="dv">1</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># customers with 0$ balance should belong to [0, width) class</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># or be excluded</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ceiling</span>(r17 <span class="sc">/</span> class_width))  <span class="sc">*</span> class_width,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">if_else</span>(min<span class="sc">==</span>max, (<span class="fu">ceiling</span>(r17 <span class="sc">/</span> class_width) <span class="sc">+</span> <span class="dv">1</span>)  <span class="sc">*</span> class_width, max)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(r17_bins, min, max, Y) <span class="sc">%&gt;%</span> </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Y, <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Mean(Y)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="sc">/</span> (<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">0</span><span class="st">`</span>), <span class="dv">4</span>))</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(simplermarkdown<span class="sc">::</span><span class="fu">md_table</span>(don_desbois_binned <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">r17_class=</span>r17_bins, <span class="st">`</span><span class="at">0</span><span class="st">`</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span>,<span class="st">`</span><span class="at">Mean(Y)</span><span class="st">`</span> )))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>|r17_class  |0  |1 |Mean(Y)|
|-----------|---|--|-------|
|[0,0.01)   |  2| 0|0.0000 |
|[0.01,0.02)|  4| 2|0.3333 |
|[0.02,0.03)| 65|14|0.1772 |
|[0.03,0.04)|106|38|0.2639 |
|[0.04,0.05)|112|64|0.3636 |
|[0.05,0.06)|104|77|0.4254 |
|[0.06,0.07)| 88|93|0.5138 |
|[0.07,0.08)| 63|83|0.5685 |
|[0.08,0.09)| 49|66|0.5739 |
|[0.09,0.1) | 27|71|0.7245 |
|[0.1,0.11) | 14|42|0.7500 |
|[0.11,0.12)| 12|42|0.7778 |
|[0.12,0.13)|  7|14|0.6667 |
|[0.19,0.2] |  0| 1|1.0000 |</code></pre>
</div>
</div>
<ul>
<li>Then using this table, plot an empirical conditional distribution of default given <span class="math inline">\(r\)</span> classes:</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">########## YOUR CODE HERE #####################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(default_occurrence <span class="ot">&lt;-</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(don_desbois <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">if_else</span>(Y <span class="sc">==</span> <span class="st">"1"</span>, <span class="dv">1</span>, <span class="dv">0</span>)), <span class="fu">aes</span>(<span class="at">x=</span>r17, <span class="at">y=</span>Y)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">height=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_segment</span>(<span class="at">data =</span> don_desbois_binned,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">xend =</span> max, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean(Y)</span><span class="st">`</span>, <span class="at">yend =</span> <span class="st">`</span><span class="at">Mean(Y)</span><span class="st">`</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">'coral'</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth=</span><span class="fl">1.25</span>)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(default_occurrence <span class="ot">&lt;-</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(don_desbois <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">if_else</span>(Y <span class="sc">==</span> <span class="st">"1"</span>, <span class="dv">1</span>, <span class="dv">0</span>)), <span class="fu">aes</span>(<span class="at">x=</span>r17, <span class="at">y=</span>Y)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">height=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"binomial"</span>), </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">"dodgerblue"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_segment</span>(<span class="at">data =</span> don_desbois_binned,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">xend =</span> max, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean(Y)</span><span class="st">`</span>, <span class="at">yend =</span> <span class="st">`</span><span class="at">Mean(Y)</span><span class="st">`</span>),</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">'coral'</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth=</span><span class="fl">1.25</span>)) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This roughly corresponds to the intuitive introduction to the logistic regression model given in <span class="citation" data-cites="hosmer2013">Hosmer et al. (<a href="#ref-hosmer2013" role="doc-biblioref">2013</a>)</span> using a Coronary Heart Disease (CHD) event as <span class="math inline">\(Y\)</span> and AGE as <span class="math inline">\(X\)</span>:</p>
<p><img src="../images/hosmer_lemeshow_chd3.png" class="img-fluid"></p>
<p><img src="../images/hosmer_lemeshow_chd4.png" class="img-fluid"></p>
<p>Since Logistic Regression has been briefly introduced in class, you can directly apply it to the Desbois dataset using R glm() function and compare it to (i) the naive score based on PCA and (ii) the LDA using a ROC curve. You can re-use the code provided before covering the first part of Desbois case study and adapt it to your needs.</p>
<p>First fit a linear regression model, we use the same set of variables as for LDA before:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>glm_desbois <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y<span class="sc">~</span>r2<span class="sc">+</span>r3<span class="sc">+</span>r7<span class="sc">+</span>r14<span class="sc">+</span>r17<span class="sc">+</span>r18<span class="sc">+</span>r21<span class="sc">+</span>r32<span class="sc">+</span>r36,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data=</span>don_desbois, </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_desbois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r2 + r3 + r7 + r14 + r17 + r18 + r21 + r32 + 
    r36, family = binomial(link = "logit"), data = don_desbois)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -3.4203     1.2834  -2.665  0.00770 ** 
r2           -5.2156     1.2108  -4.307 1.65e-05 ***
r3            5.8347     1.2487   4.673 2.97e-06 ***
r7            2.9003     0.9530   3.043  0.00234 ** 
r14           2.1470     0.4777   4.494 6.98e-06 ***
r17          45.6847     9.6836   4.718 2.38e-06 ***
r18         -24.6368     9.1127  -2.704  0.00686 ** 
r21           1.7335     1.9481   0.890  0.37355    
r32          -5.0215     1.8907  -2.656  0.00791 ** 
r36           0.4494     0.3558   1.263  0.20661    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.1  on 1259  degrees of freedom
Residual deviance:  691.3  on 1250  degrees of freedom
AIC: 711.3

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Then add to ROC curve with Naive and LDA Scores:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for ROCR</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>labels_desbois <span class="ot">&lt;-</span> don_desbois<span class="sc">$</span>Y</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># naive score</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>predictions_naive_score <span class="ot">&lt;-</span> naive_score<span class="sc">$</span>Dim<span class="fl">.1</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>naive_score_group <span class="ot">&lt;-</span> naive_score <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(Dim<span class="fl">.1</span>), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>cutoff_naive <span class="ot">&lt;-</span> <span class="fu">mean</span>(naive_score_group<span class="sc">$</span>mean_score)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predictions_naive_score, labels_desbois)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"darkolivegreen"</span>, </span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(cutoff_naive), </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"                s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#add a 45 degree line</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># lda</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>predictions_lda <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_desbois)<span class="sc">$</span>x</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>lda_score_group <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(don_desbois, predictions_lda) <span class="sc">%&gt;%</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(LD1), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>cutoff_lda <span class="ot">&lt;-</span> <span class="fu">mean</span>(lda_score_group<span class="sc">$</span>mean_score)</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predictions_lda, labels_desbois)</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"plum4"</span>,</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(cutoff_lda), </span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"                s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="co"># glm</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>predictions_glm <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm_desbois, <span class="at">type=</span><span class="st">'response'</span>)</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>glm_score_group <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(don_desbois, <span class="fu">tibble</span>(<span class="at">pred_glm =</span>predictions_glm)) <span class="sc">%&gt;%</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(pred_glm), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>cutoff_glm <span class="ot">&lt;-</span> <span class="fu">mean</span>(glm_score_group<span class="sc">$</span>mean_score)</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predictions_glm, labels_desbois)</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"dodgerblue"</span>,</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(cutoff_glm), </span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"                s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.6</span>,<span class="fl">0.6</span>,</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">'naive - PCA'</span>, <span class="st">'LDA'</span>, <span class="st">'Logistic'</span>),</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"darkolivegreen"</span>, <span class="st">"plum4"</span>, <span class="st">"dodgerblue"</span>),<span class="at">lwd=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="coefficient-interpretation" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="coefficient-interpretation"><span class="header-section-number">3.2</span> Coefficient interpretation</h3>
<p>Fit a Logistic Regression model with all numerical variables (ie financial ratios), the “full” model:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>glm_desbois_full_numerical <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y<span class="sc">~</span>., <span class="at">data =</span> don_desbois <span class="sc">%&gt;%</span> <span class="fu">select</span>(Y, r1<span class="sc">:</span>r37), <span class="at">family=</span><span class="fu">binomial</span>())</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_desbois_full_numerical)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ ., family = binomial(), data = don_desbois %&gt;% 
    select(Y, r1:r37))

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -11.6932     4.3190  -2.707  0.00678 ** 
r1           24.5373     8.3017   2.956  0.00312 ** 
r2            2.3209     3.5047   0.662  0.50783    
r3            4.3735     1.8713   2.337  0.01943 *  
r4          -10.1236     7.7739  -1.302  0.19283    
r5          -13.4190     8.4799  -1.582  0.11355    
r6           -1.1654     1.6788  -0.694  0.48754    
r7            2.0817     1.9851   1.049  0.29433    
r8           -2.6752     2.0528  -1.303  0.19251    
r11          -1.0817     2.3500  -0.460  0.64529    
r12           1.5486     1.6158   0.958  0.33786    
r14           2.3297     0.7781   2.994  0.00275 ** 
r17          39.0878     9.9563   3.926 8.64e-05 ***
r18         -10.0287    17.5203  -0.572  0.56705    
r19           2.3088    10.8064   0.214  0.83082    
r21           1.1110     3.9905   0.278  0.78070    
r22           1.2595     1.8532   0.680  0.49674    
r24           2.2843     5.6556   0.404  0.68629    
r28         -12.1249    11.6916  -1.037  0.29971    
r30           7.8600    11.1415   0.705  0.48052    
r32          -1.8340    13.9176  -0.132  0.89516    
r36           1.4477     0.4830   2.998  0.00272 ** 
r37          -2.1438     1.7772  -1.206  0.22772    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.1  on 1259  degrees of freedom
Residual deviance:  658.5  on 1237  degrees of freedom
AIC: 704.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Outliers in the predictors variables might cause some observations to have “fitted” probabilities close to 0 or 1, hence the R warning <code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code>, removing outliers suppress this issues, but be careful with outliers handling:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>glm_desbois_full_numerical_winsorized <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y<span class="sc">~</span>., <span class="at">data =</span> don_desbois_winsorized <span class="sc">%&gt;%</span> <span class="fu">select</span>(Y, r1<span class="sc">:</span>r37), <span class="at">family=</span><span class="fu">binomial</span>())</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_desbois_full_numerical_winsorized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ ., family = binomial(), data = don_desbois_winsorized %&gt;% 
    select(Y, r1:r37))

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -7.7408     4.5503  -1.701 0.088915 .  
r1           22.2446     6.8513   3.247 0.001167 ** 
r2            1.2029     3.4219   0.352 0.725181    
r3            4.8066     1.9240   2.498 0.012480 *  
r4           -9.0442     6.1639  -1.467 0.142299    
r5          -14.6224     6.9676  -2.099 0.035848 *  
r6           -3.6401     2.6044  -1.398 0.162207    
r7            5.8377     2.6467   2.206 0.027410 *  
r8           -1.2013     2.6146  -0.459 0.645915    
r11          -1.8916     2.8381  -0.667 0.505073    
r12           1.2232     1.7691   0.691 0.489306    
r14           2.0621     0.8273   2.493 0.012680 *  
r17          37.9337    10.2180   3.712 0.000205 ***
r18          -2.2717    16.9432  -0.134 0.893343    
r19          -7.6231     9.0157  -0.846 0.397811    
r21           0.8608     4.9150   0.175 0.860974    
r22           1.5161     1.9245   0.788 0.430829    
r24           2.2421     5.7650   0.389 0.697345    
r28          -8.0490    13.2906  -0.606 0.544772    
r30          -1.2788     9.3390  -0.137 0.891087    
r32           4.1720    17.1462   0.243 0.807757    
r36           0.4984     0.6532   0.763 0.445494    
r37          -3.9866     2.4017  -1.660 0.096926 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.1  on 1259  degrees of freedom
Residual deviance:  668.7  on 1237  degrees of freedom
AIC: 714.7

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>Using the “full” Logistic Regression model with all variables in data set, interpret the <code>r17</code> coefficient:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The coefficient of <code>r17</code> is 39.09. Hence an increase of <code>r17</code> by 1% increases odds for default by a factor of 1.48. Since we are dealing with a ratio and coefficient is rather large, we use 1% as our unit “bump” for the ratio.</p>
</section>
<section id="tests" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="tests"><span class="header-section-number">3.3</span> Tests</h3>
<p>Considering this “full” model Y~r1+…+r37, is the effect of variable r36 significant? Using Wald test. Using Likelihood Ratio Test.</p>
<p>Considering the model <code>Y~.</code>, is the effect of variable <code>r36</code> significant? Using Wald test. Using Likelihood Ratio Test.</p>
<section id="wald" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="wald"><span class="header-section-number">3.3.1</span> Wald</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking at summary outputs</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>(sum_desbois <span class="ot">&lt;-</span> <span class="fu">summary</span>(glm_desbois_full_numerical))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ ., family = binomial(), data = don_desbois %&gt;% 
    select(Y, r1:r37))

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -11.6932     4.3190  -2.707  0.00678 ** 
r1           24.5373     8.3017   2.956  0.00312 ** 
r2            2.3209     3.5047   0.662  0.50783    
r3            4.3735     1.8713   2.337  0.01943 *  
r4          -10.1236     7.7739  -1.302  0.19283    
r5          -13.4190     8.4799  -1.582  0.11355    
r6           -1.1654     1.6788  -0.694  0.48754    
r7            2.0817     1.9851   1.049  0.29433    
r8           -2.6752     2.0528  -1.303  0.19251    
r11          -1.0817     2.3500  -0.460  0.64529    
r12           1.5486     1.6158   0.958  0.33786    
r14           2.3297     0.7781   2.994  0.00275 ** 
r17          39.0878     9.9563   3.926 8.64e-05 ***
r18         -10.0287    17.5203  -0.572  0.56705    
r19           2.3088    10.8064   0.214  0.83082    
r21           1.1110     3.9905   0.278  0.78070    
r22           1.2595     1.8532   0.680  0.49674    
r24           2.2843     5.6556   0.404  0.68629    
r28         -12.1249    11.6916  -1.037  0.29971    
r30           7.8600    11.1415   0.705  0.48052    
r32          -1.8340    13.9176  -0.132  0.89516    
r36           1.4477     0.4830   2.998  0.00272 ** 
r37          -2.1438     1.7772  -1.206  0.22772    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.1  on 1259  degrees of freedom
Residual deviance:  658.5  on 1237  degrees of freedom
AIC: 704.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing the r36 coefficient (Terms = 22)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>aod<span class="sc">::</span><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(glm_desbois_full_numerical), <span class="at">Sigma =</span> <span class="fu">vcov</span>(glm_desbois_full_numerical), <span class="at">Terms =</span> <span class="dv">22</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 9.0, df = 1, P(&gt; X2) = 0.0027</code></pre>
</div>
</div>
<p>Manually</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># manually computing from beta/hessian</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>beta_r17 <span class="ot">&lt;-</span> sum_desbois<span class="sc">$</span>coefficients[<span class="dv">22</span>,<span class="dv">1</span>]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>stdev_r17 <span class="ot">&lt;-</span> sum_desbois<span class="sc">$</span>coefficients[<span class="dv">22</span>,<span class="dv">2</span>]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>wald <span class="ot">&lt;-</span> beta_r17 <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> stdev_r17 <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(wald, <span class="at">df =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002721819</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>z_val <span class="ot">&lt;-</span> sum_desbois<span class="sc">$</span>coefficients[<span class="dv">22</span>,<span class="dv">3</span>]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>z_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.997525</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(z_val)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002721819</code></pre>
</div>
</div>
<p>With the usual p-value levels in mind (e.g.&nbsp;at the <span class="math inline">\(\alpha = 0.05\)</span> level), the Wald test indicates that variable <code>r36</code> has a statistically significant effect on the outcome (<span class="math inline">\(p\approx0.003 \ll0.05\)</span>).</p>
</section>
<section id="lrt" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="lrt"><span class="header-section-number">3.3.2</span> LRT</h4>
<p>Is the effect of variable <code>r36</code> significant? Using Likelihood Ratio Test.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We fit a model removing the <code>r36</code> ratio and compare to the “full” model:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using anova on two models (with/without  r36)</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>glm_desbois_wo_r36 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y<span class="sc">~</span>., <span class="at">data =</span> don_desbois <span class="sc">%&gt;%</span> <span class="fu">select</span>(Y,r1<span class="sc">:</span>r37) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>r36), <span class="at">family=</span><span class="fu">binomial</span>())</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(glm_desbois_wo_r36, glm_desbois_full_numerical, <span class="at">test=</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1238","2":"667.7395","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"1237","2":"658.4951","3":"1","4":"9.244425","5":"0.002362135","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>With the usual p-value levels in mind (e.g.&nbsp;at the <span class="math inline">\(\alpha = 0.05\)</span> level), the Likelihood Ratio test (LRT) indicates that variable <code>r36</code> has a statistically significant effect on the outcome (<span class="math inline">\(p\approx0.002 \ll0.05\)</span>).</p>
<p>We redo the same manually:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>LRT <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(glm_desbois_full_numerical)<span class="sc">-</span><span class="fu">logLik</span>(glm_desbois_wo_r36))</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(LRT, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>scales<span class="sc">::</span><span class="fu">scientific</span>(pval, <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2.36e-03"</code></pre>
</div>
</div>
<p>Now fit a “smaller” model removing 5/10 ratios of your choice. Use Likelihood Ratio Test to test if the “full” model fits significantly better than the “smaller” one. We reuse here the model fitted before with variables selected by Desbois for the LDA <code>r2+r3+r7+r14+r17+r18+r21+r32+r36</code>:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_desbois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r2 + r3 + r7 + r14 + r17 + r18 + r21 + r32 + 
    r36, family = binomial(link = "logit"), data = don_desbois)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -3.4203     1.2834  -2.665  0.00770 ** 
r2           -5.2156     1.2108  -4.307 1.65e-05 ***
r3            5.8347     1.2487   4.673 2.97e-06 ***
r7            2.9003     0.9530   3.043  0.00234 ** 
r14           2.1470     0.4777   4.494 6.98e-06 ***
r17          45.6847     9.6836   4.718 2.38e-06 ***
r18         -24.6368     9.1127  -2.704  0.00686 ** 
r21           1.7335     1.9481   0.890  0.37355    
r32          -5.0215     1.8907  -2.656  0.00791 ** 
r36           0.4494     0.3558   1.263  0.20661    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.1  on 1259  degrees of freedom
Residual deviance:  691.3  on 1250  degrees of freedom
AIC: 711.3

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using anova on two models (desbois selection/full)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(glm_desbois, glm_desbois_full_numerical, <span class="at">test=</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1250","2":"691.3008","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"1237","2":"658.4951","3":"13","4":"32.80574","5":"0.001822178","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The likelihood ratio test indicates that the full model (22 variables) provides a significantly better fit than the reduced/Desbois model (9 variables) at the <span class="math inline">\(\alpha = 0.05\)</span> level (<span class="math inline">\(p = 0.001822 \ll0.05\)</span>).</p>
</section>
<section id="hosmer-lemeshow" class="level4" data-number="3.3.3">
<h4 data-number="3.3.3" class="anchored" data-anchor-id="hosmer-lemeshow"><span class="header-section-number">3.3.3</span> Hosmer &amp; Lemeshow</h4>
<p>Perform a goodness of fit test (Hosmer and Lemeshow test) and a calibration plot on “full” model, compare.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>glmtoolbox<span class="sc">::</span><span class="fu">hltest</span>(glm_desbois_full_numerical)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   The Hosmer-Lemeshow goodness-of-fit test

 Group Size Observed    Expected
     1  126        1   0.8838296
     2  126        2   2.9289017
     3  126       11   7.1240848
     4  126       10  14.7709480
     5  126       30  33.4933568
     6  126       74  71.1015354
     7  126      106 104.7254349
     8  126      122 120.9494625
     9  126      126 125.0904116
    10  126      125 125.9320347

         Statistic =  19.08915 
degrees of freedom =  8 
           p-value =  0.01439 </code></pre>
</div>
</div>
<p>Here the p-value for a chi-squared statistic of <span class="math inline">\(H=19.1\)</span> with <span class="math inline">\(df=Q-2=8\)</span> is <span class="math inline">\(p=0.015\)</span> which is bellow the usual levels (eg <span class="math inline">\(\alpha=0.05\)</span>), so that the null hypothesis is rejected, goodness of fit is not acceptable according to the H&amp;L test at this level.</p>
<p>We fit a reduced model, and use winsorization:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>glm_desbois_winsorized <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y<span class="sc">~</span>r2<span class="sc">+</span>r3<span class="sc">+</span>r7<span class="sc">+</span>r14<span class="sc">+</span>r17<span class="sc">+</span>r18<span class="sc">+</span>r32<span class="sc">+</span>r36,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data=</span>don_desbois_winsorized, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_desbois_winsorized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r2 + r3 + r7 + r14 + r17 + r18 + r32 + r36, 
    family = binomial(link = "logit"), data = don_desbois_winsorized)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -3.41897    1.19213  -2.868 0.004132 ** 
r2           -4.06723    1.18944  -3.419 0.000627 ***
r3            5.40790    1.26367   4.280 1.87e-05 ***
r7            3.39742    0.96720   3.513 0.000444 ***
r14           2.36394    0.49065   4.818 1.45e-06 ***
r17          43.05837    9.35192   4.604 4.14e-06 ***
r18         -17.09394    7.86801  -2.173 0.029811 *  
r32          -6.51305    1.13925  -5.717 1.08e-08 ***
r36           0.04673    0.38882   0.120 0.904344    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  696.26  on 1251  degrees of freedom
AIC: 714.26

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>glmtoolbox<span class="sc">::</span><span class="fu">hltest</span>(glm_desbois_winsorized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   The Hosmer-Lemeshow goodness-of-fit test

 Group Size Observed   Expected
     1  126        1   1.319479
     2  126        2   3.627628
     3  126       12   7.936859
     4  126       11  15.630944
     5  126       31  34.581217
     6  126       76  70.838088
     7  126      104 102.838586
     8  126      122 119.714895
     9  126      123 124.672980
    10  126      125 125.839324

         Statistic =  13.45398 
degrees of freedom =  8 
           p-value =  0.097155 </code></pre>
</div>
</div>
<p>Here the p-value for a chi-squared statistic of <span class="math inline">\(H=13.5\)</span> with <span class="math inline">\(df=Q-2=8\)</span> is <span class="math inline">\(p=0.097\)</span> which is above the usual levels (eg <span class="math inline">\(\alpha=0.05\)</span>), so that the null hypothesis is not rejected, goodness of fit is acceptable according to the H&amp;L test at this level.</p>
<p>Below a graphical exploration of fitted vs observed probabilities tends to indicate a good overall calibration, except maybe for some deciles were observed default probabilities or events are very rare and estimated probabilities might be overestimated:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>check_default_prob <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">cbind</span>(<span class="at">fitted=</span>glm_desbois_full_numerical<span class="sc">$</span>fitted.values,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">Y =</span> don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">if_else</span>(Y <span class="sc">==</span> <span class="st">"1"</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">pull</span>(Y)))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>(calibration_data <span class="ot">&lt;-</span> check_default_prob <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bins_prob =</span> <span class="fu">cut</span>(fitted, <span class="at">breaks =</span> <span class="fu">quantile</span>(fitted,<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.10</span>)), <span class="at">include.lowest =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bins_prob) <span class="sc">%&gt;%</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">def =</span> <span class="fu">sum</span>(Y),</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">no_def =</span> n <span class="sc">-</span> def,  </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">predict_prob =</span> <span class="fu">mean</span>(fitted),</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">real_prob =</span> def<span class="sc">/</span>n,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">forecast_acc =</span> def <span class="sc">/</span> <span class="fu">sum</span>(check_default_prob<span class="sc">$</span>Y)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["bins_prob"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["def"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["no_def"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["predict_prob"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["real_prob"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["forecast_acc"],"name":[7],"type":["dbl"],"align":["right"]}],"data":[{"1":"[5.18e-05,0.013]","2":"126","3":"1","4":"125","5":"0.007014521","6":"0.007936508","7":"0.001647446"},{"1":"(0.013,0.0357]","2":"126","3":"2","4":"124","5":"0.023245251","6":"0.015873016","7":"0.003294893"},{"1":"(0.0357,0.0813]","2":"126","3":"11","4":"115","5":"0.056540355","6":"0.087301587","7":"0.018121911"},{"1":"(0.0813,0.169]","2":"126","3":"10","4":"116","5":"0.117229746","6":"0.079365079","7":"0.016474465"},{"1":"(0.169,0.402]","2":"126","3":"30","4":"96","5":"0.265820292","6":"0.238095238","7":"0.049423394"},{"1":"(0.402,0.721]","2":"126","3":"74","4":"52","5":"0.564297900","6":"0.587301587","7":"0.121911038"},{"1":"(0.721,0.928]","2":"126","3":"106","4":"20","5":"0.831154245","6":"0.841269841","7":"0.174629325"},{"1":"(0.928,0.983]","2":"126","3":"122","4":"4","5":"0.959916369","6":"0.968253968","7":"0.200988468"},{"1":"(0.983,0.998]","2":"126","3":"126","4":"0","5":"0.992781045","6":"1.000000000","7":"0.207578254"},{"1":"(0.998,1]","2":"126","3":"125","4":"1","5":"0.999460593","6":"0.992063492","7":"0.205930807"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(calib_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(calibration_data, <span class="fu">aes</span>(<span class="at">x =</span> predict_prob, <span class="at">y =</span> real_prob)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="stepwise-logistic-regression" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="stepwise-logistic-regression"><span class="header-section-number">3.4</span> Stepwise Logistic Regression</h3>
<p>Use forward stepwise selection based on the AIC criterion to select variables in the Agriculture Farm Lending data set. Compare with results from the article.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We first define lower (intercept only) / upper (all variables) bound models for the stepwise approaches:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define intercept-only model</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>intercept_only <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>don_desbois, <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co">#define model with all predictors</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># In Desbois only financial ratios are used</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>don_desbois <span class="sc">%&gt;%</span> <span class="fu">select</span>(Y, <span class="fu">starts_with</span>(<span class="st">'r'</span>)), <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We use all variables</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># all &lt;- glm(Y ~ ., data=don_desbois , family="binomial")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then we use the <code>stats::step()</code> function to perform a forward stepwise selection based on AIC:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform forward stepwise regression</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>forward_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r21 + r14 + r17 + r24 + r11 + r28 + r36 + 
    r3 + r8 + r32, family = "binomial", data = don_desbois)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -11.1573     1.3883  -8.036 9.25e-16 ***
r1           10.3995     1.1853   8.773  &lt; 2e-16 ***
r21           3.9664     1.5931   2.490 0.012787 *  
r14           2.4414     0.6955   3.510 0.000448 ***
r17          36.0464     7.2134   4.997 5.82e-07 ***
r24          -4.1232     2.8366  -1.454 0.146058    
r11           1.4347     0.5289   2.713 0.006677 ** 
r28         -18.1295     6.1484  -2.949 0.003191 ** 
r36           1.5231     0.3888   3.917 8.95e-05 ***
r3            5.4959     1.2741   4.313 1.61e-05 ***
r8           -3.3793     0.9457  -3.573 0.000353 ***
r32          16.5696     6.9327   2.390 0.016846 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  666.58  on 1248  degrees of freedom
AIC: 690.58

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>We do the same manually (ie step by step) performing a likelihood-ratio-test-based forward selection (as described in Desbois) using only financial ratios as predictors.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>don_desbois <span class="sc">%&gt;%</span> <span class="fu">select</span>(Y, <span class="fu">starts_with</span>(<span class="st">'r'</span>)), <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>first_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(intercept_only, <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>first_step <span class="ot">&lt;-</span> first_step <span class="sc">%&gt;%</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(first_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>first_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"957.1207","3":"961.1207","4":"787.930453","5":"2.271029e-173","6":"r1"},{"1":"1","2":"979.8111","3":"983.8111","4":"765.240084","5":"1.948510e-168","6":"r14"},{"1":"1","2":"996.7790","3":"1000.7790","4":"748.272179","5":"9.529992e-165","6":"r21"},{"1":"1","2":"1094.0080","3":"1098.0080","4":"651.043122","5":"1.325113e-143","6":"r4"},{"1":"1","2":"1099.0846","3":"1103.0846","4":"645.966552","5":"1.683879e-142","6":"r8"},{"1":"1","2":"1122.7900","3":"1126.7900","4":"622.261169","5":"2.409697e-137","6":"r18"},{"1":"1","2":"1143.0811","3":"1147.0811","4":"601.970103","5":"6.241473e-133","6":"r2"},{"1":"1","2":"1157.5879","3":"1161.5879","4":"587.463287","5":"8.926507e-130","6":"r6"},{"1":"1","2":"1176.6167","3":"1180.6167","4":"568.434438","5":"1.229899e-125","6":"r22"},{"1":"1","2":"1185.1868","3":"1189.1868","4":"559.864405","5":"8.997366e-124","6":"r30"},{"1":"1","2":"1227.0902","3":"1231.0902","4":"517.960998","5":"1.175318e-114","6":"r12"},{"1":"1","2":"1236.4510","3":"1240.4510","4":"508.600165","5":"1.278732e-112","6":"r32"},{"1":"1","2":"1246.9621","3":"1250.9621","4":"498.089044","5":"2.476038e-110","6":"r11"},{"1":"1","2":"1333.1735","3":"1337.1735","4":"411.877702","5":"1.430215e-91","6":"r19"},{"1":"1","2":"1456.0679","3":"1460.0679","4":"288.983300","5":"8.281089e-65","6":"r5"},{"1":"1","2":"1527.5665","3":"1531.5665","4":"217.484620","5":"3.199383e-49","6":"r7"},{"1":"1","2":"1537.6651","3":"1541.6651","4":"207.386057","5":"5.107058e-47","6":"r28"},{"1":"1","2":"1601.0416","3":"1605.0416","4":"144.009517","5":"3.535983e-33","6":"r17"},{"1":"1","2":"1649.0260","3":"1653.0260","4":"96.025159","5":"1.134328e-22","6":"r3"},{"1":"1","2":"1687.0062","3":"1691.0062","4":"58.044990","5":"2.561911e-14","6":"r24"},{"1":"1","2":"1732.8183","3":"1736.8183","4":"12.232807","5":"4.695650e-04","6":"r36"},{"1":"1","2":"1741.5564","3":"1745.5564","4":"3.494776","5":"6.156273e-02","6":"r37"},{"1":"NA","2":"1745.0512","3":"1747.0512","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r1</code> is the most significant variable in the first step based on likelihood-ratio-test.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>second_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>second_step <span class="ot">&lt;-</span> second_step <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(second_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>second_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"804.2745","3":"810.2745","4":"152.84620341","5":"4.138901e-35","6":"r21"},{"1":"1","2":"808.7077","3":"814.7077","4":"148.41297717","5":"3.853515e-34","6":"r14"},{"1":"1","2":"827.4681","3":"833.4681","4":"129.65259808","5":"4.881554e-30","6":"r32"},{"1":"1","2":"849.7753","3":"855.7753","4":"107.34537171","5":"3.739741e-25","6":"r30"},{"1":"1","2":"859.5723","3":"865.5723","4":"97.54842247","5":"5.255521e-23","6":"r8"},{"1":"1","2":"865.1162","3":"871.1162","4":"92.00450830","5":"8.647924e-22","6":"r22"},{"1":"1","2":"867.9351","3":"873.9351","4":"89.18563643","5":"3.594493e-21","6":"r18"},{"1":"1","2":"872.8613","3":"878.8613","4":"84.25936934","5":"4.339421e-20","6":"r24"},{"1":"1","2":"879.5250","3":"885.5250","4":"77.59569985","5":"1.264451e-18","6":"r12"},{"1":"1","2":"881.8596","3":"887.8596","4":"75.26106459","5":"4.124127e-18","6":"r28"},{"1":"1","2":"887.3773","3":"893.3773","4":"69.74343381","5":"6.754232e-17","6":"r3"},{"1":"1","2":"888.1494","3":"894.1494","4":"68.97128628","5":"9.990749e-17","6":"r5"},{"1":"1","2":"890.2218","3":"896.2218","4":"66.89894831","5":"2.857873e-16","6":"r2"},{"1":"1","2":"890.6350","3":"896.6350","4":"66.48571485","5":"3.524385e-16","6":"r4"},{"1":"1","2":"892.1319","3":"898.1319","4":"64.98884361","5":"7.532331e-16","6":"r11"},{"1":"1","2":"892.7739","3":"898.7739","4":"64.34684801","5":"1.043352e-15","6":"r17"},{"1":"1","2":"898.5168","3":"904.5168","4":"58.60387026","5":"1.928368e-14","6":"r36"},{"1":"1","2":"921.8019","3":"927.8019","4":"35.31877846","5":"2.799201e-09","6":"r19"},{"1":"1","2":"930.5805","3":"936.5805","4":"26.54018586","5":"2.581126e-07","6":"r6"},{"1":"1","2":"932.1199","3":"938.1199","4":"25.00084555","5":"5.730518e-07","6":"r37"},{"1":"1","2":"957.1058","3":"963.1058","4":"0.01487442","5":"9.029301e-01","6":"r7"},{"1":"NA","2":"957.1207","3":"961.1207","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r21</code> is the most significant variable in the second step (it differs from the article where r32 is selected (p70, the r32 in R is the same as in article (129.65) but r21 and r14 have higher LRT)).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r21), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> third_step <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(third_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>third_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"714.0901","3":"722.0901","4":"90.1843989","5":"2.169662e-21","6":"r14"},{"1":"1","2":"741.2546","3":"749.2546","4":"63.0199166","5":"2.046270e-15","6":"r5"},{"1":"1","2":"743.7322","3":"751.7322","4":"60.5423015","5":"7.201418e-15","6":"r2"},{"1":"1","2":"744.8597","3":"752.8597","4":"59.4147504","5":"1.277083e-14","6":"r4"},{"1":"1","2":"745.9831","3":"753.9831","4":"58.2913673","5":"2.260338e-14","6":"r3"},{"1":"1","2":"760.8121","3":"768.8121","4":"43.4623736","5":"4.321901e-11","6":"r12"},{"1":"1","2":"764.1126","3":"772.1126","4":"40.1619300","5":"2.337596e-10","6":"r11"},{"1":"1","2":"772.9759","3":"780.9759","4":"31.2986265","5":"2.212361e-08","6":"r8"},{"1":"1","2":"776.5893","3":"784.5893","4":"27.6851525","5":"1.427542e-07","6":"r7"},{"1":"1","2":"792.7920","3":"800.7920","4":"11.4825457","5":"7.025284e-04","6":"r32"},{"1":"1","2":"794.2690","3":"802.2690","4":"10.0055452","5":"1.560696e-03","6":"r28"},{"1":"1","2":"800.5379","3":"808.5379","4":"3.7365549","5":"5.323410e-02","6":"r6"},{"1":"1","2":"801.0543","3":"809.0543","4":"3.2202347","5":"7.273320e-02","6":"r19"},{"1":"1","2":"801.4406","3":"809.4406","4":"2.8339474","5":"9.229126e-02","6":"r17"},{"1":"1","2":"801.5276","3":"809.5276","4":"2.7469463","5":"9.744037e-02","6":"r30"},{"1":"1","2":"802.0295","3":"810.0295","4":"2.2450215","5":"1.340450e-01","6":"r24"},{"1":"1","2":"802.1217","3":"810.1217","4":"2.1528372","5":"1.423067e-01","6":"r36"},{"1":"1","2":"802.6540","3":"810.6540","4":"1.6205439","5":"2.030160e-01","6":"r18"},{"1":"1","2":"803.4456","3":"811.4456","4":"0.8289127","5":"3.625871e-01","6":"r37"},{"1":"1","2":"803.8445","3":"811.8445","4":"0.4299580","5":"5.120095e-01","6":"r22"},{"1":"NA","2":"804.2745","3":"810.2745","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r14</code> is the most significant variable in the third step.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r21 <span class="sc">+</span> r14), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> fourth_step <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fourth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>fourth_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"710.8419","3":"720.8419","4":"3.24820880","5":"0.07150156","6":"r17"},{"1":"1","2":"710.8819","3":"720.8819","4":"3.20817230","5":"0.07327129","6":"r2"},{"1":"1","2":"711.1145","3":"721.1145","4":"2.97555922","5":"0.08453091","6":"r11"},{"1":"1","2":"711.3343","3":"721.3343","4":"2.75583636","5":"0.09690013","6":"r32"},{"1":"1","2":"711.7203","3":"721.7203","4":"2.36982464","5":"0.12370095","6":"r5"},{"1":"1","2":"711.8104","3":"721.8104","4":"2.27968069","5":"0.13107886","6":"r28"},{"1":"1","2":"711.9805","3":"721.9805","4":"2.10960972","5":"0.14637664","6":"r12"},{"1":"1","2":"712.2434","3":"722.2434","4":"1.84666740","5":"0.17417149","6":"r3"},{"1":"1","2":"712.5374","3":"722.5374","4":"1.55273599","5":"0.21273199","6":"r24"},{"1":"1","2":"712.9444","3":"722.9444","4":"1.14565551","5":"0.28446045","6":"r4"},{"1":"1","2":"713.1870","3":"723.1870","4":"0.90308253","5":"0.34195651","6":"r19"},{"1":"1","2":"713.4303","3":"723.4303","4":"0.65975466","5":"0.41664657","6":"r8"},{"1":"1","2":"713.4831","3":"723.4831","4":"0.60704949","5":"0.43590090","6":"r6"},{"1":"1","2":"713.6375","3":"723.6375","4":"0.45257824","5":"0.50111312","6":"r30"},{"1":"1","2":"713.7205","3":"723.7205","4":"0.36955138","5":"0.54324890","6":"r36"},{"1":"1","2":"713.9419","3":"723.9419","4":"0.14818752","5":"0.70027348","6":"r22"},{"1":"1","2":"713.9450","3":"723.9450","4":"0.14506328","5":"0.70329842","6":"r7"},{"1":"1","2":"714.0279","3":"724.0279","4":"0.06216243","5":"0.80311021","6":"r37"},{"1":"1","2":"714.0641","3":"724.0641","4":"0.02600399","5":"0.87189057","6":"r18"},{"1":"NA","2":"714.0901","3":"722.0901","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r17</code> is the most significant variable in the fourth step.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r21 <span class="sc">+</span> r14 <span class="sc">+</span> r17), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> fifth_step <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fifth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>fifth_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"702.5625","3":"714.5625","4":"8.279384396","5":"0.004009772","6":"r24"},{"1":"1","2":"704.1237","3":"716.1237","4":"6.718214279","5":"0.009543313","6":"r28"},{"1":"1","2":"704.1749","3":"716.1749","4":"6.667028444","5":"0.009821281","6":"r32"},{"1":"1","2":"705.1234","3":"717.1234","4":"5.718477444","5":"0.016787282","6":"r11"},{"1":"1","2":"707.4856","3":"719.4856","4":"3.356289226","5":"0.066948768","6":"r12"},{"1":"1","2":"707.5662","3":"719.5662","4":"3.275662109","5":"0.070314549","6":"r2"},{"1":"1","2":"708.5711","3":"720.5711","4":"2.270769104","5":"0.131834463","6":"r5"},{"1":"1","2":"708.7847","3":"720.7847","4":"2.057231060","5":"0.151485222","6":"r3"},{"1":"1","2":"708.9966","3":"720.9966","4":"1.845290732","5":"0.174332105","6":"r18"},{"1":"1","2":"709.0183","3":"721.0183","4":"1.823570233","5":"0.176888889","6":"r19"},{"1":"1","2":"709.2089","3":"721.2089","4":"1.632942619","5":"0.201296526","6":"r30"},{"1":"1","2":"709.3243","3":"721.3243","4":"1.517564052","5":"0.217988497","6":"r36"},{"1":"1","2":"709.7053","3":"721.7053","4":"1.136637440","5":"0.286363976","6":"r4"},{"1":"1","2":"710.0560","3":"722.0560","4":"0.785939981","5":"0.375330616","6":"r37"},{"1":"1","2":"710.7491","3":"722.7491","4":"0.092746778","5":"0.760713814","6":"r7"},{"1":"1","2":"710.7974","3":"722.7974","4":"0.044461550","5":"0.832997238","6":"r8"},{"1":"1","2":"710.8378","3":"722.8378","4":"0.004126971","5":"0.948777930","6":"r6"},{"1":"1","2":"710.8380","3":"722.8380","4":"0.003887266","5":"0.950285747","6":"r22"},{"1":"NA","2":"710.8419","3":"720.8419","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r24</code> is the most significant variable in the fifth step.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r21 <span class="sc">+</span> r14 <span class="sc">+</span> r17 <span class="sc">+</span> r24), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> sixth_step <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(sixth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>sixth_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"698.0220","3":"712.0220","4":"4.54052660","5":"0.03310141","6":"r11"},{"1":"1","2":"698.2276","3":"712.2276","4":"4.33495071","5":"0.03733750","6":"r2"},{"1":"1","2":"698.3866","3":"712.3866","4":"4.17586606","5":"0.04100360","6":"r3"},{"1":"1","2":"698.8480","3":"712.8480","4":"3.71455654","5":"0.05393995","6":"r28"},{"1":"1","2":"699.5084","3":"713.5084","4":"3.05410138","5":"0.08053353","6":"r18"},{"1":"1","2":"699.5341","3":"713.5341","4":"3.02835803","5":"0.08182078","6":"r32"},{"1":"1","2":"699.6100","3":"713.6100","4":"2.95253676","5":"0.08574287","6":"r19"},{"1":"1","2":"699.7094","3":"713.7094","4":"2.85313738","5":"0.09119581","6":"r5"},{"1":"1","2":"699.7180","3":"713.7180","4":"2.84445839","5":"0.09168949","6":"r12"},{"1":"1","2":"700.9907","3":"714.9907","4":"1.57185081","5":"0.20993843","6":"r4"},{"1":"1","2":"701.2166","3":"715.2166","4":"1.34592638","5":"0.24599154","6":"r6"},{"1":"1","2":"701.4726","3":"715.4726","4":"1.08986400","5":"0.29650134","6":"r37"},{"1":"1","2":"701.6492","3":"715.6492","4":"0.91327013","5":"0.33924824","6":"r8"},{"1":"1","2":"702.1099","3":"716.1099","4":"0.45263900","5":"0.50108439","6":"r7"},{"1":"1","2":"702.4698","3":"716.4698","4":"0.09274024","5":"0.76072199","6":"r30"},{"1":"1","2":"702.5287","3":"716.5287","4":"0.03381936","5":"0.85409158","6":"r22"},{"1":"1","2":"702.5301","3":"716.5301","4":"0.03240437","5":"0.85714304","6":"r36"},{"1":"NA","2":"702.5625","3":"714.5625","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r11</code> is the most significant variable in the sixth step.</p>
<p>Equivalently the <code>step</code> routine produces the same results:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform forward stepwise regression</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>forward_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r21 + r14 + r17 + r24 + r11 + r28 + r36 + 
    r3 + r8 + r32, family = "binomial", data = don_desbois)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -11.1573     1.3883  -8.036 9.25e-16 ***
r1           10.3995     1.1853   8.773  &lt; 2e-16 ***
r21           3.9664     1.5931   2.490 0.012787 *  
r14           2.4414     0.6955   3.510 0.000448 ***
r17          36.0464     7.2134   4.997 5.82e-07 ***
r24          -4.1232     2.8366  -1.454 0.146058    
r11           1.4347     0.5289   2.713 0.006677 ** 
r28         -18.1295     6.1484  -2.949 0.003191 ** 
r36           1.5231     0.3888   3.917 8.95e-05 ***
r3            5.4959     1.2741   4.313 1.61e-05 ***
r8           -3.3793     0.9457  -3.573 0.000353 ***
r32          16.5696     6.9327   2.390 0.016846 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  666.58  on 1248  degrees of freedom
AIC: 690.58

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>We now perform manual likelihood-ratio-test-based forward selection with override when needed to match the procedure of Desbois article (i.e.&nbsp;forcing the selection of the same variables as in Desbois if <code>R</code> procedure disagrees).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>first_step_article <span class="ot">&lt;-</span> <span class="fu">add1</span>(intercept_only, <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>first_step_article <span class="ot">&lt;-</span> first_step_article <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(first_step_article)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(first_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"957.1207","3":"961.1207","4":"787.9305","5":"2.271029e-173","6":"r1"},{"1":"1","2":"979.8111","3":"983.8111","4":"765.2401","5":"1.948510e-168","6":"r14"},{"1":"1","2":"996.7790","3":"1000.7790","4":"748.2722","5":"9.529992e-165","6":"r21"},{"1":"1","2":"1094.0080","3":"1098.0080","4":"651.0431","5":"1.325113e-143","6":"r4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r1</code> is the most significant variable in the first step.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>second_step_article <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>second_step_article <span class="ot">&lt;-</span> second_step_article <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(second_step_article)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(second_step,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"804.2745","3":"810.2745","4":"152.8462","5":"4.138901e-35","6":"r21"},{"1":"1","2":"808.7077","3":"814.7077","4":"148.4130","5":"3.853515e-34","6":"r14"},{"1":"1","2":"827.4681","3":"833.4681","4":"129.6526","5":"4.881554e-30","6":"r32"},{"1":"1","2":"849.7753","3":"855.7753","4":"107.3454","5":"3.739741e-25","6":"r30"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In the article <code>r32</code> is the most significant variable in the second step: we force the selection of <code>r32</code> instead of <code>r21</code> proposed by <code>R</code>. We have exactly the same LRT as in the article:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> third_step <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(third_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(third_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"740.8469","3":"748.8469","4":"86.62116","5":"1.314334e-20","6":"r14"},{"1":"1","2":"788.7621","3":"796.7621","4":"38.70599","5":"4.926955e-10","6":"r17"},{"1":"1","2":"789.5328","3":"797.5328","4":"37.93534","5":"7.312855e-10","6":"r8"},{"1":"1","2":"790.3277","3":"798.3277","4":"37.14042","5":"1.099217e-09","6":"r18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Like in the article <code>r14</code> is the most significant variable in the third step (with same LRT).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> fourth_step <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fourth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fourth_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"711.0605","3":"721.0605","4":"29.78641","5":"4.823619e-08","6":"r18"},{"1":"1","2":"711.3343","3":"721.3343","4":"29.51268","5":"5.555203e-08","6":"r21"},{"1":"1","2":"711.6341","3":"721.6341","4":"29.21284","5":"6.484792e-08","6":"r17"},{"1":"1","2":"715.2414","3":"725.2414","4":"25.60558","5":"4.188254e-07","6":"r28"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In the article <code>r17</code> is the most significant variable in the fourth step: : we choose <code>r17</code>instead of <code>r18</code>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14 <span class="sc">+</span> r17), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> fifth_step <span class="sc">%&gt;%</span> </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fifth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fifth_step,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"697.9413","3":"709.9413","4":"13.69282","5":"0.0002152764","6":"r36"},{"1":"1","2":"698.7633","3":"710.7633","4":"12.87077","5":"0.0003337548","6":"r37"},{"1":"1","2":"699.6883","3":"711.6883","4":"11.94582","5":"0.0005477014","6":"r12"},{"1":"1","2":"700.5403","3":"712.5403","4":"11.09382","5":"0.0008661601","6":"r11"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Like in the article <code>r36</code> is the most significant variable in the fifth step (with same LRT)</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14 <span class="sc">+</span> r17 <span class="sc">+</span> r36), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> sixth_step <span class="sc">%&gt;%</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(sixth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sixth_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"688.8581","3":"702.8581","4":"9.083198","5":"0.002579686","6":"r12"},{"1":"1","2":"689.4065","3":"703.4065","4":"8.534763","5":"0.003484267","6":"r3"},{"1":"1","2":"689.5363","3":"703.5363","4":"8.405035","5":"0.003741833","6":"r11"},{"1":"1","2":"690.5826","3":"704.5826","4":"7.358675","5":"0.006673994","6":"r2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Like in the article <code>r12</code> is the most significant variable in the sixth step (with same LRT). The routine (<code>SPSS</code>) in the article stops with this six variables.</p>
<p><img src="../images/desbois_forward_stepwise.png" class="img-fluid" data-fig-align="center" width="350"> Looking at the Appendix of Desbois and <code>SPSS</code> documentation, it seems that the <code>SPSS</code> procedure <code>FSTEP</code> used by Desbois for the study performs a Rao score test instead of LRT so select the variables to entry the model (with a p-value threshold at 1%):</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/desbois_spss.png" class="img-fluid figure-img" width="500"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/desbois_spss_fstep.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Contrarily to what is claimed in the article:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/desbois_spss_lrt.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>We now perform a manual (Rao)-score-test-based forward selection, and retrieve the variables selected by Desbois routine:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>first_step_article <span class="ot">&lt;-</span> <span class="fu">add1</span>(intercept_only, <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"Rao"</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>first_step_article <span class="ot">&lt;-</span> first_step_article <span class="sc">%&gt;%</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(first_step_article)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Rao score</span><span class="st">`</span>))</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(first_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"957.1207","3":"961.1207","4":"787.9305","5":"2.271029e-173","6":"r1"},{"1":"1","2":"979.8111","3":"983.8111","4":"765.2401","5":"1.948510e-168","6":"r14"},{"1":"1","2":"996.7790","3":"1000.7790","4":"748.2722","5":"9.529992e-165","6":"r21"},{"1":"1","2":"1094.0080","3":"1098.0080","4":"651.0431","5":"1.325113e-143","6":"r4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r1</code> is the most significant variable in the first step.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>second_step_article <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"Rao"</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>second_step_article <span class="ot">&lt;-</span> second_step_article <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(second_step_article)) <span class="sc">%&gt;%</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Rao score</span><span class="st">`</span>))</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(second_step,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"804.2745","3":"810.2745","4":"152.8462","5":"4.138901e-35","6":"r21"},{"1":"1","2":"808.7077","3":"814.7077","4":"148.4130","5":"3.853515e-34","6":"r14"},{"1":"1","2":"827.4681","3":"833.4681","4":"129.6526","5":"4.881554e-30","6":"r32"},{"1":"1","2":"849.7753","3":"855.7753","4":"107.3454","5":"3.739741e-25","6":"r30"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In the article <code>r32</code> is the most significant variable in the second step.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"Rao"</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> third_step <span class="sc">%&gt;%</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(third_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Rao score</span><span class="st">`</span>))</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(third_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Rao score"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"740.8469","3":"748.8469","4":"71.11350","5":"3.372552e-17","6":"r14"},{"1":"1","2":"788.7621","3":"796.7621","4":"38.01038","5":"7.036936e-10","6":"r17"},{"1":"1","2":"790.3277","3":"798.3277","4":"35.14545","5":"3.059762e-09","6":"r18"},{"1":"1","2":"789.5328","3":"797.5328","4":"34.38749","5":"4.516161e-09","6":"r8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Like in the article <code>r14</code> is the most significant variable in the third step.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"Rao"</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> fourth_step <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fourth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Rao score</span><span class="st">`</span>))</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fourth_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Rao score"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"711.6341","3":"721.6341","4":"28.63897","5":"8.720935e-08","6":"r17"},{"1":"1","2":"711.0605","3":"721.0605","4":"27.91073","5":"1.270436e-07","6":"r18"},{"1":"1","2":"715.2414","3":"725.2414","4":"23.78811","5":"1.075448e-06","6":"r28"},{"1":"1","2":"711.3343","3":"721.3343","4":"18.84954","5":"1.414451e-05","6":"r21"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In the article <code>r17</code> is the most significant variable in the fourth step.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14 <span class="sc">+</span> r17), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"Rao"</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> fifth_step <span class="sc">%&gt;%</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fifth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Rao score</span><span class="st">`</span>))</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fifth_step,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Rao score"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"697.9413","3":"709.9413","4":"13.56515","5":"0.0002304242","6":"r36"},{"1":"1","2":"699.6883","3":"711.6883","4":"12.36394","5":"0.0004377072","6":"r12"},{"1":"1","2":"698.7633","3":"710.7633","4":"12.15234","5":"0.0004902624","6":"r37"},{"1":"1","2":"700.5403","3":"712.5403","4":"11.79802","5":"0.0005929376","6":"r11"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Like in the article <code>r36</code> is the most significant variable in the fifth step.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14 <span class="sc">+</span> r17 <span class="sc">+</span> r36), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"Rao"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> sixth_step <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(sixth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Rao score</span><span class="st">`</span>))</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sixth_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Rao score"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"688.8581","3":"702.8581","4":"9.157307","5":"0.002477269","6":"r12"},{"1":"1","2":"689.4065","3":"703.4065","4":"8.696829","5":"0.003187641","6":"r3"},{"1":"1","2":"689.5363","3":"703.5363","4":"8.506949","5":"0.003537928","6":"r11"},{"1":"1","2":"690.5826","3":"704.5826","4":"6.817166","5":"0.009028572","6":"r2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Like in the article <code>r12</code> is the most significant variable in the sixth step. The routine (<code>SPSS</code>) in the article stops with this six variables.</p>
<p>So basically the article prints and focus on a statistic (LRT, Table 13) which is different form the one used by the effective procedure (Rao score test) to perform variable selection, hence the difference with our findings. Also the AIC criterion (based on LRT) implies a higher p-value than the one used by Desbois to stop the procedure, hence more variables are selected by <code>stats::step()</code> than Desbois procedure.</p>
<p>R performs automated AIC/BIC based variable selections using (step)</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>forward_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="fu">log</span>(<span class="fu">nrow</span>(don_desbois)), <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r21 + r14, family = "binomial", data = don_desbois)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -5.3243     0.3196 -16.657  &lt; 2e-16 ***
r1            3.9493     0.5754   6.864 6.70e-12 ***
r21           7.3123     0.8965   8.157 3.44e-16 ***
r14           2.5822     0.3113   8.294  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  714.09  on 1256  degrees of freedom
AIC: 722.09

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>backward_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(all, <span class="at">direction=</span><span class="st">'backward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(backward_aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r3 + r8 + r12 + r14 + r17 + r22 + r28 + 
    r30 + r36 + r37, family = "binomial", data = don_desbois %&gt;% 
    select(Y, starts_with("r")))

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -9.9854     1.5001  -6.657 2.80e-11 ***
r1           10.2464     1.0700   9.576  &lt; 2e-16 ***
r3            5.3125     1.2413   4.280 1.87e-05 ***
r8           -3.2304     0.9246  -3.494 0.000476 ***
r12           0.9784     0.3746   2.612 0.009001 ** 
r14           2.5304     0.7107   3.560 0.000371 ***
r17          34.7873     5.3459   6.507 7.65e-11 ***
r22           1.8935     0.8032   2.357 0.018404 *  
r28         -12.0852     2.4397  -4.954 7.28e-07 ***
r30           8.0662     3.1521   2.559 0.010497 *  
r36           1.4516     0.3629   4.000 6.34e-05 ***
r37          -1.4783     0.9176  -1.611 0.107190    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  663.66  on 1248  degrees of freedom
AIC: 687.66

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>backward_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(all, <span class="at">direction=</span><span class="st">'backward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="fu">log</span>(<span class="fu">nrow</span>(don_desbois)), <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(backward_bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r3 + r8 + r12 + r14 + r17 + r28 + r36, 
    family = "binomial", data = don_desbois %&gt;% select(Y, starts_with("r")))

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -9.3068     1.0442  -8.913  &lt; 2e-16 ***
r1            9.1338     0.9539   9.575  &lt; 2e-16 ***
r3            4.0983     1.1739   3.491 0.000481 ***
r8           -2.2337     0.8121  -2.751 0.005949 ** 
r12           1.0991     0.3639   3.020 0.002528 ** 
r14           2.5999     0.7224   3.599 0.000319 ***
r17          31.9448     4.4733   7.141 9.26e-13 ***
r28          -7.8125     1.2101  -6.456 1.08e-10 ***
r36           1.5837     0.2917   5.430 5.65e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  673.16  on 1251  degrees of freedom
AIC: 691.16

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>Doing the Stepwise Forward variable selection using both quntitative/qualitative variables:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define intercept-only model</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>intercept_only_w <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>don_desbois_winsorized, <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">#define model with all predictors</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>all_w <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>don_desbois_winsorized, <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">#perform forward stepwise regression AIC</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>forward_aic_w <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only_w, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all_w), <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="co">#perform forward stepwise regression BIC</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>forward_bic_w <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only_w, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all_w), <span class="at">k=</span><span class="fu">log</span>(<span class="fu">nrow</span>(don_desbois_winsorized)), <span class="at">trace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_aic_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r21 + r14 + HECTARE + CNTY + r5 + STATUS + 
    r7 + r6 + r37 + AGE + OWNLAND + r17 + r18 + ToF + r3, family = "binomial", 
    data = don_desbois_winsorized)

Coefficients:
                                          Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                              -3.922768   1.726184  -2.273 0.023056
r1                                       20.915273   3.678552   5.686 1.30e-08
r21                                       7.163900   1.652170   4.336 1.45e-05
r14                                       2.156713   0.587901   3.668 0.000244
HECTARE                                  -0.035937   0.004444  -8.087 6.13e-16
CNTYNord                                 -2.713596   0.442021  -6.139 8.30e-10
CNTYOrne                                 -2.577969   0.497011  -5.187 2.14e-07
CNTYSeine-Maritime                       -0.072182   0.385551  -0.187 0.851491
r5                                      -14.097087   4.407603  -3.198 0.001382
STATUSEntreprise individuelle            -1.347346   0.384249  -3.506 0.000454
r7                                       10.101260   2.085217   4.844 1.27e-06
r6                                       -6.215849   1.783245  -3.486 0.000491
r37                                      -6.996967   1.760568  -3.974 7.06e-05
AGE                                       0.048555   0.016711   2.905 0.003667
OWNLANDyes                               -0.796142   0.309501  -2.572 0.010101
r17                                      48.578935  12.328265   3.940 8.13e-05
r18                                     -37.187927  11.689744  -3.181 0.001466
ToFgeneral cropping                      -1.146121   0.383742  -2.987 0.002820
ToFdairy farm                            -0.258789   0.324748  -0.797 0.425515
ToFmixed livestock                       -0.920353   0.633548  -1.453 0.146308
ToFvarious crops and livestock combined  -0.323371   0.775043  -0.417 0.676510
ToFsoilless breeding                      0.966881   1.194020   0.810 0.418073
r3                                        3.700858   1.912839   1.935 0.053021
                                           
(Intercept)                             *  
r1                                      ***
r21                                     ***
r14                                     ***
HECTARE                                 ***
CNTYNord                                ***
CNTYOrne                                ***
CNTYSeine-Maritime                         
r5                                      ** 
STATUSEntreprise individuelle           ***
r7                                      ***
r6                                      ***
r37                                     ***
AGE                                     ** 
OWNLANDyes                              *  
r17                                     ***
r18                                     ** 
ToFgeneral cropping                     ** 
ToFdairy farm                              
ToFmixed livestock                         
ToFvarious crops and livestock combined    
ToFsoilless breeding                       
r3                                      .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  503.46  on 1237  degrees of freedom
AIC: 549.46

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
</section>
<section id="penalized-logistic-regression" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="penalized-logistic-regression"><span class="header-section-number">3.5</span> Penalized Logistic Regression</h3>
<p>Perform penalized logistic regression with the Desbois data set. You can find help <a href="https://glmnet.stanford.edu/articles/glmnet.html#logistic-regression-family-binomial">here</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For example below we show the lasso “path” of coefficients when increasing <span class="math inline">\(\lambda\)</span> (from right to left).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Y)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>desbois_lasso <span class="ot">&lt;-</span> glmnetUtils<span class="sc">::</span><span class="fu">glmnet</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>don_desbois, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(desbois_lasso)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can extract for each <span class="math inline">\(\lambda\)</span> the value of coefficients:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>lasso_result <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">as.matrix</span>(<span class="fu">cbind</span>(desbois_lasso<span class="sc">$</span>lambda, <span class="fu">t</span>(<span class="fu">as.matrix</span>(desbois_lasso<span class="sc">$</span>beta)))))</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lasso_result) <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"lambda"</span>, <span class="fu">row.names</span>(desbois_lasso<span class="sc">$</span>beta))</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>lasso_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lambda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["CNTYEure"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["CNTYNord"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CNTYOrne"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CNTYSeine-Maritime"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["STATUScompany"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["STATUSEntreprise individuelle"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["HECTARE"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["ToFcereals"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["ToFgeneral cropping"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["ToFdairy farm"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["ToFmixed livestock"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["ToFvarious crops and livestock combined"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["ToFsoilless breeding"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["OWNLANDno"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["OWNLANDyes"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["AGE"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["HARVEST1988"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["HARVEST1989"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["HARVEST1990"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["HARVEST1991"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["HARVEST1992"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["HARVEST1993"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["HARVEST1994"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["r1"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["r2"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["r3"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["r4"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["r5"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["r6"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["r7"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["r8"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["r11"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["r12"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["r14"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["r17"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["r18"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["r19"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["r21"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["r22"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["r24"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["r28"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["r30"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["r32"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["r36"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["r37"],"name":[46],"type":["dbl"],"align":["right"]}],"data":[{"1":"3.236502e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.0000000","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.00000000","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"0.00000000","45":"0.00000000","46":"0.00000000"},{"1":"2.948980e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.3384439","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.00864236","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"0.00000000","45":"0.00000000","46":"0.00000000"},{"1":"2.687001e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.5435439","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.10365964","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"0.00000000","45":"0.00000000","46":"0.00000000"},{"1":"2.448295e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.7491246","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.19180505","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"0.00000000","45":"0.00000000","46":"0.00000000"},{"1":"2.230795e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.9327815","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.26581907","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-0.16484138","45":"0.00000000","46":"0.00000000"},{"1":"2.032617e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.0871064","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.32590159","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-0.52321756","45":"0.00000000","46":"0.00000000"},{"1":"1.852045e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.2400694","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.38518138","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-0.86035021","45":"0.00000000","46":"0.00000000"},{"1":"1.687515e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.3759961","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.44271394","36":"0.0000000","37":"0.1980249","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-1.15047916","45":"0.00000000","46":"0.00000000"},{"1":"1.537601e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.4942556","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.49901592","36":"0.0000000","37":"0.5911896","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-1.39898243","45":"0.00000000","46":"0.00000000"},{"1":"1.401004e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.6090534","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.55573233","36":"0.0000000","37":"0.9943931","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-1.63638316","45":"0.00000000","46":"0.00000000"},{"1":"1.276543e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.7203937","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.61294348","36":"0.0000000","37":"1.4085286","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-1.86404637","45":"0.00000000","46":"0.00000000"},{"1":"1.163138e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.8282791","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.67067862","36":"0.0000000","37":"1.8340478","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.08299867","45":"0.00000000","46":"0.00000000"},{"1":"1.059808e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.9327482","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.72893008","36":"0.0000000","37":"2.2708359","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.29403400","45":"0.00000000","46":"0.00000000"},{"1":"9.656580e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.0338113","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.78766233","36":"0.0000000","37":"2.7186664","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.49775616","45":"0.00000000","46":"0.00000000"},{"1":"8.798716e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.1315407","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.84681052","36":"0.0000000","37":"3.1767502","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.69465376","45":"0.00000000","46":"0.00000000"},{"1":"8.017062e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.2260044","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.90628653","36":"0.0000000","37":"3.6441510","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.88510869","45":"0.00000000","46":"0.00000000"},{"1":"7.304848e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0007519289","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.3070920","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.96604018","36":"0.0000000","37":"4.1888273","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.02145401","45":"0.00000000","46":"0.00000000"},{"1":"6.655906e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0016529654","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.3771651","26":"0.000000e+00","27":"0.0000000","28":"0.02530474","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.02132293","36":"0.0000000","37":"4.7752162","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.14043415","45":"0.00000000","46":"0.00000000"},{"1":"6.064614e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0025506707","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.4247744","26":"0.000000e+00","27":"0.0000000","28":"0.12871294","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.06148105","36":"0.0000000","37":"5.4291170","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.24607491","45":"0.00000000","46":"0.00000000"},{"1":"5.525850e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0034236996","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.4703846","26":"0.000000e+00","27":"0.0000000","28":"0.23164593","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.10165789","36":"0.0000000","37":"6.0910154","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.34959218","45":"0.00000000","46":"0.00000000"},{"1":"5.034949e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0042739396","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.5138271","26":"0.000000e+00","27":"0.0000000","28":"0.33494173","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.14156298","36":"0.0000000","37":"6.7595831","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.45091197","45":"0.00000000","46":"0.00000000"},{"1":"4.587658e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0051019991","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.5554583","26":"0.000000e+00","27":"0.0000000","28":"0.43755913","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.18126451","36":"0.0000000","37":"7.4315049","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.55022397","45":"0.00000000","46":"0.00000000"},{"1":"4.180103e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0059082513","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.5954787","26":"0.000000e+00","27":"0.0000000","28":"0.53899574","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.22072112","36":"0.0000000","37":"8.1038195","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.64759567","45":"0.00000000","46":"0.00000000"},{"1":"3.808754e-02","2":"0.07144747","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0069139499","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.6273000","26":"0.000000e+00","27":"0.0000000","28":"0.68134904","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.25943889","36":"0.0000000","37":"8.6260431","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.75693318","45":"0.00000000","46":"0.00000000"},{"1":"3.470395e-02","2":"0.14264533","3":"-0.01638696","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0079243527","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.6683850","26":"0.000000e+00","27":"0.0000000","28":"0.83125192","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.29331186","36":"0.0000000","37":"9.0921882","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.87106280","45":"0.00000000","46":"0.00000000"},{"1":"3.162095e-02","2":"0.19875594","3":"-0.06309381","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0089248636","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.7374460","26":"0.000000e+00","27":"0.0000000","28":"0.98752108","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.31743369","36":"0.1854041","37":"9.3940306","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.99412400","45":"0.00000000","46":"0.00000000"},{"1":"2.881183e-02","2":"0.25179533","3":"-0.10792967","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0099010166","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.8105389","26":"0.000000e+00","27":"0.0000000","28":"1.14050115","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.34143447","36":"0.4954780","37":"9.6329641","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.11693015","45":"0.00000000","46":"0.00000000"},{"1":"2.625226e-02","2":"0.30229970","3":"-0.15205495","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0108519492","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.8834011","26":"0.000000e+00","27":"0.0000000","28":"1.29175255","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.36512611","36":"0.7951635","37":"9.8720049","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.23757852","45":"0.00000000","46":"0.00000000"},{"1":"2.392009e-02","2":"0.34969459","3":"-0.19474031","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0117754112","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.003771007","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.9565039","26":"0.000000e+00","27":"0.0000000","28":"1.43854688","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.38887893","36":"1.0846842","37":"10.1087219","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.35637575","45":"0.00000000","46":"0.00000000"},{"1":"2.179509e-02","2":"0.37684463","3":"-0.24630289","4":"-0.02728142","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0126427280","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.027768156","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"3.0333189","26":"0.000000e+00","27":"0.0000000","28":"1.56473783","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.41211244","36":"1.3045958","37":"10.4162077","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.46644706","45":"0.00000000","46":"0.00000000"},{"1":"1.985888e-02","2":"0.36631331","3":"-0.32209983","4":"-0.10465734","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0134283154","9":"0.00000000","10":"-0.03834344","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.041527966","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"3.1107984","26":"0.000000e+00","27":"0.0000000","28":"1.65148982","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.43974187","36":"1.3666235","37":"10.8430175","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.56631005","45":"0.00000000","46":"0.00000000"},{"1":"1.809467e-02","2":"0.35099604","3":"-0.39956039","4":"-0.18229786","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0141952505","9":"0.00000000","10":"-0.08096777","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.054013849","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"3.1646154","26":"0.000000e+00","27":"0.0000000","28":"1.75127238","29":"0.0000000","30":"0.0404742567","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.46475491","36":"1.9151904","37":"10.7847836","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.65895196","45":"0.00000000","46":"0.00000000"},{"1":"1.648719e-02","2":"0.33329210","3":"-0.47383909","4":"-0.25527417","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0149493419","9":"0.00000000","10":"-0.12309587","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.065380918","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"-0.009424194","23":"0.000000000","24":"0.0000000000","25":"3.2019052","26":"0.000000e+00","27":"0.0000000","28":"1.86103260","29":"0.0000000","30":"0.1161111943","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.48743331","36":"2.9543338","37":"10.2677365","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.74677305","45":"0.00000000","46":"0.00000000"},{"1":"1.502251e-02","2":"0.31597902","3":"-0.54237261","4":"-0.32260800","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0156851208","9":"0.00000000","10":"-0.16421945","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.076157252","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"-0.029045639","23":"0.000000000","24":"0.0000000000","25":"3.2389892","26":"0.000000e+00","27":"0.0000000","28":"1.96705176","29":"0.0000000","30":"0.1917341217","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.50973389","36":"3.9858547","37":"9.7445043","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.83542396","45":"0.00000000","46":"0.00000000"},{"1":"1.368795e-02","2":"0.29805930","3":"-0.61119901","4":"-0.38672987","5":"0.000000e+00","6":"0.06058214","7":"-8.603051e-15","8":"-0.0166191302","9":"0.00000000","10":"-0.20440750","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.085261525","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"-0.048301481","23":"0.000000000","24":"0.0000000000","25":"3.3318620","26":"0.000000e+00","27":"0.0000000","28":"2.07009800","29":"0.0000000","30":"0.2433831822","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.52513113","36":"5.1846478","37":"9.1840460","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.93467997","45":"0.00000000","46":"-0.08305822"},{"1":"1.247195e-02","2":"0.28037975","3":"-0.67034103","4":"-0.44116372","5":"0.000000e+00","6":"0.13152726","7":"-1.499978e-14","8":"-0.0176251121","9":"0.00000000","10":"-0.24490211","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.099873318","19":"0.01219596","20":"0.000000e+00","21":"0.00000000","22":"-0.066930930","23":"0.000000000","24":"0.0000000000","25":"3.5095961","26":"0.000000e+00","27":"0.0000000","28":"2.19686820","29":"0.0000000","30":"0.2520587943","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.53567746","36":"6.4928297","37":"8.5000425","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.04860059","45":"0.00000000","46":"-0.27243516"},{"1":"1.136398e-02","2":"0.26598623","3":"-0.72860379","4":"-0.48881636","5":"0.000000e+00","6":"0.20322675","7":"-2.240625e-14","8":"-0.0186054211","9":"0.00000000","10":"-0.28441686","11":"0","12":"-0.02261273","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0009272123","18":"0.115357002","19":"0.02731310","20":"0.000000e+00","21":"0.00000000","22":"-0.085880984","23":"0.000000000","24":"0.0000000000","25":"3.7141200","26":"0.000000e+00","27":"0.0000000","28":"2.31379198","29":"0.0000000","30":"0.2575019933","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.53990181","36":"7.6898932","37":"7.8255986","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.15878670","45":"0.00000000","46":"-0.45919110"},{"1":"1.035443e-02","2":"0.25342798","3":"-0.79060351","4":"-0.53002425","5":"0.000000e+00","6":"0.28350678","7":"-3.491036e-14","8":"-0.0195446175","9":"0.00000000","10":"-0.32733218","11":"0","12":"-0.09618390","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0032457156","18":"0.128816164","19":"0.04048724","20":"0.000000e+00","21":"0.00000000","22":"-0.104159327","23":"0.000000000","24":"0.0000000000","25":"4.0500595","26":"0.000000e+00","27":"0.0000000","28":"2.51962107","29":"0.0000000","30":"0.2168714827","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.49720506","36":"8.8669315","37":"7.0376954","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.26275773","45":"0.06028554","46":"-0.61561280"},{"1":"9.434575e-03","2":"0.24235688","3":"-0.84981698","4":"-0.57098441","5":"0.000000e+00","6":"0.35883266","7":"-4.613039e-14","8":"-0.0204491348","9":"0.00000000","10":"-0.36874164","11":"0","12":"-0.16618316","13":"0.000000000","14":"0.0000000000","15":"0.004192836","16":"-1.582905e-15","17":"0.0054720127","18":"0.141145309","19":"0.05293948","20":"0.000000e+00","21":"0.00000000","22":"-0.122879754","23":"-0.003858045","24":"0.0000000000","25":"4.3954330","26":"0.000000e+00","27":"0.0000000","28":"2.74565988","29":"0.0000000","30":"0.1646443355","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.44780991","36":"9.9427353","37":"6.3333767","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.36697434","45":"0.12817054","46":"-0.76670036"},{"1":"8.596433e-03","2":"0.23486950","3":"-0.89656542","4":"-0.62634704","5":"0.000000e+00","6":"0.42000011","7":"-6.325638e-14","8":"-0.0212314775","9":"0.00000000","10":"-0.40728871","11":"0","12":"-0.23010239","13":"0.000000000","14":"0.0000000000","15":"0.046051432","16":"-6.891329e-15","17":"0.0074451910","18":"0.151723074","19":"0.06618315","20":"0.000000e+00","21":"0.00000000","22":"-0.151182537","23":"-0.039706651","24":"0.0000000000","25":"4.8575965","26":"0.000000e+00","27":"0.3018614","28":"2.79179644","29":"0.0000000","30":"0.0012951672","31":"0.1934853","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.38447744","36":"11.8117688","37":"5.0102370","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.45720704","45":"0.21516849","46":"-0.93824494"},{"1":"7.832750e-03","2":"0.22761514","3":"-0.94654959","4":"-0.67657396","5":"0.000000e+00","6":"0.48239146","7":"-7.476023e-14","8":"-0.0220201169","9":"0.00000000","10":"-0.44247292","11":"0","12":"-0.29967531","13":"0.000000000","14":"0.0000000000","15":"0.081491088","16":"-9.943669e-15","17":"0.0093981494","18":"0.161343912","19":"0.07835737","20":"0.000000e+00","21":"0.00000000","22":"-0.182582531","23":"-0.073047814","24":"0.0000000000","25":"5.1560656","26":"0.000000e+00","27":"0.5830130","28":"2.73340674","29":"0.0000000","30":"0.0000000000","31":"0.3368049","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.34366577","36":"14.2952146","37":"3.1484144","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.53125790","45":"0.26110505","46":"-1.03376067"},{"1":"7.136910e-03","2":"0.22019799","3":"-0.99541340","4":"-0.72505917","5":"0.000000e+00","6":"0.54253237","7":"-8.416488e-14","8":"-0.0227904805","9":"0.00000000","10":"-0.47690538","11":"0","12":"-0.36741712","13":"0.000000000","14":"0.0000000000","15":"0.115241945","16":"-1.668576e-14","17":"0.0113200592","18":"0.170411502","19":"0.08991412","20":"0.000000e+00","21":"0.00000000","22":"-0.213181027","23":"-0.105150719","24":"0.0000000000","25":"5.4833828","26":"0.000000e+00","27":"0.8835513","28":"2.63017669","29":"0.0000000","30":"0.0000000000","31":"0.4746604","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.30277924","36":"16.8328427","37":"1.2207134","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.60591518","45":"0.30896601","46":"-1.13051750"},{"1":"6.502886e-03","2":"0.21308272","3":"-1.04311408","4":"-0.77423464","5":"0.000000e+00","6":"0.59941797","7":"-9.481538e-14","8":"-0.0235339048","9":"0.00000000","10":"-0.51014967","11":"0","12":"-0.43249107","13":"0.000000000","14":"0.0000000000","15":"0.147674755","16":"-2.019452e-14","17":"0.0131354164","18":"0.178512233","19":"0.10050724","20":"0.000000e+00","21":"0.00000000","22":"-0.242865993","23":"-0.135729493","24":"0.0000000000","25":"5.7823956","26":"0.000000e+00","27":"1.1337476","28":"2.53437083","29":"0.0000000","30":"0.0000000000","31":"0.5672219","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.26280392","36":"18.6452420","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.67341513","45":"0.35333807","46":"-1.21320046"},{"1":"5.925188e-03","2":"0.20672492","3":"-1.08927464","4":"-0.82517089","5":"0.000000e+00","6":"0.65206817","7":"-1.026856e-13","8":"-0.0242393240","9":"0.00000000","10":"-0.54184452","11":"0","12":"-0.49461363","13":"0.000000000","14":"0.0000000000","15":"0.179220740","16":"-2.090721e-14","17":"0.0147913112","18":"0.185100578","19":"0.10966949","20":"0.000000e+00","21":"0.00000000","22":"-0.271666333","23":"-0.164626676","24":"0.0000000000","25":"6.0297649","26":"0.000000e+00","27":"1.2801042","28":"2.47333007","29":"0.0000000","30":"0.0000000000","31":"0.5758149","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.22333077","36":"19.2020082","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.73060637","45":"0.39229973","46":"-1.27620724"},{"1":"5.398810e-03","2":"0.20066789","3":"-1.13385898","4":"-0.87425472","5":"0.000000e+00","6":"0.70214350","7":"-1.076164e-13","8":"-0.0249208859","9":"0.00000000","10":"-0.57223644","11":"0","12":"-0.55431417","13":"0.000000000","14":"0.0000000000","15":"0.209416389","16":"-2.464073e-14","17":"0.0163882131","18":"0.191215663","19":"0.11835300","20":"0.000000e+00","21":"0.00000000","22":"-0.299243521","23":"-0.192172060","24":"0.0000000000","25":"6.2635484","26":"0.000000e+00","27":"1.4134421","28":"2.42796982","29":"0.0000000","30":"0.0000000000","31":"0.5845716","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.18586156","36":"19.7361062","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.78725266","45":"0.42976992","46":"-1.33585179"},{"1":"4.919195e-03","2":"0.19493003","3":"-1.17670308","4":"-0.92152741","5":"0.000000e+00","6":"0.74965308","7":"-1.130767e-13","8":"-0.0255772226","9":"0.00000000","10":"-0.60126547","11":"0","12":"-0.61152530","13":"0.000000000","14":"0.0000000000","15":"0.238224154","16":"-2.597238e-14","17":"0.0179192554","18":"0.196939302","19":"0.12660569","20":"0.000000e+00","21":"0.00000000","22":"-0.325558674","23":"-0.218364568","24":"0.0000000000","25":"6.4805860","26":"0.000000e+00","27":"1.5359423","28":"2.39502589","29":"0.0000000","30":"0.0000000000","31":"0.5956750","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.15133812","36":"20.2489756","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.84274446","45":"0.46482073","46":"-1.39162570"},{"1":"4.482187e-03","2":"0.19066564","3":"-1.22085266","4":"-0.96465413","5":"0.000000e+00","6":"0.79424817","7":"-1.193220e-13","8":"-0.0262211089","9":"0.01115570","10":"-0.62419546","11":"0","12":"-0.66240901","13":"0.000000000","14":"0.0000000000","15":"0.265831660","16":"-2.630876e-14","17":"0.0193701325","18":"0.202554665","19":"0.13459006","20":"0.000000e+00","21":"0.00000000","22":"-0.350288340","23":"-0.242966315","24":"0.0000000000","25":"6.6837819","26":"0.000000e+00","27":"1.6508775","28":"2.36208377","29":"0.0000000","30":"0.0000000000","31":"0.6055106","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.12245007","36":"20.7303960","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.90196062","45":"0.49952887","46":"-1.44203399"},{"1":"4.084002e-03","2":"0.18673998","3":"-1.26212632","4":"-1.00025058","5":"0.000000e+00","6":"0.83641102","7":"-1.246578e-13","8":"-0.0268388801","9":"0.02312854","10":"-0.64547432","11":"0","12":"-0.71056757","13":"0.000000000","14":"0.0000000000","15":"0.292165800","16":"-2.801333e-14","17":"0.0207496588","18":"0.207803785","19":"0.14216913","20":"0.000000e+00","21":"-0.01384315","22":"-0.376488475","23":"-0.267649707","24":"0.0000000000","25":"6.8738073","26":"0.000000e+00","27":"1.7568765","28":"2.33660125","29":"0.0000000","30":"0.0000000000","31":"0.6158923","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.09596975","36":"21.1883522","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.96056971","45":"0.53252125","46":"-1.48929114"},{"1":"3.721191e-03","2":"0.18318193","3":"-1.30060453","4":"-1.03022830","5":"0.000000e+00","6":"0.87622412","7":"-1.271488e-13","8":"-0.0274285760","9":"0.03468923","10":"-0.66567604","11":"0","12":"-0.75638686","13":"0.000000000","14":"0.0000000000","15":"0.317112480","16":"-3.072577e-14","17":"0.0220607646","18":"0.212694897","19":"0.14941902","20":"0.000000e+00","21":"-0.03613824","22":"-0.403076099","23":"-0.292048048","24":"0.0000000000","25":"7.0566622","26":"0.000000e+00","27":"1.8604630","28":"2.31757639","29":"0.0000000","30":"0.0000000000","31":"0.6325225","32":"0.000000000","33":"0.0000000","34":"0.0001693181","35":"1.07169766","36":"21.7385480","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"-0.1270672","43":"0.0000000","44":"-5.89676461","45":"0.56433749","46":"-1.53673856"},{"1":"3.390610e-03","2":"0.18596470","3":"-1.34659743","4":"-1.05621088","5":"0.000000e+00","6":"0.90937019","7":"-1.364313e-13","8":"-0.0279504591","9":"0.03990857","10":"-0.67471427","11":"0","12":"-0.80744045","13":"0.000000000","14":"0.0000000000","15":"0.342485894","16":"-3.485532e-14","17":"0.0234166436","18":"0.213781263","19":"0.15518718","20":"0.000000e+00","21":"-0.05432528","22":"-0.430709255","23":"-0.315625523","24":"0.0000000000","25":"7.4872862","26":"0.000000e+00","27":"2.0317947","28":"2.10075758","29":"0.0000000","30":"0.0000000000","31":"0.6082598","32":"0.000000000","33":"0.0000000","34":"0.1035163639","35":"1.13601627","36":"23.4600421","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"-1.5540403","43":"0.0000000","44":"-4.64960961","45":"0.64299499","46":"-1.56122340"},{"1":"3.089398e-03","2":"0.18941303","3":"-1.39355038","4":"-1.08177113","5":"0.000000e+00","6":"0.94230806","7":"-1.487794e-13","8":"-0.0284825883","9":"0.04591846","10":"-0.68395830","11":"0","12":"-0.85550925","13":"0.000000000","14":"0.0000000000","15":"0.365680534","16":"-3.907597e-14","17":"0.0247635726","18":"0.214991351","19":"0.16029134","20":"0.000000e+00","21":"-0.07316807","22":"-0.456444908","23":"-0.338653399","24":"0.0000000000","25":"7.8534176","26":"0.000000e+00","27":"2.2014435","28":"1.93300532","29":"0.0000000","30":"0.0000000000","31":"0.6282764","32":"0.000000000","33":"0.0000000","34":"0.1958460415","35":"1.20270204","36":"25.3816348","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.01352014","41":"0.0000000","42":"-3.2375320","43":"0.0000000","44":"-3.11347837","45":"0.70620310","46":"-1.58995686"},{"1":"2.814944e-03","2":"0.19186023","3":"-1.44101607","4":"-1.10549341","5":"0.000000e+00","6":"0.97399907","7":"-1.635297e-13","8":"-0.0289824095","9":"0.05114994","10":"-0.69360578","11":"0","12":"-0.89991353","13":"0.000000000","14":"0.0000000000","15":"0.386381646","16":"-4.385284e-14","17":"0.0260653917","18":"0.215945124","19":"0.16464274","20":"0.000000e+00","21":"-0.09305554","22":"-0.480273053","23":"-0.361064105","24":"0.0000000000","25":"8.1974429","26":"0.000000e+00","27":"2.3547112","28":"1.78882876","29":"0.0000000","30":"0.0000000000","31":"0.6435355","32":"0.000000000","33":"0.0000000","34":"0.2797220955","35":"1.26188874","36":"27.1404498","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.04525297","41":"0.0000000","42":"-4.8504266","43":"0.0000000","44":"-1.59559342","45":"0.76529486","46":"-1.61677039"},{"1":"2.564872e-03","2":"0.19445303","3":"-1.48620877","4":"-1.12826124","5":"0.000000e+00","6":"1.00399818","7":"-1.762388e-13","8":"-0.0294652133","9":"0.05594820","10":"-0.70294713","11":"0","12":"-0.94199469","13":"0.000000000","14":"0.0000000000","15":"0.405914834","16":"-4.303209e-14","17":"0.0273091503","18":"0.216788072","19":"0.16861856","20":"0.000000e+00","21":"-0.11185641","22":"-0.502663436","23":"-0.381981377","24":"0.0000000000","25":"8.5187888","26":"0.000000e+00","27":"2.4965437","28":"1.66026890","29":"0.0000000","30":"0.0000000000","31":"0.6599801","32":"0.000000000","33":"0.0000000","34":"0.3563158548","35":"1.31688647","36":"28.7970644","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.07579598","41":"0.0000000","42":"-6.3624474","43":"0.0000000","44":"-0.17021152","45":"0.81931720","46":"-1.64465030"},{"1":"2.337016e-03","2":"0.19660788","3":"-1.52231876","4":"-1.15181766","5":"0.000000e+00","6":"1.03070311","7":"-1.769147e-13","8":"-0.0299114720","9":"0.05973617","10":"-0.71175716","11":"0","12":"-0.98177995","13":"0.000000000","14":"0.0004861994","15":"0.425773472","16":"-4.465734e-14","17":"0.0283639865","18":"0.219656276","19":"0.17358400","20":"0.000000e+00","21":"-0.12825111","22":"-0.524841721","23":"-0.400783286","24":"0.0000000000","25":"8.7130962","26":"0.000000e+00","27":"2.5569376","28":"1.59693068","29":"0.0000000","30":"0.0000000000","31":"0.6490395","32":"0.000000000","33":"0.0000000","34":"0.4177571662","35":"1.36296738","36":"29.3394755","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.08492886","41":"0.0000000","42":"-6.6389290","43":"0.0000000","44":"0.00000000","45":"0.85373520","46":"-1.64722217"},{"1":"2.129402e-03","2":"0.19803296","3":"-1.55783413","4":"-1.17626077","5":"0.000000e+00","6":"1.05559347","7":"-1.783644e-13","8":"-0.0303272381","9":"0.06204583","10":"-0.72006040","11":"0","12":"-1.02072890","13":"0.000000000","14":"0.0129597687","15":"0.444976927","16":"-4.375607e-14","17":"0.0294240832","18":"0.221626045","19":"0.17751023","20":"0.000000e+00","21":"-0.14247258","22":"-0.546333531","23":"-0.418319415","24":"0.0000000000","25":"8.9453177","26":"0.000000e+00","27":"2.5969359","28":"1.50523982","29":"0.0000000","30":"0.0000000000","31":"0.5999414","32":"0.000000000","33":"0.0000000","34":"0.4817258446","35":"1.40843850","36":"29.6671574","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.09326755","41":"0.0000000","42":"-6.7352636","43":"0.0000000","44":"0.00000000","45":"0.89364252","46":"-1.65218771"},{"1":"1.940232e-03","2":"0.19975029","3":"-1.59081689","4":"-1.19894982","5":"0.000000e+00","6":"1.07892657","7":"-1.807459e-13","8":"-0.0307219276","9":"0.06420290","10":"-0.72780118","11":"0","12":"-1.05729571","13":"0.000000000","14":"0.0253490926","15":"0.463017160","16":"-4.394829e-14","17":"0.0304278259","18":"0.223572515","19":"0.18123220","20":"0.000000e+00","21":"-0.15591899","22":"-0.566592645","23":"-0.434933514","24":"0.0000000000","25":"9.1588462","26":"0.000000e+00","27":"2.6289702","28":"1.43017839","29":"0.0000000","30":"0.0000000000","31":"0.5546658","32":"0.000000000","33":"0.0000000","34":"0.5403206023","35":"1.45028681","36":"29.9729569","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.10121208","41":"0.0000000","42":"-6.8250224","43":"0.0000000","44":"0.00000000","45":"0.93031250","46":"-1.65806085"},{"1":"1.767867e-03","2":"0.20133803","3":"-1.62131692","4":"-1.22040080","5":"0.000000e+00","6":"1.10083971","7":"-1.802622e-13","8":"-0.0310916148","9":"0.06636952","10":"-0.73517611","11":"0","12":"-1.09140917","13":"0.000000000","14":"0.0371325870","15":"0.479975496","16":"-4.427795e-14","17":"0.0313713593","18":"0.225485118","19":"0.18473291","20":"0.000000e+00","21":"-0.16853352","22":"-0.585464034","23":"-0.450543419","24":"0.0000000000","25":"9.3555235","26":"0.000000e+00","27":"2.6587527","28":"1.36440613","29":"0.0000000","30":"0.0000000000","31":"0.5141641","32":"-0.006416945","33":"0.0000000","34":"0.5934575872","35":"1.49064684","36":"30.2530493","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.10936311","41":"0.0000000","42":"-6.9074892","43":"0.0000000","44":"0.00000000","45":"0.96398979","46":"-1.66565954"},{"1":"1.610815e-03","2":"0.20354443","3":"-1.64624658","4":"-1.25820759","5":"0.000000e+00","6":"1.11248992","7":"-1.816863e-13","8":"-0.0313590289","9":"0.06334157","10":"-0.74186123","11":"0","12":"-1.11237463","13":"0.000000000","14":"0.0605332311","15":"0.503827056","16":"-4.252160e-14","17":"0.0323824546","18":"0.227646336","19":"0.18856486","20":"0.000000e+00","21":"-0.16886692","22":"-0.590468169","23":"-0.465461962","24":"0.0000000000","25":"9.5958035","26":"0.000000e+00","27":"2.7463437","28":"1.71086436","29":"0.0000000","30":"0.0000000000","31":"0.4695893","32":"-0.333425764","33":"0.0000000","34":"0.6506505453","35":"1.54260220","36":"30.3438607","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.13432770","41":"0.0000000","42":"-6.9580528","43":"0.0000000","44":"0.00000000","45":"1.01787846","46":"-1.78543224"},{"1":"1.467714e-03","2":"0.20513017","3":"-1.67127541","4":"-1.29380878","5":"0.000000e+00","6":"1.12492319","7":"-1.850261e-13","8":"-0.0316323677","9":"0.06220774","10":"-0.74956178","11":"0","12":"-1.13090622","13":"0.000000000","14":"0.0791566605","15":"0.525781944","16":"-4.427678e-14","17":"0.0333233951","18":"0.230379229","19":"0.19243773","20":"0.000000e+00","21":"-0.17004803","22":"-0.594653950","23":"-0.479194148","24":"0.0000000000","25":"9.7342945","26":"0.000000e+00","27":"2.8133132","28":"2.09564770","29":"0.0000000","30":"0.0000000000","31":"0.4660862","32":"-0.616887931","33":"0.0000000","34":"0.6900713240","35":"1.57996454","36":"30.4207800","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.15945291","41":"0.0000000","42":"-6.9869637","43":"0.0000000","44":"0.00000000","45":"1.05744198","46":"-1.88301740"},{"1":"1.337327e-03","2":"0.20659778","3":"-1.69499525","4":"-1.32711383","5":"0.000000e+00","6":"1.13680525","7":"-1.852992e-13","8":"-0.0318933725","9":"0.06163869","10":"-0.75692999","11":"0","12":"-1.14822648","13":"0.000000000","14":"0.0979766980","15":"0.546230920","16":"-4.354418e-14","17":"0.0341996007","18":"0.233169239","19":"0.19610108","20":"0.000000e+00","21":"-0.17099735","22":"-0.598698217","23":"-0.491910407","24":"0.0000000000","25":"9.8470982","26":"0.000000e+00","27":"2.8756705","28":"2.44973739","29":"0.0000000","30":"0.0000000000","31":"0.4719043","32":"-0.871265827","33":"0.0000000","34":"0.7247574136","35":"1.61484108","36":"30.4956261","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.18325062","41":"0.0000000","42":"-7.0122054","43":"0.0000000","44":"0.00000000","45":"1.09135013","46":"-1.96832272"},{"1":"1.218522e-03","2":"0.20795660","3":"-1.71785094","4":"-1.35932211","5":"0.000000e+00","6":"1.14813489","7":"-1.864656e-13","8":"-0.0321402609","9":"0.06131972","10":"-0.76395656","11":"0","12":"-1.16457495","13":"0.002916146","14":"0.1170363169","15":"0.565381866","16":"-4.292870e-14","17":"0.0350393002","18":"0.235920405","19":"0.19957436","20":"0.000000e+00","21":"-0.17170202","22":"-0.602852199","23":"-0.503995949","24":"0.0000000000","25":"9.9441090","26":"0.000000e+00","27":"2.9344291","28":"2.77817666","29":"0.0000000","30":"0.0000000000","31":"0.4825372","32":"-1.101038379","33":"0.0000000","34":"0.7554725398","35":"1.64543403","36":"30.5632189","37":"0.0000000","38":"-0.00200041","39":"0.00000000","40":"0.20673810","41":"0.0000000","42":"-7.0324019","43":"0.0000000","44":"0.00000000","45":"1.12182684","46":"-2.04345764"},{"1":"1.110272e-03","2":"0.20903938","3":"-1.73306728","4":"-1.39219494","5":"0.000000e+00","6":"1.15622387","7":"-1.880966e-13","8":"-0.0323559475","9":"0.06146110","10":"-0.76806538","11":"0","12":"-1.18415410","13":"0.011866884","14":"0.1596760259","15":"0.583068371","16":"-4.398888e-14","17":"0.0358861139","18":"0.237351835","19":"0.20250900","20":"0.000000e+00","21":"-0.17057167","22":"-0.604638875","23":"-0.517075995","24":"0.0000000000","25":"10.0407064","26":"0.000000e+00","27":"2.9984713","28":"3.09904937","29":"0.0000000","30":"0.0000000000","31":"0.5138410","32":"-1.308955568","33":"0.0000000","34":"0.7851111706","35":"1.67542879","36":"30.9981370","37":"0.0000000","38":"-0.39952022","39":"0.00000000","40":"0.28126897","41":"0.0000000","42":"-6.9227784","43":"0.0000000","44":"0.00000000","45":"1.14941512","46":"-2.12255547"},{"1":"1.011639e-03","2":"0.21004468","3":"-1.75224713","4":"-1.41759788","5":"0.000000e+00","6":"1.16694747","7":"-1.898468e-13","8":"-0.0325863205","9":"0.06381321","10":"-0.77274624","11":"0","12":"-1.20094320","13":"0.013460318","14":"0.2141405946","15":"0.597915910","16":"-4.462238e-14","17":"0.0368709638","18":"0.240056750","19":"0.20563235","20":"0.000000e+00","21":"-0.17120320","22":"-0.605997052","23":"-0.529269402","24":"0.0000000000","25":"10.1423095","26":"0.000000e+00","27":"3.0925217","28":"3.38416516","29":"0.0000000","30":"0.0000000000","31":"0.5980133","32":"-1.473922212","33":"0.0000000","34":"0.8106485106","35":"1.70490573","36":"32.1848922","37":"-0.9632080","38":"-0.71638587","39":"0.00000000","40":"0.36043247","41":"0.0000000","42":"-6.7969812","43":"0.0000000","44":"0.00000000","45":"1.17536049","46":"-2.19958561"},{"1":"9.217673e-04","2":"0.21153161","3":"-1.77169297","4":"-1.43891702","5":"1.265879e-03","6":"1.17856082","7":"-1.926971e-13","8":"-0.0328158748","9":"0.06668774","10":"-0.77774376","11":"0","12":"-1.21641432","13":"0.012717681","14":"0.2687692508","15":"0.611116612","16":"-4.494836e-14","17":"0.0378652529","18":"0.242945107","19":"0.20858257","20":"0.000000e+00","21":"-0.17243794","22":"-0.607279426","23":"-0.540335819","24":"0.0000000000","25":"10.2426398","26":"0.000000e+00","27":"3.1971996","28":"3.63493163","29":"0.0000000","30":"0.0000000000","31":"0.6976305","32":"-1.614065741","33":"0.0000000","34":"0.8333658509","35":"1.73243124","36":"33.5717706","37":"-2.1838822","38":"-1.00524635","39":"0.00000000","40":"0.44028019","41":"0.0000000","42":"-6.6669799","43":"0.0000000","44":"0.00000000","45":"1.19932882","46":"-2.27115093"},{"1":"8.398801e-04","2":"0.21287066","3":"-1.79066972","4":"-1.45848004","5":"3.123778e-03","6":"1.19008526","7":"-1.940170e-13","8":"-0.0330375307","9":"0.06949431","10":"-0.78269911","11":"0","12":"-1.23088624","13":"0.011773265","14":"0.3186717062","15":"0.623333519","16":"-4.579469e-14","17":"0.0388116923","18":"0.245648370","19":"0.21125096","20":"0.000000e+00","21":"-0.17391994","22":"-0.608524451","23":"-0.550462487","24":"0.0000000000","25":"10.3361087","26":"0.000000e+00","27":"3.3011713","28":"3.86705814","29":"0.0000000","30":"0.0000000000","31":"0.7964751","32":"-1.741652421","33":"0.0000000","34":"0.8539311010","35":"1.75696607","36":"34.9167699","37":"-3.3686009","38":"-1.28846455","39":"0.00000000","40":"0.52005970","41":"0.0000000","42":"-6.5352195","43":"0.0000000","44":"0.00000000","45":"1.22178271","46":"-2.33672400"},{"1":"7.652674e-04","2":"0.21472305","3":"-1.80783735","4":"-1.47603070","5":"5.450627e-03","6":"1.20106484","7":"-1.965693e-13","8":"-0.0332478406","9":"0.07203860","10":"-0.78724982","11":"0","12":"-1.24460005","13":"0.010943159","14":"0.3638077706","15":"0.634803674","16":"-4.739477e-14","17":"0.0396961551","18":"0.248197222","19":"0.21374567","20":"0.000000e+00","21":"-0.17542177","22":"-0.610038217","23":"-0.559856094","24":"0.0000000000","25":"10.4254596","26":"0.000000e+00","27":"3.3975648","28":"4.07435035","29":"0.0000000","30":"-0.0006549552","31":"0.8867792","32":"-1.856827769","33":"0.0000000","34":"0.8734082770","35":"1.78034318","36":"36.1473506","37":"-4.4461808","38":"-1.55734514","39":"0.00494296","40":"0.59470005","41":"0.0000000","42":"-6.4103546","43":"0.0000000","44":"0.00000000","45":"1.24252084","46":"-2.39700135"},{"1":"6.972832e-04","2":"0.20697715","3":"-1.83763968","4":"-1.51269642","5":"0.000000e+00","6":"1.20973672","7":"-2.014622e-13","8":"-0.0334820668","9":"0.07793714","10":"-0.79317344","11":"0","12":"-1.24260560","13":"0.008447448","14":"0.4048559803","15":"0.650555098","16":"-4.988861e-14","17":"0.0404490114","18":"0.252165663","19":"0.21668241","20":"0.000000e+00","21":"-0.17209219","22":"-0.606173266","23":"-0.565285938","24":"0.0000000000","25":"10.5845789","26":"0.000000e+00","27":"3.5512521","28":"4.32735586","29":"0.0000000","30":"-0.5080501573","31":"1.4589365","32":"-1.535050150","33":"0.0000000","34":"0.8794817094","35":"1.76740824","36":"37.2114134","37":"-5.9115268","38":"-1.61326509","39":"0.20872712","40":"0.59955549","41":"0.0000000","42":"-6.2335564","43":"0.0000000","44":"0.00000000","45":"1.28950795","46":"-2.47686874"},{"1":"6.353385e-04","2":"0.20749239","3":"-1.85707012","4":"-1.53876378","5":"0.000000e+00","6":"1.21833018","7":"-2.039227e-13","8":"-0.0337011380","9":"0.08226730","10":"-0.79674467","11":"0","12":"-1.24504461","13":"0.007734952","14":"0.4341742862","15":"0.665675784","16":"-5.460668e-14","17":"0.0411454810","18":"0.255751277","19":"0.21964347","20":"0.000000e+00","21":"-0.16792028","22":"-0.605664791","23":"-0.571744279","24":"0.0000000000","25":"10.7227193","26":"0.000000e+00","27":"3.6553485","28":"4.53208619","29":"0.0000000","30":"-0.8687565058","31":"1.8505572","32":"-1.325303174","33":"0.0000000","34":"0.8914000724","35":"1.76418590","36":"37.8689333","37":"-6.8607577","38":"-1.65537462","39":"0.37260275","40":"0.60244905","41":"0.0000000","42":"-6.1061306","43":"0.0000000","44":"0.00000000","45":"1.33002477","46":"-2.53804269"},{"1":"5.788967e-04","2":"0.20789920","3":"-1.87566906","4":"-1.56189795","5":"0.000000e+00","6":"1.22668810","7":"-2.120193e-13","8":"-0.0339045958","9":"0.08596335","10":"-0.79985318","11":"0","12":"-1.24871109","13":"0.006577020","14":"0.4583695335","15":"0.679610107","16":"-5.699632e-14","17":"0.0418230658","18":"0.258732691","19":"0.22213649","20":"0.000000e+00","21":"-0.16370707","22":"-0.605450833","23":"-0.577772128","24":"0.0000000000","25":"10.8422831","26":"0.000000e+00","27":"3.7442371","28":"4.73180854","29":"0.0000000","30":"-1.1390021410","31":"2.1517998","32":"-1.187609780","33":"0.0000000","34":"0.9022707958","35":"1.76049994","36":"38.4877051","37":"-7.7732179","38":"-1.68343462","39":"0.52910068","40":"0.60379226","41":"0.0000000","42":"-5.9886197","43":"0.0000000","44":"0.00000000","45":"1.36620601","46":"-2.59218111"},{"1":"5.274692e-04","2":"0.20821045","3":"-1.89331391","4":"-1.58273589","5":"0.000000e+00","6":"1.23468768","7":"-2.085499e-13","8":"-0.0340939710","9":"0.08915466","10":"-0.80260428","11":"0","12":"-1.25301053","13":"0.005117941","14":"0.4782814633","15":"0.692536209","16":"-5.622375e-14","17":"0.0424735807","18":"0.261257110","19":"0.22428556","20":"0.000000e+00","21":"-0.15959475","22":"-0.605439353","23":"-0.583432254","24":"0.0000000000","25":"10.9486476","26":"0.000000e+00","27":"3.8214776","28":"4.92394448","29":"0.0000000","30":"-1.3486338500","31":"2.3907044","32":"-1.096984902","33":"0.0000000","34":"0.9123582930","35":"1.75666803","36":"39.0616932","37":"-8.6476682","38":"-1.69928161","39":"0.68092135","40":"0.60338479","41":"0.0000000","42":"-5.8791133","43":"0.0000000","44":"0.00000000","45":"1.39901466","46":"-2.64119301"},{"1":"4.806102e-04","2":"0.20845290","3":"-1.90990652","4":"-1.60160632","5":"0.000000e+00","6":"1.24224276","7":"-2.097954e-13","8":"-0.0342697932","9":"0.09192840","10":"-0.80505365","11":"0","12":"-1.25758599","13":"0.003447054","14":"0.4949711258","15":"0.704511665","16":"-5.657798e-14","17":"0.0430915961","18":"0.263420686","19":"0.22615747","20":"0.000000e+00","21":"-0.15566206","22":"-0.605555569","23":"-0.588750298","24":"0.0000000000","25":"11.0445589","26":"0.000000e+00","27":"3.8893952","28":"5.10643904","29":"0.0000000","30":"-1.5147868580","31":"2.5840965","32":"-1.038736337","33":"0.0000000","34":"0.9218663289","35":"1.75314013","36":"39.5940756","37":"-9.4779882","38":"-1.70855776","39":"0.82622787","40":"0.60234166","41":"0.0000000","42":"-5.7767246","43":"0.0000000","44":"0.00000000","45":"1.42885334","46":"-2.68611592"},{"1":"4.379142e-04","2":"0.20863103","3":"-1.93033359","4":"-1.62034970","5":"0.000000e+00","6":"1.24926684","7":"-2.100991e-13","8":"-0.0344330287","9":"0.09446077","10":"-0.80728523","11":"0","12":"-1.26196106","13":"0.001191864","14":"0.5088752400","15":"0.715696064","16":"-5.678529e-14","17":"0.0436755887","18":"0.265330983","19":"0.22784376","20":"0.000000e+00","21":"-0.15021547","22":"-0.601844684","23":"-0.588792321","24":"0.0057410145","25":"11.1319744","26":"0.000000e+00","27":"3.9499519","28":"5.27770579","29":"0.0000000","30":"-1.6523589397","31":"2.7472476","32":"-0.998933072","33":"0.0000000","34":"0.9308515642","35":"1.74987473","36":"40.0934999","37":"-10.2729256","38":"-1.71115505","39":"0.96692444","40":"0.59962759","41":"0.0000000","42":"-5.6821148","43":"0.0000000","44":"0.00000000","45":"1.45628828","46":"-2.72734798"},{"1":"3.990111e-04","2":"0.20952252","3":"-1.95185176","4":"-1.63797440","5":"0.000000e+00","6":"1.25571967","7":"-2.119106e-13","8":"-0.0345844484","9":"0.09678867","10":"-0.80904017","11":"0","12":"-1.26611124","13":"0.000000000","14":"0.5206925106","15":"0.726090795","16":"-5.626527e-14","17":"0.0442245721","18":"0.267232402","19":"0.22958336","20":"0.000000e+00","21":"-0.14414520","22":"-0.595992013","23":"-0.585586913","24":"0.0155417987","25":"11.2121876","26":"0.000000e+00","27":"4.0048303","28":"5.43697414","29":"0.0000000","30":"-1.7690954322","31":"2.8875727","32":"-0.971170282","33":"0.0000000","34":"0.9392366986","35":"1.74660080","36":"40.5600035","37":"-11.0270776","38":"-1.70864589","39":"1.10273327","40":"0.59538305","41":"0.0000000","42":"-5.5952034","43":"0.0000000","44":"0.00000000","45":"1.48154026","46":"-2.76537674"},{"1":"3.635640e-04","2":"0.21017083","3":"-1.96883757","4":"-1.65404821","5":"0.000000e+00","6":"1.26177786","7":"-2.106913e-13","8":"-0.0347293867","9":"0.09887125","10":"-0.81094345","11":"0","12":"-1.26824981","13":"0.000000000","14":"0.5286480762","15":"0.735158769","16":"-5.491279e-14","17":"0.0446784965","18":"0.268525105","19":"0.23103586","20":"0.000000e+00","21":"-0.13945335","22":"-0.592185798","23":"-0.584609026","24":"0.0220294734","25":"11.4923421","26":"0.000000e+00","27":"4.0381267","28":"5.40545320","29":"-0.2544609","30":"-1.8694515414","31":"3.0245998","32":"-0.957990501","33":"0.0000000","34":"0.9420565696","35":"1.73999285","36":"40.9957956","37":"-11.7608898","38":"-1.69117174","39":"1.23360912","40":"0.58815542","41":"0.0000000","42":"-5.5119522","43":"0.0000000","44":"0.00000000","45":"1.50110221","46":"-2.80061503"},{"1":"3.312660e-04","2":"0.21336794","3":"-1.96622143","4":"-1.66930957","5":"0.000000e+00","6":"1.26812161","7":"-2.187638e-13","8":"-0.0349262988","9":"0.10043849","10":"-0.81290282","11":"0","12":"-1.26945194","13":"0.000000000","14":"0.5213919562","15":"0.745267531","16":"-6.288831e-14","17":"0.0450508139","18":"0.269235699","19":"0.23275056","20":"0.000000e+00","21":"-0.13809169","22":"-0.600493230","23":"-0.598991141","24":"0.0117851493","25":"12.3403365","26":"0.000000e+00","27":"4.0475221","28":"4.83092970","29":"-1.1352762","30":"-2.0608870641","31":"3.2607730","32":"-0.874664186","33":"-0.1258327","34":"1.0268038028","35":"1.73855086","36":"41.2766527","37":"-12.6472418","38":"-1.41301669","39":"1.46537503","40":"0.50462666","41":"0.0000000","42":"-5.5670634","43":"0.0000000","44":"0.00000000","45":"1.52120167","46":"-2.82894566"},{"1":"3.018372e-04","2":"0.21776821","3":"-1.95885363","4":"-1.67965826","5":"0.000000e+00","6":"1.27492754","7":"-2.143627e-13","8":"-0.0351254600","9":"0.10042496","10":"-0.81523901","11":"0","12":"-1.27409165","13":"0.000000000","14":"0.5149470311","15":"0.752962626","16":"-5.649092e-14","17":"0.0454329109","18":"0.268663566","19":"0.23396404","20":"0.000000e+00","21":"-0.13913218","22":"-0.609665517","23":"-0.615901592","24":"0.0005927967","25":"13.3079210","26":"0.000000e+00","27":"4.0451117","28":"4.13415276","29":"-2.1319035","30":"-2.1747940654","31":"3.4160146","32":"-0.854382716","33":"-0.3423943","34":"1.1724509577","35":"1.73833806","36":"41.6452865","37":"-13.3630824","38":"-1.28113247","39":"1.60586572","40":"0.46461859","41":"0.0000000","42":"-5.6642787","43":"0.0000000","44":"0.00000000","45":"1.54080647","46":"-2.86023604"},{"1":"2.750229e-04","2":"0.22210450","3":"-1.95952188","4":"-1.69134725","5":"0.000000e+00","6":"1.28123121","7":"-2.065202e-13","8":"-0.0353105719","9":"0.10036510","10":"-0.81730150","11":"0","12":"-1.27858145","13":"0.000000000","14":"0.5098061817","15":"0.759943116","16":"-4.795251e-14","17":"0.0458087326","18":"0.268184779","19":"0.23518191","20":"0.000000e+00","21":"-0.13792369","22":"-0.612153968","23":"-0.624157208","24":"0.0000000000","25":"14.1994140","26":"0.000000e+00","27":"4.0385842","28":"3.49273480","29":"-3.0582351","30":"-2.2568522828","31":"3.5414980","32":"-0.856717327","33":"-0.5369195","34":"1.3041531964","35":"1.74106325","36":"42.0227832","37":"-14.0006742","38":"-1.19844178","39":"1.71852647","40":"0.43793187","41":"0.0000000","42":"-5.7470284","43":"0.0000000","44":"0.00000000","45":"1.55681769","46":"-2.88925918"},{"1":"2.505906e-04","2":"0.22604315","3":"-1.96123830","4":"-1.70263438","5":"0.000000e+00","6":"1.28710182","7":"-2.158982e-13","8":"-0.0354831694","9":"0.10028997","10":"-0.81924655","11":"0","12":"-1.28260732","13":"0.000000000","14":"0.5053249303","15":"0.766393329","16":"-5.796948e-14","17":"0.0461630012","18":"0.267694636","19":"0.23628248","20":"0.000000e+00","21":"-0.13660334","22":"-0.613887338","23":"-0.631121256","24":"0.0000000000","25":"15.0359594","26":"0.000000e+00","27":"4.0312303","28":"2.89024774","29":"-3.9272046","30":"-2.3295006360","31":"3.6545512","32":"-0.862098093","33":"-0.7134830","34":"1.4239054508","35":"1.74394833","36":"42.3721410","37":"-14.5942344","38":"-1.12375121","39":"1.82337293","40":"0.41393654","41":"0.0000000","42":"-5.8205330","43":"0.0000000","44":"0.00000000","45":"1.57150686","46":"-2.91606282"},{"1":"2.283288e-04","2":"0.22968506","3":"-1.96302239","4":"-1.71298846","5":"0.000000e+00","6":"1.29257717","7":"-2.269935e-13","8":"-0.0356427977","9":"0.10023480","10":"-0.82105742","11":"0","12":"-1.28629208","13":"0.000000000","14":"0.5014957078","15":"0.772336490","16":"-6.361878e-14","17":"0.0464931076","18":"0.267236176","19":"0.23730441","20":"0.000000e+00","21":"-0.13551290","22":"-0.615520014","23":"-0.637555288","24":"0.0000000000","25":"15.8108335","26":"0.000000e+00","27":"4.0246357","28":"2.33177196","29":"-4.7294538","30":"-2.3942791631","31":"3.7557095","32":"-0.868630594","33":"-0.8728065","34":"1.5319929033","35":"1.74637712","36":"42.6940038","37":"-15.1455565","38":"-1.05588675","39":"1.92124983","40":"0.39221222","41":"0.0000000","42":"-5.8851796","43":"0.0000000","44":"0.00000000","45":"1.58524565","46":"-2.94083845"},{"1":"2.080447e-04","2":"0.23337611","3":"-1.96456577","4":"-1.72317030","5":"0.000000e+00","6":"1.29712692","7":"-2.206253e-13","8":"-0.0357901035","9":"0.09987794","10":"-0.82290379","11":"0","12":"-1.28881455","13":"0.000000000","14":"0.4970117072","15":"0.778032491","16":"-5.653150e-14","17":"0.0467850378","18":"0.266539651","19":"0.23823065","20":"0.000000e+00","21":"-0.13409707","22":"-0.617014757","23":"-0.643186726","24":"0.0000000000","25":"16.5435143","26":"0.000000e+00","27":"4.0131685","28":"1.80519147","29":"-5.4964398","30":"-2.4510286495","31":"3.8472273","32":"-0.878057334","33":"-1.0279997","34":"1.6372992416","35":"1.74781420","36":"42.9730769","37":"-15.5860769","38":"-0.98912022","39":"1.99580152","40":"0.37197645","41":"0.1187556","42":"-6.0308323","43":"0.0000000","44":"0.00000000","45":"1.59963114","46":"-2.99350437"},{"1":"1.895626e-04","2":"0.23727218","3":"-1.96591682","4":"-1.73289625","5":"0.000000e+00","6":"1.30083058","7":"-2.230056e-13","8":"-0.0359225548","9":"0.09905774","10":"-0.82466861","11":"0","12":"-1.29008439","13":"0.000000000","14":"0.4923665025","15":"0.783164995","16":"-5.378321e-14","17":"0.0470342642","18":"0.265194282","19":"0.23894496","20":"0.000000e+00","21":"-0.13241266","22":"-0.618362390","23":"-0.648152259","24":"0.0000000000","25":"17.2303660","26":"0.000000e+00","27":"3.9975106","28":"1.31396683","29":"-6.2209159","30":"-2.4981598846","31":"3.9262309","32":"-0.890570997","33":"-1.1796724","34":"1.7399413528","35":"1.74779851","36":"43.2175748","37":"-15.8834978","38":"-0.83120590","39":"2.03267388","40":"0.36055492","41":"0.3255215","42":"-6.3542255","43":"0.1154325","44":"0.00000000","45":"1.61334158","46":"-3.06932845"},{"1":"1.727224e-04","2":"0.24099941","3":"-1.96734715","4":"-1.74188672","5":"0.000000e+00","6":"1.30427111","7":"-2.288895e-13","8":"-0.0360432732","9":"0.09822968","10":"-0.82623210","11":"0","12":"-1.29102571","13":"0.000000000","14":"0.4882241228","15":"0.787840320","16":"-6.047139e-14","17":"0.0472630604","18":"0.263668214","19":"0.23954143","20":"0.000000e+00","21":"-0.13098594","22":"-0.619559007","23":"-0.652751826","24":"0.0000000000","25":"17.8716232","26":"0.000000e+00","27":"3.9822170","28":"0.85537848","29":"-6.8956738","30":"-2.5397823149","31":"3.9965824","32":"-0.903406288","33":"-1.3192542","34":"1.8345981261","35":"1.74775304","36":"43.4462838","37":"-16.1397917","38":"-0.62533370","39":"2.05929002","40":"0.35354137","41":"0.5172169","42":"-6.7234676","43":"0.2927179","44":"0.00000000","45":"1.62611963","46":"-3.13999061"},{"1":"1.573782e-04","2":"0.24443593","3":"-1.96889767","4":"-1.75019839","5":"0.000000e+00","6":"1.30743457","7":"-2.344320e-13","8":"-0.0361532288","9":"0.09750534","10":"-0.82766487","11":"0","12":"-1.29173568","13":"0.000000000","14":"0.4844640154","15":"0.792148888","16":"-6.175789e-14","17":"0.0474744963","18":"0.262184683","19":"0.24008011","20":"0.000000e+00","21":"-0.12981225","22":"-0.620629415","23":"-0.656958284","24":"0.0000000000","25":"18.4624411","26":"0.000000e+00","27":"3.9680497","28":"0.43323282","29":"-7.5160939","30":"-2.5770188384","31":"4.0598790","32":"-0.916118179","33":"-1.4449655","34":"1.9199324657","35":"1.74772834","36":"43.6575739","37":"-16.3814273","38":"-0.40867042","39":"2.08457728","40":"0.34715512","41":"0.6930886","42":"-7.0875462","43":"0.4817973","44":"0.00000000","45":"1.63787055","46":"-3.20510578"},{"1":"1.433971e-04","2":"0.24759813","3":"-1.97027759","4":"-1.75790763","5":"0.000000e+00","6":"1.31035551","7":"-2.270901e-13","8":"-0.0362551892","9":"0.09686829","10":"-0.82917737","11":"0","12":"-1.29211235","13":"0.000000000","14":"0.4815644765","15":"0.796094783","16":"-5.887119e-14","17":"0.0476658538","18":"0.260864492","19":"0.24068751","20":"0.000000e+00","21":"-0.12889360","22":"-0.621798409","23":"-0.660878672","24":"0.0000000000","25":"19.0271789","26":"0.000000e+00","27":"3.9536025","28":"0.02275975","29":"-8.1080564","30":"-2.6133119571","31":"4.1196611","32":"-0.924814609","33":"-1.5623250","34":"1.9993754833","35":"1.74753543","36":"43.8448804","37":"-16.6513375","38":"-0.18976202","39":"2.10555017","40":"0.34111232","41":"0.8720293","42":"-7.3942560","43":"0.6738884","44":"-0.06244678","45":"1.64877719","46":"-3.26952924"},{"1":"1.306581e-04","2":"0.25008828","3":"-1.97459460","4":"-1.76382661","5":"9.015757e-04","6":"1.31319883","7":"-2.243444e-13","8":"-0.0363462640","9":"0.09610439","10":"-0.83124185","11":"0","12":"-1.29285521","13":"-0.005624951","14":"0.4889415066","15":"0.800607290","16":"-5.740791e-14","17":"0.0479342288","18":"0.260427380","19":"0.24112935","20":"0.000000e+00","21":"-0.12673377","22":"-0.620726220","23":"-0.663644592","24":"0.0000000000","25":"19.2486994","26":"0.000000e+00","27":"3.9274975","28":"0.00000000","29":"-8.3458862","30":"-2.6321032720","31":"4.1540361","32":"-0.962643415","33":"-1.6227291","34":"2.0407830431","35":"1.74286971","36":"43.9683265","37":"-16.8835450","38":"-0.12984398","39":"2.09788370","40":"0.35834218","41":"1.0148113","42":"-7.4462085","43":"0.7868759","44":"-0.22022699","45":"1.65989560","46":"-3.33222288"},{"1":"1.190508e-04","2":"0.25216533","3":"-1.97759308","4":"-1.76835938","5":"1.729486e-03","6":"1.31545327","7":"-2.239555e-13","8":"-0.0364246559","9":"0.09571584","10":"-0.83315211","11":"0","12":"-1.29273119","13":"-0.012754077","14":"0.4916277651","15":"0.804599420","16":"-6.080197e-14","17":"0.0481417386","18":"0.260371538","19":"0.24171878","20":"0.000000e+00","21":"-0.12516128","22":"-0.619111491","23":"-0.665829021","24":"0.0000000000","25":"19.4066916","26":"0.000000e+00","27":"3.9107738","28":"0.00000000","29":"-8.5337910","30":"-2.6506609502","31":"4.1961659","32":"-0.995097634","33":"-1.6871127","34":"2.0840907599","35":"1.74117534","36":"44.0963715","37":"-17.1599668","38":"-0.05393601","39":"2.08809806","40":"0.37472599","41":"1.1575431","42":"-7.4646366","43":"0.9145646","44":"-0.42730667","45":"1.66745624","46":"-3.38927477"},{"1":"1.084747e-04","2":"0.25461973","3":"-1.98027653","4":"-1.77320899","5":"2.350469e-03","6":"1.31743090","7":"-2.252092e-13","8":"-0.0365097400","9":"0.09511081","10":"-0.83435688","11":"0","12":"-1.29276487","13":"-0.020743765","14":"0.4932546020","15":"0.808941906","16":"-6.035711e-14","17":"0.0483649180","18":"0.260588753","19":"0.24254010","20":"0.000000e+00","21":"-0.12321846","22":"-0.617382902","23":"-0.668331567","24":"0.0000000000","25":"19.5638233","26":"0.000000e+00","27":"3.8924955","28":"0.00000000","29":"-8.7314271","30":"-2.6776376349","31":"4.2523699","32":"-1.021217268","33":"-1.7681282","34":"2.1419123736","35":"1.74454601","36":"44.2289493","37":"-17.4652536","38":"0.00000000","39":"2.07210545","40":"0.39661587","41":"1.3271666","42":"-7.4341224","43":"1.0527515","44":"-0.71126135","45":"1.67521070","46":"-3.44807129"},{"1":"9.883809e-05","2":"0.25665232","3":"-1.98334237","4":"-1.77831644","5":"2.785649e-03","6":"1.31986135","7":"-2.244686e-13","8":"-0.0366027704","9":"0.09436713","10":"-0.83632981","11":"0","12":"-1.29268562","13":"-0.027918295","14":"0.4978208000","15":"0.813075466","16":"-5.972039e-14","17":"0.0486003794","18":"0.260770892","19":"0.24330367","20":"2.682942e-05","21":"-0.12105257","22":"-0.615585900","23":"-0.671092182","24":"-0.0001276613","25":"19.7342553","26":"0.000000e+00","27":"3.8705071","28":"0.00000000","29":"-8.9341203","30":"-2.7194723944","31":"4.3170229","32":"-1.028802926","33":"-1.8758270","34":"2.2140661260","35":"1.73991637","36":"44.3301266","37":"-17.7452949","38":"0.00000000","39":"2.02695091","40":"0.42624168","41":"1.5113467","42":"-7.3153894","43":"1.1536842","44":"-1.07330052","45":"1.68553029","46":"-3.51303702"},{"1":"9.005759e-05","2":"0.25705459","3":"-1.98459160","4":"-1.78452607","5":"1.305041e-03","6":"1.32198641","7":"-2.300044e-13","8":"-0.0366961757","9":"0.09361470","10":"-0.83799319","11":"0","12":"-1.29222429","13":"-0.034983988","14":"0.5023293216","15":"0.817243680","16":"-6.240096e-14","17":"0.0488152562","18":"0.261616965","19":"0.24457989","20":"4.480006e-04","21":"-0.11934145","22":"-0.615264667","23":"-0.676276355","24":"-0.0034448412","25":"19.8937264","26":"0.000000e+00","27":"3.8444365","28":"0.00000000","29":"-9.1415793","30":"-2.7761898753","31":"4.3999543","32":"-1.021897223","33":"-2.0012258","34":"2.2987822467","35":"1.73827946","36":"44.3743524","37":"-18.0125886","38":"0.00000000","39":"1.95922770","40":"0.46173763","41":"1.6947133","42":"-7.1080574","43":"1.2770001","44":"-1.55712806","45":"1.69448948","46":"-3.57172062"},{"1":"8.205712e-05","2":"0.25710054","3":"-1.98554288","4":"-1.78937883","5":"1.002919e-04","6":"1.32422647","7":"-2.297737e-13","8":"-0.0367754009","9":"0.09308621","10":"-0.83960452","11":"0","12":"-1.29213866","13":"-0.040186637","14":"0.5085055136","15":"0.820585302","16":"-6.587002e-14","17":"0.0490026093","18":"0.262064393","19":"0.24539549","20":"4.102786e-04","21":"-0.11862797","22":"-0.616086206","23":"-0.681399367","24":"-0.0068540564","25":"20.0182174","26":"0.000000e+00","27":"3.8286200","28":"0.00000000","29":"-9.2918743","30":"-2.8271260393","31":"4.4691466","32":"-1.006490129","33":"-2.1065688","34":"2.3694847782","35":"1.73470160","36":"44.4320689","37":"-18.2820797","38":"0.00000000","39":"1.89163383","40":"0.49722715","41":"1.8510623","42":"-6.8891229","43":"1.3993166","44":"-2.02515986","45":"1.70350579","46":"-3.62189034"},{"1":"7.476739e-05","2":"0.25815248","3":"-1.98558172","4":"-1.79242934","5":"9.089430e-05","6":"1.32626803","7":"-2.241787e-13","8":"-0.0368431532","9":"0.09273530","10":"-0.84094955","11":"0","12":"-1.29211572","13":"-0.044614100","14":"0.5141708238","15":"0.823415735","16":"-6.798071e-14","17":"0.0491640474","18":"0.262294599","19":"0.24591807","20":"1.810269e-04","21":"-0.11825169","22":"-0.616940337","23":"-0.685791521","24":"-0.0097412130","25":"20.1202263","26":"0.000000e+00","27":"3.8174219","28":"0.00000000","29":"-9.4135834","30":"-2.8699260353","31":"4.5278725","32":"-0.992745702","33":"-2.1934425","34":"2.4279239154","35":"1.73202528","36":"44.4936992","37":"-18.5293093","38":"0.00000000","39":"1.83193274","40":"0.52970437","41":"1.9822439","42":"-6.6906003","43":"1.5114994","44":"-2.43857125","45":"1.71112587","46":"-3.66413941"},{"1":"6.812526e-05","2":"0.25923358","3":"-1.98364526","4":"-1.79400188","5":"2.704724e-05","6":"1.32830777","7":"-2.285271e-13","8":"-0.0369018660","9":"0.09275447","10":"-0.84191256","11":"0","12":"-1.29210122","13":"-0.047750772","14":"0.5177494859","15":"0.825414190","16":"-7.171549e-14","17":"0.0492738341","18":"0.262846787","19":"0.24669806","20":"8.218323e-05","21":"-0.11854360","22":"-0.618725520","23":"-0.690389012","24":"-0.0130127863","25":"20.2430386","26":"0.000000e+00","27":"3.8147066","28":"-0.06827670","29":"-9.5557269","30":"-2.9155693341","31":"4.5901937","32":"-0.962373172","33":"-2.2788573","34":"2.4849076758","35":"1.73140770","36":"44.5617941","37":"-18.7640458","38":"0.00000000","39":"1.76659336","40":"0.56166539","41":"2.0911423","42":"-6.4776884","43":"1.6232153","44":"-2.85634111","45":"1.71647328","46":"-3.69441834"},{"1":"6.207320e-05","2":"0.26035951","3":"-1.98085946","4":"-1.79457203","5":"3.624046e-05","6":"1.33027643","7":"-2.261267e-13","8":"-0.0369501011","9":"0.09289810","10":"-0.84261267","11":"0","12":"-1.29226630","13":"-0.049571790","14":"0.5203115433","15":"0.826609723","16":"-6.599978e-14","17":"0.0493450387","18":"0.263504736","19":"0.24765394","20":"2.549534e-04","21":"-0.11903435","22":"-0.620935281","23":"-0.694314213","24":"-0.0158927053","25":"20.4064407","26":"0.000000e+00","27":"3.8178922","28":"-0.21003713","29":"-9.7330946","30":"-2.9522639445","31":"4.6419920","32":"-0.930607692","33":"-2.3504611","34":"2.5327432344","35":"1.73254840","36":"44.6434683","37":"-18.9726990","38":"0.00000000","39":"1.70302242","40":"0.59052822","41":"2.1889275","42":"-6.2917262","43":"1.7248702","44":"-3.22884354","45":"1.72006712","46":"-3.71940431"},{"1":"5.655879e-05","2":"0.26163579","3":"-1.97671545","4":"-1.79489839","5":"1.650408e-05","6":"1.33233605","7":"-2.285740e-13","8":"-0.0369991393","9":"0.09285724","10":"-0.84332307","11":"0","12":"-1.29212900","13":"-0.050854941","14":"0.5233903344","15":"0.827582283","16":"-6.365200e-14","17":"0.0494094682","18":"0.265010570","19":"0.24957375","20":"1.357212e-03","21":"-0.11910920","22":"-0.623321646","23":"-0.698497973","24":"-0.0191375188","25":"20.6360671","26":"0.000000e+00","27":"3.8162699","28":"-0.41642237","29":"-9.9825698","30":"-2.9918259838","31":"4.6969553","32":"-0.895367889","33":"-2.4231933","34":"2.5812199404","35":"1.73410409","36":"44.7074887","37":"-19.1862076","38":"0.02895674","39":"1.63146122","40":"0.62097925","41":"2.2867592","42":"-6.1009347","43":"1.8568473","44":"-3.63992279","45":"1.72312359","46":"-3.74337373"},{"1":"5.153426e-05","2":"0.26335493","3":"-1.96961753","4":"-1.79514757","5":"1.140561e-05","6":"1.33486940","7":"-2.258399e-13","8":"-0.0370532042","9":"0.09237056","10":"-0.84448958","11":"0","12":"-1.29014992","13":"-0.051977628","14":"0.5294262855","15":"0.828259501","16":"-6.896336e-14","17":"0.0494647455","18":"0.267323652","19":"0.25293943","20":"3.669813e-03","21":"-0.11957748","22":"-0.627113991","23":"-0.704563539","24":"-0.0244040339","25":"21.0482429","26":"0.000000e+00","27":"3.8031817","28":"-0.79484452","29":"-10.4271584","30":"-3.0541002680","31":"4.7764154","32":"-0.837735162","33":"-2.5109515","34":"2.6396745077","35":"1.73665718","36":"44.7404068","37":"-19.6044175","38":"0.33148596","39":"1.53949980","40":"0.65445718","41":"2.3980639","42":"-5.9351506","43":"2.2566376","44":"-4.31937914","45":"1.72617982","46":"-3.76891427"},{"1":"4.695610e-05","2":"0.26468202","3":"-1.96417558","4":"-1.79567749","5":"3.102003e-05","6":"1.33712503","7":"-2.218065e-13","8":"-0.0370949708","9":"0.09200752","10":"-0.84556923","11":"0","12":"-1.28766036","13":"-0.053364103","14":"0.5351959230","15":"0.828864801","16":"-6.429525e-14","17":"0.0495165563","18":"0.269320760","19":"0.25606666","20":"5.920421e-03","21":"-0.12021841","22":"-0.630192351","23":"-0.709509660","24":"-0.0287323819","25":"21.4345467","26":"0.000000e+00","27":"3.7913389","28":"-1.14591247","29":"-10.8388462","30":"-3.1075928968","31":"4.8447167","32":"-0.790905414","33":"-2.5691782","34":"2.6788857111","35":"1.73997819","36":"44.7854539","37":"-20.0932549","38":"0.73971836","39":"1.48210132","40":"0.67744313","41":"2.4715563","42":"-5.8606324","43":"2.7230003","44":"-4.93293463","45":"1.72842737","46":"-3.78708429"},{"1":"4.278465e-05","2":"0.26576583","3":"-1.95980406","4":"-1.79639755","5":"4.734389e-05","6":"1.33918843","7":"-2.300461e-13","8":"-0.0371301189","9":"0.09173010","10":"-0.84659900","11":"0","12":"-1.28503176","13":"-0.054869979","14":"0.5407224949","15":"0.829461670","16":"-7.018363e-14","17":"0.0495676503","18":"0.271178934","19":"0.25905612","20":"8.133729e-03","21":"-0.12083783","22":"-0.632689620","23":"-0.713664646","24":"-0.0323527871","25":"21.7959352","26":"-6.190934e-05","27":"3.7805124","28":"-1.47148657","29":"-11.2210154","30":"-3.1561737313","31":"4.9063844","32":"-0.749889545","33":"-2.6136617","34":"2.7090958497","35":"1.74334280","36":"44.8346838","37":"-20.6032395","38":"1.18073172","39":"1.44305746","40":"0.69458940","41":"2.5263792","42":"-5.8258031","43":"3.2013022","44":"-5.49897919","45":"1.73044215","46":"-3.80160572"},{"1":"3.898378e-05","2":"0.26750413","3":"-1.95681937","4":"-1.79623595","5":"0.000000e+00","6":"1.34083393","7":"-2.302071e-13","8":"-0.0371758419","9":"0.09198242","10":"-0.84753700","11":"0","12":"-1.28288610","13":"-0.056618664","14":"0.5418363773","15":"0.830102209","16":"-6.357224e-14","17":"0.0496662992","18":"0.272836978","19":"0.26157309","20":"9.855557e-03","21":"-0.12198374","22":"-0.635135695","23":"-0.718097914","24":"-0.0369360588","25":"21.9778208","26":"-9.394425e-02","27":"3.7866366","28":"-1.67691396","29":"-11.5237611","30":"-3.1925707484","31":"4.9569082","32":"-0.725698585","33":"-2.6510064","34":"2.7346403614","35":"1.74723025","36":"44.8916528","37":"-21.0929230","38":"1.56634963","39":"1.41941479","40":"0.70898528","41":"2.5664255","42":"-5.8016171","43":"3.6151201","44":"-5.97270689","45":"1.73233518","46":"-3.81309546"},{"1":"3.552057e-05","2":"0.26888958","3":"-1.95386407","4":"-1.79632609","5":"0.000000e+00","6":"1.34242536","7":"-2.343336e-13","8":"-0.0372096423","9":"0.09219971","10":"-0.84835591","11":"0","12":"-1.28019831","13":"-0.058574231","14":"0.5444769626","15":"0.830707778","16":"-6.574618e-14","17":"0.0497238903","18":"0.274342072","19":"0.26406777","20":"1.157227e-02","21":"-0.12291467","22":"-0.636896612","23":"-0.721529523","24":"-0.0402020712","25":"22.2107983","26":"-1.381336e-01","27":"3.7857369","28":"-1.90553806","29":"-11.8243603","30":"-3.2338828602","31":"5.0123205","32":"-0.693769668","33":"-2.6860910","34":"2.7582693039","35":"1.75037590","36":"44.9522559","37":"-21.5900447","38":"2.00456187","39":"1.39547861","40":"0.72153445","41":"2.6015784","42":"-5.8097101","43":"4.0753817","44":"-6.45960504","45":"1.73390678","46":"-3.82257717"},{"1":"3.236502e-05","2":"0.26986110","3":"-1.95166175","4":"-1.79678390","5":"0.000000e+00","6":"1.34389107","7":"-2.361536e-13","8":"-0.0372369820","9":"0.09231701","10":"-0.84913432","11":"0","12":"-1.27792875","13":"-0.060243296","14":"0.5476567695","15":"0.831298441","16":"-7.154285e-14","17":"0.0497754798","18":"0.275677406","19":"0.26628273","20":"1.314192e-02","21":"-0.12356862","22":"-0.638259788","23":"-0.724246106","24":"-0.0426643574","25":"22.4263638","26":"-1.637354e-01","27":"3.7834217","28":"-2.10854871","29":"-12.0816758","30":"-3.2705974114","31":"5.0599825","32":"-0.664832369","33":"-2.7152859","34":"2.7781274973","35":"1.75297265","36":"45.0027401","37":"-22.0273466","38":"2.38885800","39":"1.37529760","40":"0.73242073","41":"2.6327488","42":"-5.8126108","43":"4.4783210","44":"-6.88914587","45":"1.73558090","46":"-3.83133400"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>glmnet</code> also provides an automatic and efficient procedure to select <span class="math inline">\(\lambda\)</span> implementing K-fold Cross-Validation (see next question for an example implementation of the K-fold Cross-Validation method in general).</p>
<p>Functions <code>glmnet::cv.glmnet</code> / <code>glmnetUtils::cv.glmnet</code> fit the lasso path (ie multiple penalized models for multiple values of lambda) with the selection of the best lambda by K-Fold Cross-Validation (by default 10-fold) using a given criterion such as the AUC (<code>type.measure = "auc"</code>).</p>
<p>The function computes two optimal values: <code>lambda.min</code> is the value of lambda that gives minimum mean Cross-validated criterion; <code>lambda.1se</code> is the value of lambda that gives the most regularized model (highest lambda) such that the Cross-validated criterion is within one standard error of the minimum, it favours penalization/parsimony versus <code>lambda.min</code> (see <a href="https://stats.stackexchange.com/questions/138569/why-is-lambda-within-one-standard-error-from-the-minimum-is-a-recommended-valu">here</a>).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># glmnet::cv.glmnet / glmnetUtils::cv.glmnet fit the lasso path (ie multiple penalized models for multiple values of lambda) </span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># with selection of the best lambda by cross-validation (by default 10-fold)</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="co"># using a given criterion (type.measure = "auc")</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>desbois_lasso_cv <span class="ot">&lt;-</span> glmnetUtils<span class="sc">::</span><span class="fu">cv.glmnet</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>don_desbois, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">type.measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We can extract model coefficients for lambda = lambda.1se</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>lasso_coeffs <span class="ot">&lt;-</span> <span class="fu">coef</span>(desbois_lasso_cv, <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">name =</span> lasso_coeffs<span class="sc">@</span>Dimnames[[<span class="dv">1</span>]][lasso_coeffs<span class="sc">@</span>i <span class="sc">+</span> <span class="dv">1</span>], <span class="at">coefficient =</span> lasso_coeffs<span class="sc">@</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["coefficient"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-1.801207e+00"},{"1":"CNTYEure","2":"2.423569e-01"},{"1":"CNTYNord","2":"-8.498170e-01"},{"1":"CNTYOrne","2":"-5.709844e-01"},{"1":"STATUScompany","2":"3.588327e-01"},{"1":"STATUSEntreprise individuelle","2":"-4.613039e-14"},{"1":"HECTARE","2":"-2.044913e-02"},{"1":"ToFgeneral cropping","2":"-3.687416e-01"},{"1":"ToFmixed livestock","2":"-1.661832e-01"},{"1":"OWNLANDno","2":"4.192836e-03"},{"1":"OWNLANDyes","2":"-1.582905e-15"},{"1":"AGE","2":"5.472013e-03"},{"1":"HARVEST1988","2":"1.411453e-01"},{"1":"HARVEST1989","2":"5.293948e-02"},{"1":"HARVEST1992","2":"-1.228798e-01"},{"1":"HARVEST1993","2":"-3.858045e-03"},{"1":"r1","2":"4.395433e+00"},{"1":"r4","2":"2.745660e+00"},{"1":"r6","2":"1.646443e-01"},{"1":"r14","2":"1.447810e+00"},{"1":"r17","2":"9.942735e+00"},{"1":"r18","2":"6.333377e+00"},{"1":"r32","2":"-5.366974e+00"},{"1":"r36","2":"1.281705e-01"},{"1":"r37","2":"-7.667004e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>By default the <code>predict</code> function for a <code>cv.glmnet</code> model uses <code>lambda.1se</code>, but we can specify any value of lambda, in particular <code>lambda.min</code>, also note that the predict function outputs a <code>matrix</code> (<code>predict</code> functions in <code>R</code> outputs a vector in general):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">one_se =</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(desbois_lasso_cv, <span class="at">newdata =</span> don_desbois, <span class="at">s =</span> desbois_lasso_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="at">type =</span> <span class="st">"response"</span>)),<span class="co"># specifying lambda = lambda.1se</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">min =</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(desbois_lasso_cv, <span class="at">newdata =</span> don_desbois, <span class="at">s =</span> desbois_lasso_cv<span class="sc">$</span>lambda.min, <span class="at">type =</span> <span class="st">"response"</span>)),<span class="co"># specifying lambda = lambda.min</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">default =</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(desbois_lasso_cv, <span class="at">newdata =</span> don_desbois,  <span class="at">type =</span> <span class="st">"response"</span>))) <span class="co"># by default lambda = lambda.1se for a cv.glmnet model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["one_se"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["min"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["default"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.039582869","2":"1.127283e-02","3":"0.039582869"},{"1":"0.070251952","2":"2.377401e-02","3":"0.070251952"},{"1":"0.076283591","2":"2.144276e-02","3":"0.076283591"},{"1":"0.029513604","2":"1.115924e-02","3":"0.029513604"},{"1":"0.053468743","2":"9.674907e-03","3":"0.053468743"},{"1":"0.029240988","2":"9.568425e-03","3":"0.029240988"},{"1":"0.200180045","2":"1.793082e-01","3":"0.200180045"},{"1":"0.310519348","2":"2.461245e-01","3":"0.310519348"},{"1":"0.006509546","2":"2.600900e-03","3":"0.006509546"},{"1":"0.069124822","2":"3.621497e-02","3":"0.069124822"},{"1":"0.043556836","2":"1.840394e-02","3":"0.043556836"},{"1":"0.173792505","2":"8.680696e-02","3":"0.173792505"},{"1":"0.033325496","2":"1.110053e-02","3":"0.033325496"},{"1":"0.063389155","2":"3.041377e-02","3":"0.063389155"},{"1":"0.090491611","2":"8.756431e-02","3":"0.090491611"},{"1":"0.058014163","2":"3.720835e-02","3":"0.058014163"},{"1":"0.113484943","2":"6.969191e-02","3":"0.113484943"},{"1":"0.119511714","2":"9.441153e-02","3":"0.119511714"},{"1":"0.012274492","2":"3.944759e-03","3":"0.012274492"},{"1":"0.460472886","2":"3.332355e-01","3":"0.460472886"},{"1":"0.303676904","2":"3.687376e-01","3":"0.303676904"},{"1":"0.217051330","2":"2.104398e-01","3":"0.217051330"},{"1":"0.313787333","2":"3.874512e-01","3":"0.313787333"},{"1":"0.882302798","2":"9.636330e-01","3":"0.882302798"},{"1":"0.078012040","2":"4.083686e-02","3":"0.078012040"},{"1":"0.701776380","2":"8.268545e-01","3":"0.701776380"},{"1":"0.435247618","2":"4.365992e-01","3":"0.435247618"},{"1":"0.235916646","2":"3.816369e-01","3":"0.235916646"},{"1":"0.012730755","2":"2.117246e-03","3":"0.012730755"},{"1":"0.523131788","2":"4.613763e-01","3":"0.523131788"},{"1":"0.032563237","2":"2.924204e-03","3":"0.032563237"},{"1":"0.154623339","2":"5.588456e-02","3":"0.154623339"},{"1":"0.077098691","2":"4.030070e-02","3":"0.077098691"},{"1":"0.367726569","2":"4.962648e-01","3":"0.367726569"},{"1":"0.397457617","2":"3.642214e-01","3":"0.397457617"},{"1":"0.060539668","2":"3.285244e-02","3":"0.060539668"},{"1":"0.077144194","2":"8.497893e-02","3":"0.077144194"},{"1":"0.135860988","2":"3.322788e-02","3":"0.135860988"},{"1":"0.144554216","2":"2.668110e-02","3":"0.144554216"},{"1":"0.115466533","2":"9.836250e-02","3":"0.115466533"},{"1":"0.047035172","2":"1.240126e-02","3":"0.047035172"},{"1":"0.282804614","2":"4.301809e-01","3":"0.282804614"},{"1":"0.177609666","2":"1.873558e-01","3":"0.177609666"},{"1":"0.102367597","2":"4.304104e-02","3":"0.102367597"},{"1":"0.016751520","2":"1.683060e-03","3":"0.016751520"},{"1":"0.194545908","2":"1.668698e-01","3":"0.194545908"},{"1":"0.770292446","2":"7.536825e-01","3":"0.770292446"},{"1":"0.022396082","2":"1.057940e-02","3":"0.022396082"},{"1":"0.069098744","2":"1.800682e-02","3":"0.069098744"},{"1":"0.114741446","2":"6.015547e-02","3":"0.114741446"},{"1":"0.035461283","2":"1.489654e-02","3":"0.035461283"},{"1":"0.059804403","2":"3.907239e-02","3":"0.059804403"},{"1":"0.036932657","2":"4.912799e-03","3":"0.036932657"},{"1":"0.083313514","2":"4.425690e-02","3":"0.083313514"},{"1":"0.030105232","2":"4.075867e-03","3":"0.030105232"},{"1":"0.168735028","2":"6.753230e-02","3":"0.168735028"},{"1":"0.140472783","2":"1.697007e-01","3":"0.140472783"},{"1":"0.197374482","2":"1.124074e-01","3":"0.197374482"},{"1":"0.550515091","2":"6.593094e-01","3":"0.550515091"},{"1":"0.713761690","2":"8.614867e-01","3":"0.713761690"},{"1":"0.915377894","2":"9.156481e-01","3":"0.915377894"},{"1":"0.550297976","2":"6.549223e-01","3":"0.550297976"},{"1":"0.998088428","2":"9.998886e-01","3":"0.998088428"},{"1":"0.990450864","2":"9.973053e-01","3":"0.990450864"},{"1":"0.702083054","2":"6.906406e-01","3":"0.702083054"},{"1":"0.887067721","2":"9.587811e-01","3":"0.887067721"},{"1":"0.948212953","2":"9.784237e-01","3":"0.948212953"},{"1":"0.815955634","2":"8.911601e-01","3":"0.815955634"},{"1":"0.353908084","2":"4.427469e-01","3":"0.353908084"},{"1":"0.426828355","2":"3.867286e-01","3":"0.426828355"},{"1":"0.475911135","2":"6.802569e-01","3":"0.475911135"},{"1":"0.764162144","2":"9.202219e-01","3":"0.764162144"},{"1":"0.765317933","2":"8.775055e-01","3":"0.765317933"},{"1":"0.996873084","2":"9.997627e-01","3":"0.996873084"},{"1":"0.239452595","2":"2.264059e-01","3":"0.239452595"},{"1":"0.914325277","2":"9.917114e-01","3":"0.914325277"},{"1":"0.455196950","2":"5.323016e-01","3":"0.455196950"},{"1":"0.994873152","2":"9.997735e-01","3":"0.994873152"},{"1":"0.887231984","2":"9.697451e-01","3":"0.887231984"},{"1":"0.998171768","2":"9.998385e-01","3":"0.998171768"},{"1":"0.619550719","2":"7.853376e-01","3":"0.619550719"},{"1":"0.970375394","2":"9.581438e-01","3":"0.970375394"},{"1":"0.751450661","2":"9.371558e-01","3":"0.751450661"},{"1":"0.660693310","2":"8.894141e-01","3":"0.660693310"},{"1":"0.774369550","2":"9.887403e-01","3":"0.774369550"},{"1":"0.886924163","2":"9.702730e-01","3":"0.886924163"},{"1":"0.965192322","2":"9.958276e-01","3":"0.965192322"},{"1":"0.376195037","2":"5.201333e-01","3":"0.376195037"},{"1":"0.756315850","2":"9.646318e-01","3":"0.756315850"},{"1":"0.778179531","2":"8.526816e-01","3":"0.778179531"},{"1":"0.905579786","2":"8.765381e-01","3":"0.905579786"},{"1":"0.986363852","2":"9.981032e-01","3":"0.986363852"},{"1":"0.975042720","2":"9.952678e-01","3":"0.975042720"},{"1":"0.674843464","2":"7.908936e-01","3":"0.674843464"},{"1":"0.925189355","2":"9.755545e-01","3":"0.925189355"},{"1":"0.999070943","2":"9.998927e-01","3":"0.999070943"},{"1":"0.987874771","2":"9.995669e-01","3":"0.987874771"},{"1":"0.983627677","2":"9.981804e-01","3":"0.983627677"},{"1":"0.758125031","2":"9.153994e-01","3":"0.758125031"},{"1":"0.901897216","2":"9.736487e-01","3":"0.901897216"},{"1":"0.880580796","2":"9.554925e-01","3":"0.880580796"},{"1":"0.159075424","2":"8.219801e-02","3":"0.159075424"},{"1":"0.776475321","2":"9.210169e-01","3":"0.776475321"},{"1":"0.987586326","2":"9.990744e-01","3":"0.987586326"},{"1":"0.892188144","2":"9.843140e-01","3":"0.892188144"},{"1":"0.878733931","2":"9.392624e-01","3":"0.878733931"},{"1":"0.230655078","2":"1.698214e-01","3":"0.230655078"},{"1":"0.349142446","2":"2.865448e-01","3":"0.349142446"},{"1":"0.950744978","2":"9.656140e-01","3":"0.950744978"},{"1":"0.952763951","2":"9.953636e-01","3":"0.952763951"},{"1":"0.928602844","2":"9.914473e-01","3":"0.928602844"},{"1":"0.989053429","2":"9.988200e-01","3":"0.989053429"},{"1":"0.908754746","2":"9.870557e-01","3":"0.908754746"},{"1":"0.965800133","2":"9.956268e-01","3":"0.965800133"},{"1":"0.968809623","2":"9.912611e-01","3":"0.968809623"},{"1":"0.832284532","2":"9.319161e-01","3":"0.832284532"},{"1":"0.020005716","2":"1.745539e-03","3":"0.020005716"},{"1":"0.095255142","2":"2.923110e-02","3":"0.095255142"},{"1":"0.206597803","2":"1.645505e-01","3":"0.206597803"},{"1":"0.156289170","2":"1.190966e-01","3":"0.156289170"},{"1":"0.262214402","2":"2.931077e-01","3":"0.262214402"},{"1":"0.073837160","2":"4.900520e-02","3":"0.073837160"},{"1":"0.250830919","2":"2.121821e-01","3":"0.250830919"},{"1":"0.335510474","2":"3.542610e-01","3":"0.335510474"},{"1":"0.008736148","2":"5.424478e-03","3":"0.008736148"},{"1":"0.310511099","2":"2.909530e-01","3":"0.310511099"},{"1":"0.106565039","2":"9.934325e-02","3":"0.106565039"},{"1":"0.235662209","2":"9.629503e-02","3":"0.235662209"},{"1":"0.022072272","2":"4.288618e-03","3":"0.022072272"},{"1":"0.059109502","2":"2.124699e-02","3":"0.059109502"},{"1":"0.070160605","2":"6.921901e-02","3":"0.070160605"},{"1":"0.039572051","2":"2.238389e-02","3":"0.039572051"},{"1":"0.138770256","2":"6.599620e-02","3":"0.138770256"},{"1":"0.032674959","2":"1.968680e-02","3":"0.032674959"},{"1":"0.008782046","2":"1.838804e-03","3":"0.008782046"},{"1":"0.596679018","2":"7.415261e-01","3":"0.596679018"},{"1":"0.194808040","2":"1.954932e-01","3":"0.194808040"},{"1":"0.174386419","2":"1.401496e-01","3":"0.174386419"},{"1":"0.274174953","2":"2.903179e-01","3":"0.274174953"},{"1":"0.794834714","2":"9.081628e-01","3":"0.794834714"},{"1":"0.103292477","2":"3.861029e-02","3":"0.103292477"},{"1":"0.814565579","2":"8.948357e-01","3":"0.814565579"},{"1":"0.241573289","2":"2.102415e-01","3":"0.241573289"},{"1":"0.282753957","2":"4.502949e-01","3":"0.282753957"},{"1":"0.013500911","2":"1.323353e-03","3":"0.013500911"},{"1":"0.323310088","2":"2.163737e-01","3":"0.323310088"},{"1":"0.024805431","2":"1.892366e-03","3":"0.024805431"},{"1":"0.140568880","2":"3.990672e-02","3":"0.140568880"},{"1":"0.082197171","2":"6.627670e-02","3":"0.082197171"},{"1":"0.244883772","2":"3.633911e-01","3":"0.244883772"},{"1":"0.425956611","2":"5.547619e-01","3":"0.425956611"},{"1":"0.017500076","2":"2.311644e-03","3":"0.017500076"},{"1":"0.060131472","2":"4.932172e-02","3":"0.060131472"},{"1":"0.089479957","2":"1.980682e-02","3":"0.089479957"},{"1":"0.048404388","2":"2.886794e-03","3":"0.048404388"},{"1":"0.285947966","2":"3.066970e-01","3":"0.285947966"},{"1":"0.051597218","2":"9.099120e-03","3":"0.051597218"},{"1":"0.044181394","2":"1.300946e-02","3":"0.044181394"},{"1":"0.097223194","2":"1.135007e-01","3":"0.097223194"},{"1":"0.089157850","2":"4.080484e-02","3":"0.089157850"},{"1":"0.066873627","2":"2.158909e-02","3":"0.066873627"},{"1":"0.119184314","2":"1.061801e-01","3":"0.119184314"},{"1":"0.453843470","2":"2.388153e-01","3":"0.453843470"},{"1":"0.088810732","2":"6.680032e-02","3":"0.088810732"},{"1":"0.046540441","2":"9.172776e-03","3":"0.046540441"},{"1":"0.080621947","2":"5.250907e-02","3":"0.080621947"},{"1":"0.014689294","2":"1.868675e-03","3":"0.014689294"},{"1":"0.065864684","2":"4.863137e-02","3":"0.065864684"},{"1":"0.050432515","2":"9.076149e-03","3":"0.050432515"},{"1":"0.055911095","2":"1.697912e-02","3":"0.055911095"},{"1":"0.028838452","2":"5.351046e-03","3":"0.028838452"},{"1":"0.126447979","2":"5.668651e-02","3":"0.126447979"},{"1":"0.081329541","2":"5.315197e-02","3":"0.081329541"},{"1":"0.233007254","2":"1.341275e-01","3":"0.233007254"},{"1":"0.611390168","2":"7.077839e-01","3":"0.611390168"},{"1":"0.489987311","2":"5.908799e-01","3":"0.489987311"},{"1":"0.953664490","2":"9.468316e-01","3":"0.953664490"},{"1":"0.920312972","2":"9.939000e-01","3":"0.920312972"},{"1":"0.972920199","2":"9.930577e-01","3":"0.972920199"},{"1":"0.861004206","2":"9.329257e-01","3":"0.861004206"},{"1":"0.832464036","2":"8.701420e-01","3":"0.832464036"},{"1":"0.700592687","2":"8.611116e-01","3":"0.700592687"},{"1":"0.881761257","2":"9.456423e-01","3":"0.881761257"},{"1":"0.530431831","2":"6.466181e-01","3":"0.530431831"},{"1":"0.161104899","2":"1.150265e-01","3":"0.161104899"},{"1":"0.698715623","2":"7.540164e-01","3":"0.698715623"},{"1":"0.653023586","2":"7.900417e-01","3":"0.653023586"},{"1":"0.291140653","2":"3.900198e-01","3":"0.291140653"},{"1":"0.236578046","2":"1.957847e-01","3":"0.236578046"},{"1":"0.990000857","2":"9.989847e-01","3":"0.990000857"},{"1":"0.228977995","2":"1.725947e-01","3":"0.228977995"},{"1":"0.696696992","2":"9.037359e-01","3":"0.696696992"},{"1":"0.671961754","2":"7.449885e-01","3":"0.671961754"},{"1":"0.998502831","2":"9.999740e-01","3":"0.998502831"},{"1":"0.884722135","2":"9.641930e-01","3":"0.884722135"},{"1":"0.992182604","2":"9.988766e-01","3":"0.992182604"},{"1":"0.988508635","2":"9.994226e-01","3":"0.988508635"},{"1":"0.901095874","2":"8.500200e-01","3":"0.901095874"},{"1":"0.686931484","2":"8.967176e-01","3":"0.686931484"},{"1":"0.685834929","2":"9.232317e-01","3":"0.685834929"},{"1":"0.952614833","2":"9.989679e-01","3":"0.952614833"},{"1":"0.950493258","2":"9.932962e-01","3":"0.950493258"},{"1":"0.989470978","2":"9.992394e-01","3":"0.989470978"},{"1":"0.482168754","2":"5.737952e-01","3":"0.482168754"},{"1":"0.629937447","2":"8.894339e-01","3":"0.629937447"},{"1":"0.924230174","2":"9.854151e-01","3":"0.924230174"},{"1":"0.992177396","2":"9.964723e-01","3":"0.992177396"},{"1":"0.945330678","2":"9.936753e-01","3":"0.945330678"},{"1":"0.839997510","2":"9.309703e-01","3":"0.839997510"},{"1":"0.839355527","2":"9.337755e-01","3":"0.839355527"},{"1":"0.973950295","2":"9.942066e-01","3":"0.973950295"},{"1":"0.976145000","2":"9.975753e-01","3":"0.976145000"},{"1":"0.984623848","2":"9.991963e-01","3":"0.984623848"},{"1":"0.978100179","2":"9.937412e-01","3":"0.978100179"},{"1":"0.593760796","2":"7.839473e-01","3":"0.593760796"},{"1":"0.928562432","2":"9.807580e-01","3":"0.928562432"},{"1":"0.870665426","2":"9.456979e-01","3":"0.870665426"},{"1":"0.144330061","2":"5.813363e-02","3":"0.144330061"},{"1":"0.867067045","2":"9.661002e-01","3":"0.867067045"},{"1":"0.946099986","2":"9.917803e-01","3":"0.946099986"},{"1":"0.917721776","2":"9.790800e-01","3":"0.917721776"},{"1":"0.964721003","2":"9.859266e-01","3":"0.964721003"},{"1":"0.380967136","2":"3.744953e-01","3":"0.380967136"},{"1":"0.298131973","2":"2.437799e-01","3":"0.298131973"},{"1":"0.974440910","2":"9.849551e-01","3":"0.974440910"},{"1":"0.979536096","2":"9.985778e-01","3":"0.979536096"},{"1":"0.945514867","2":"9.918054e-01","3":"0.945514867"},{"1":"0.909043773","2":"9.709270e-01","3":"0.909043773"},{"1":"0.846589264","2":"9.746312e-01","3":"0.846589264"},{"1":"0.953819593","2":"9.921533e-01","3":"0.953819593"},{"1":"0.992156305","2":"9.993801e-01","3":"0.992156305"},{"1":"0.863725950","2":"9.470973e-01","3":"0.863725950"},{"1":"0.010944979","2":"1.537643e-03","3":"0.010944979"},{"1":"0.061364864","2":"1.835744e-02","3":"0.061364864"},{"1":"0.066381742","2":"2.349345e-02","3":"0.066381742"},{"1":"0.072800553","2":"4.432055e-02","3":"0.072800553"},{"1":"0.212365190","2":"9.607941e-02","3":"0.212365190"},{"1":"0.106038351","2":"9.705860e-02","3":"0.106038351"},{"1":"0.155141781","2":"5.807415e-02","3":"0.155141781"},{"1":"0.597810350","2":"6.472801e-01","3":"0.597810350"},{"1":"0.007971185","2":"1.479048e-03","3":"0.007971185"},{"1":"0.079176324","2":"5.952024e-02","3":"0.079176324"},{"1":"0.051998948","2":"1.666228e-02","3":"0.051998948"},{"1":"0.243527270","2":"1.081136e-01","3":"0.243527270"},{"1":"0.043725003","2":"2.388171e-02","3":"0.043725003"},{"1":"0.083283184","2":"2.718378e-02","3":"0.083283184"},{"1":"0.210043322","2":"2.373137e-01","3":"0.210043322"},{"1":"0.037883285","2":"2.089620e-02","3":"0.037883285"},{"1":"0.210025321","2":"1.071564e-01","3":"0.210025321"},{"1":"0.075164226","2":"3.214840e-02","3":"0.075164226"},{"1":"0.011606684","2":"2.784188e-03","3":"0.011606684"},{"1":"0.385758564","2":"1.794694e-01","3":"0.385758564"},{"1":"0.153256689","2":"8.192948e-02","3":"0.153256689"},{"1":"0.188187985","2":"2.820004e-01","3":"0.188187985"},{"1":"0.253742374","2":"1.848771e-01","3":"0.253742374"},{"1":"0.725088863","2":"8.688975e-01","3":"0.725088863"},{"1":"0.073553757","2":"2.527767e-02","3":"0.073553757"},{"1":"0.613083635","2":"7.089402e-01","3":"0.613083635"},{"1":"0.451813102","2":"4.407577e-01","3":"0.451813102"},{"1":"0.097020330","2":"8.394682e-02","3":"0.097020330"},{"1":"0.023552091","2":"4.232700e-03","3":"0.023552091"},{"1":"0.289270028","2":"1.594406e-01","3":"0.289270028"},{"1":"0.038817180","2":"4.050540e-03","3":"0.038817180"},{"1":"0.119531120","2":"2.670979e-02","3":"0.119531120"},{"1":"0.083378317","2":"4.065745e-02","3":"0.083378317"},{"1":"0.244289223","2":"2.237029e-01","3":"0.244289223"},{"1":"0.591904171","2":"6.744395e-01","3":"0.591904171"},{"1":"0.028606335","2":"1.121125e-02","3":"0.028606335"},{"1":"0.070999252","2":"4.531643e-02","3":"0.070999252"},{"1":"0.046484974","2":"4.883884e-03","3":"0.046484974"},{"1":"0.198703586","2":"3.310557e-02","3":"0.198703586"},{"1":"0.157185931","2":"1.635105e-01","3":"0.157185931"},{"1":"0.079230110","2":"3.004197e-02","3":"0.079230110"},{"1":"0.036995837","2":"8.223460e-03","3":"0.036995837"},{"1":"0.207867786","2":"1.327048e-01","3":"0.207867786"},{"1":"0.133623897","2":"8.883142e-02","3":"0.133623897"},{"1":"0.045785243","2":"1.613829e-02","3":"0.045785243"},{"1":"0.186733755","2":"1.701513e-01","3":"0.186733755"},{"1":"0.623613424","2":"4.102526e-01","3":"0.623613424"},{"1":"0.118345981","2":"1.084980e-01","3":"0.118345981"},{"1":"0.133924344","2":"4.116702e-02","3":"0.133924344"},{"1":"0.102226176","2":"9.428295e-02","3":"0.102226176"},{"1":"0.026671860","2":"3.674598e-03","3":"0.026671860"},{"1":"0.065589978","2":"2.712532e-02","3":"0.065589978"},{"1":"0.085159781","2":"1.613245e-02","3":"0.085159781"},{"1":"0.247432475","2":"3.028990e-01","3":"0.247432475"},{"1":"0.017972698","2":"1.696778e-03","3":"0.017972698"},{"1":"0.193351118","2":"8.079063e-02","3":"0.193351118"},{"1":"0.090690356","2":"6.697604e-02","3":"0.090690356"},{"1":"0.331557984","2":"2.106252e-01","3":"0.331557984"},{"1":"0.741684580","2":"7.580458e-01","3":"0.741684580"},{"1":"0.790412984","2":"9.242097e-01","3":"0.790412984"},{"1":"0.983520673","2":"9.883415e-01","3":"0.983520673"},{"1":"0.781524544","2":"9.312027e-01","3":"0.781524544"},{"1":"0.996092897","2":"9.995019e-01","3":"0.996092897"},{"1":"0.929051722","2":"9.825657e-01","3":"0.929051722"},{"1":"0.693430385","2":"6.300158e-01","3":"0.693430385"},{"1":"0.859973809","2":"9.434228e-01","3":"0.859973809"},{"1":"0.970590545","2":"9.910641e-01","3":"0.970590545"},{"1":"0.738809829","2":"7.083986e-01","3":"0.738809829"},{"1":"0.114196418","2":"8.475684e-02","3":"0.114196418"},{"1":"0.480523281","2":"3.898794e-01","3":"0.480523281"},{"1":"0.659430493","2":"7.974653e-01","3":"0.659430493"},{"1":"0.264502830","2":"2.328052e-01","3":"0.264502830"},{"1":"0.652384586","2":"7.486035e-01","3":"0.652384586"},{"1":"0.998691738","2":"9.999653e-01","3":"0.998691738"},{"1":"0.526301722","2":"5.937846e-01","3":"0.526301722"},{"1":"0.701715599","2":"8.985443e-01","3":"0.701715599"},{"1":"0.395901429","2":"3.673128e-01","3":"0.395901429"},{"1":"0.998619682","2":"9.999552e-01","3":"0.998619682"},{"1":"0.961812891","2":"9.889680e-01","3":"0.961812891"},{"1":"0.998305676","2":"9.999228e-01","3":"0.998305676"},{"1":"0.956038014","2":"9.939341e-01","3":"0.956038014"},{"1":"0.990752383","2":"9.937976e-01","3":"0.990752383"},{"1":"0.951741220","2":"9.915608e-01","3":"0.951741220"},{"1":"0.238473363","2":"5.304836e-01","3":"0.238473363"},{"1":"0.983392356","2":"9.997735e-01","3":"0.983392356"},{"1":"0.966341008","2":"9.968527e-01","3":"0.966341008"},{"1":"0.991470924","2":"9.994012e-01","3":"0.991470924"},{"1":"0.484811493","2":"5.366034e-01","3":"0.484811493"},{"1":"0.396441095","2":"5.993219e-01","3":"0.396441095"},{"1":"0.988733964","2":"9.991513e-01","3":"0.988733964"},{"1":"0.992663149","2":"9.959882e-01","3":"0.992663149"},{"1":"0.975735693","2":"9.957357e-01","3":"0.975735693"},{"1":"0.817308511","2":"8.848307e-01","3":"0.817308511"},{"1":"0.953614398","2":"9.877568e-01","3":"0.953614398"},{"1":"0.995051115","2":"9.995337e-01","3":"0.995051115"},{"1":"0.991022168","2":"9.991246e-01","3":"0.991022168"},{"1":"0.999088208","2":"9.999537e-01","3":"0.999088208"},{"1":"0.996480860","2":"9.994314e-01","3":"0.996480860"},{"1":"0.439633425","2":"5.405761e-01","3":"0.439633425"},{"1":"0.907991763","2":"9.767312e-01","3":"0.907991763"},{"1":"0.968963309","2":"9.923005e-01","3":"0.968963309"},{"1":"0.211116939","2":"1.369894e-01","3":"0.211116939"},{"1":"0.698787626","2":"8.447693e-01","3":"0.698787626"},{"1":"0.943843541","2":"9.854109e-01","3":"0.943843541"},{"1":"0.949484664","2":"9.912890e-01","3":"0.949484664"},{"1":"0.933757062","2":"9.775731e-01","3":"0.933757062"},{"1":"0.338616370","2":"2.957156e-01","3":"0.338616370"},{"1":"0.588396103","2":"6.334008e-01","3":"0.588396103"},{"1":"0.990811604","2":"9.982691e-01","3":"0.990811604"},{"1":"0.964551985","2":"9.960016e-01","3":"0.964551985"},{"1":"0.968077466","2":"9.969248e-01","3":"0.968077466"},{"1":"0.619621713","2":"6.929450e-01","3":"0.619621713"},{"1":"0.361503355","2":"6.817157e-01","3":"0.361503355"},{"1":"0.967938187","2":"9.949842e-01","3":"0.967938187"},{"1":"0.962349393","2":"9.782471e-01","3":"0.962349393"},{"1":"0.749689355","2":"8.274812e-01","3":"0.749689355"},{"1":"0.099721925","2":"3.581246e-02","3":"0.099721925"},{"1":"0.019955424","2":"9.998100e-03","3":"0.019955424"},{"1":"0.024413900","2":"1.791930e-03","3":"0.024413900"},{"1":"0.210999768","2":"1.891354e-01","3":"0.210999768"},{"1":"0.502393463","2":"4.286672e-01","3":"0.502393463"},{"1":"0.002199385","2":"9.749982e-05","3":"0.002199385"},{"1":"0.025550861","2":"2.437165e-03","3":"0.025550861"},{"1":"0.371976141","2":"4.330498e-01","3":"0.371976141"},{"1":"0.392969199","2":"1.699990e-01","3":"0.392969199"},{"1":"0.544016349","2":"5.410598e-01","3":"0.544016349"},{"1":"0.752482277","2":"5.150648e-01","3":"0.752482277"},{"1":"0.341213450","2":"2.041733e-01","3":"0.341213450"},{"1":"0.069210555","2":"8.247618e-03","3":"0.069210555"},{"1":"0.112291969","2":"1.496799e-02","3":"0.112291969"},{"1":"0.011132958","2":"1.000765e-03","3":"0.011132958"},{"1":"0.016685991","2":"8.577597e-04","3":"0.016685991"},{"1":"0.101705650","2":"6.887802e-02","3":"0.101705650"},{"1":"0.362115589","2":"3.829455e-01","3":"0.362115589"},{"1":"0.016675435","2":"3.075464e-03","3":"0.016675435"},{"1":"0.135107829","2":"1.270621e-01","3":"0.135107829"},{"1":"0.017620799","2":"8.798991e-04","3":"0.017620799"},{"1":"0.091226195","2":"7.733687e-03","3":"0.091226195"},{"1":"0.003344934","2":"1.361212e-04","3":"0.003344934"},{"1":"0.658592671","2":"5.682410e-01","3":"0.658592671"},{"1":"0.113579089","2":"1.164329e-02","3":"0.113579089"},{"1":"0.189702788","2":"1.218734e-01","3":"0.189702788"},{"1":"0.096273509","2":"3.283684e-02","3":"0.096273509"},{"1":"0.250425615","2":"1.091649e-01","3":"0.250425615"},{"1":"0.748081400","2":"6.847307e-01","3":"0.748081400"},{"1":"0.530369930","2":"5.732073e-01","3":"0.530369930"},{"1":"0.088379722","2":"3.019737e-02","3":"0.088379722"},{"1":"0.023281278","2":"3.207628e-03","3":"0.023281278"},{"1":"0.090913702","2":"3.236729e-02","3":"0.090913702"},{"1":"0.051023971","2":"1.041762e-02","3":"0.051023971"},{"1":"0.108304305","2":"4.805264e-02","3":"0.108304305"},{"1":"0.030568090","2":"7.739588e-03","3":"0.030568090"},{"1":"0.092177437","2":"3.063579e-02","3":"0.092177437"},{"1":"0.387655574","2":"1.791995e-01","3":"0.387655574"},{"1":"0.415989856","2":"1.563216e-01","3":"0.415989856"},{"1":"0.868966689","2":"8.600375e-01","3":"0.868966689"},{"1":"0.200745084","2":"8.727301e-02","3":"0.200745084"},{"1":"0.447098243","2":"2.431420e-01","3":"0.447098243"},{"1":"0.026874848","2":"4.953272e-03","3":"0.026874848"},{"1":"0.288566752","2":"1.988426e-01","3":"0.288566752"},{"1":"0.306404651","2":"2.442723e-02","3":"0.306404651"},{"1":"0.062498210","2":"8.902793e-04","3":"0.062498210"},{"1":"0.008028369","2":"1.535678e-04","3":"0.008028369"},{"1":"0.139022702","2":"3.340041e-02","3":"0.139022702"},{"1":"0.987431201","2":"9.667053e-01","3":"0.987431201"},{"1":"0.005498474","2":"1.394732e-04","3":"0.005498474"},{"1":"0.010502347","2":"4.268656e-04","3":"0.010502347"},{"1":"0.002219563","2":"2.053752e-05","3":"0.002219563"},{"1":"0.467118539","2":"3.234445e-01","3":"0.467118539"},{"1":"0.468475324","2":"1.375993e-01","3":"0.468475324"},{"1":"0.399652743","2":"4.224021e-01","3":"0.399652743"},{"1":"0.986101899","2":"9.988544e-01","3":"0.986101899"},{"1":"0.161104277","2":"7.960677e-02","3":"0.161104277"},{"1":"0.590610573","2":"6.853508e-01","3":"0.590610573"},{"1":"1.000000000","2":"1.000000e+00","3":"1.000000000"},{"1":"0.892407478","2":"9.707036e-01","3":"0.892407478"},{"1":"0.996403450","2":"9.998083e-01","3":"0.996403450"},{"1":"0.458910472","2":"2.599153e-01","3":"0.458910472"},{"1":"0.984199121","2":"9.985887e-01","3":"0.984199121"},{"1":"0.006093050","2":"8.862762e-04","3":"0.006093050"},{"1":"0.970116631","2":"9.993273e-01","3":"0.970116631"},{"1":"0.200049436","2":"6.182201e-01","3":"0.200049436"},{"1":"0.870484730","2":"9.975334e-01","3":"0.870484730"},{"1":"0.991633538","2":"9.996853e-01","3":"0.991633538"},{"1":"0.853273853","2":"8.197687e-01","3":"0.853273853"},{"1":"0.674185345","2":"7.626477e-01","3":"0.674185345"},{"1":"0.780111580","2":"8.327603e-01","3":"0.780111580"},{"1":"0.909348340","2":"9.796825e-01","3":"0.909348340"},{"1":"0.726463573","2":"8.573106e-01","3":"0.726463573"},{"1":"0.770338419","2":"8.345947e-01","3":"0.770338419"},{"1":"0.337511962","2":"1.932334e-01","3":"0.337511962"},{"1":"0.999971316","2":"1.000000e+00","3":"0.999971316"},{"1":"0.615614658","2":"5.817631e-01","3":"0.615614658"},{"1":"0.802322348","2":"9.243596e-01","3":"0.802322348"},{"1":"0.602889705","2":"5.340792e-01","3":"0.602889705"},{"1":"0.975564573","2":"9.921149e-01","3":"0.975564573"},{"1":"0.664292314","2":"7.560726e-01","3":"0.664292314"},{"1":"0.996328328","2":"9.997946e-01","3":"0.996328328"},{"1":"0.849628526","2":"9.057645e-01","3":"0.849628526"},{"1":"0.941859045","2":"9.925880e-01","3":"0.941859045"},{"1":"0.949519404","2":"9.855992e-01","3":"0.949519404"},{"1":"0.478528203","2":"5.948454e-01","3":"0.478528203"},{"1":"0.963880726","2":"9.834543e-01","3":"0.963880726"},{"1":"0.783554228","2":"8.309741e-01","3":"0.783554228"},{"1":"0.999227401","2":"9.999998e-01","3":"0.999227401"},{"1":"0.996368963","2":"9.999532e-01","3":"0.996368963"},{"1":"0.940896076","2":"9.630300e-01","3":"0.940896076"},{"1":"0.971803154","2":"9.951686e-01","3":"0.971803154"},{"1":"0.440674314","2":"4.612664e-01","3":"0.440674314"},{"1":"0.870290781","2":"9.301927e-01","3":"0.870290781"},{"1":"0.788553924","2":"8.698896e-01","3":"0.788553924"},{"1":"0.107338060","2":"3.962261e-02","3":"0.107338060"},{"1":"0.018278621","2":"7.907264e-03","3":"0.018278621"},{"1":"0.015717066","2":"9.451578e-04","3":"0.015717066"},{"1":"0.098275819","2":"4.292224e-02","3":"0.098275819"},{"1":"0.414155193","2":"2.485841e-01","3":"0.414155193"},{"1":"0.002325305","2":"3.405467e-05","3":"0.002325305"},{"1":"0.028743131","2":"3.404216e-03","3":"0.028743131"},{"1":"0.265726599","2":"2.615338e-01","3":"0.265726599"},{"1":"0.424330274","2":"1.765166e-01","3":"0.424330274"},{"1":"0.718057163","2":"7.725819e-01","3":"0.718057163"},{"1":"0.775988448","2":"5.243667e-01","3":"0.775988448"},{"1":"0.690410357","2":"6.023316e-01","3":"0.690410357"},{"1":"0.018776619","2":"1.722375e-03","3":"0.018776619"},{"1":"0.046166707","2":"3.094325e-03","3":"0.046166707"},{"1":"0.010834826","2":"1.014438e-03","3":"0.010834826"},{"1":"0.017810000","2":"9.541839e-04","3":"0.017810000"},{"1":"0.023702640","2":"2.003223e-03","3":"0.023702640"},{"1":"0.387156554","2":"3.064355e-01","3":"0.387156554"},{"1":"0.020188880","2":"2.255557e-03","3":"0.020188880"},{"1":"0.107107644","2":"5.785137e-02","3":"0.107107644"},{"1":"0.057015496","2":"6.596216e-03","3":"0.057015496"},{"1":"0.260637584","2":"6.823301e-02","3":"0.260637584"},{"1":"0.005512235","2":"2.131335e-04","3":"0.005512235"},{"1":"0.259279534","2":"1.981493e-01","3":"0.259279534"},{"1":"0.150609522","2":"6.707448e-02","3":"0.150609522"},{"1":"0.395672675","2":"1.540680e-01","3":"0.395672675"},{"1":"0.175200224","2":"9.162229e-02","3":"0.175200224"},{"1":"0.047766072","2":"6.732815e-03","3":"0.047766072"},{"1":"0.248361394","2":"8.949780e-02","3":"0.248361394"},{"1":"0.781465560","2":"7.260048e-01","3":"0.781465560"},{"1":"0.316139535","2":"1.780212e-01","3":"0.316139535"},{"1":"0.034472876","2":"4.507579e-03","3":"0.034472876"},{"1":"0.014878997","2":"1.384512e-03","3":"0.014878997"},{"1":"0.040488729","2":"6.160375e-03","3":"0.040488729"},{"1":"0.043618850","2":"6.251210e-03","3":"0.043618850"},{"1":"0.098156007","2":"2.188402e-02","3":"0.098156007"},{"1":"0.244873842","2":"2.271125e-01","3":"0.244873842"},{"1":"0.221637011","2":"1.190498e-01","3":"0.221637011"},{"1":"0.406433498","2":"1.533899e-01","3":"0.406433498"},{"1":"0.357078385","2":"1.142396e-01","3":"0.357078385"},{"1":"0.879906968","2":"8.415462e-01","3":"0.879906968"},{"1":"0.172692956","2":"8.744113e-02","3":"0.172692956"},{"1":"0.813182469","2":"7.821512e-01","3":"0.813182469"},{"1":"0.055675897","2":"6.491814e-03","3":"0.055675897"},{"1":"0.450308943","2":"3.088585e-01","3":"0.450308943"},{"1":"0.086433736","2":"4.658112e-03","3":"0.086433736"},{"1":"0.276750749","2":"2.935128e-02","3":"0.276750749"},{"1":"0.004982166","2":"9.256953e-05","3":"0.004982166"},{"1":"0.412197344","2":"3.657963e-01","3":"0.412197344"},{"1":"0.108087246","2":"5.710624e-03","3":"0.108087246"},{"1":"0.008100591","2":"1.974970e-04","3":"0.008100591"},{"1":"0.005781682","2":"3.084704e-04","3":"0.005781682"},{"1":"0.004863223","2":"7.327511e-05","3":"0.004863223"},{"1":"0.476933528","2":"3.719692e-01","3":"0.476933528"},{"1":"0.439309635","2":"1.002092e-01","3":"0.439309635"},{"1":"0.170288130","2":"9.414687e-02","3":"0.170288130"},{"1":"0.984600497","2":"9.991752e-01","3":"0.984600497"},{"1":"0.544006982","2":"7.792931e-01","3":"0.544006982"},{"1":"0.249908890","2":"1.555626e-01","3":"0.249908890"},{"1":"0.999961322","2":"1.000000e+00","3":"0.999961322"},{"1":"0.988547362","2":"9.996781e-01","3":"0.988547362"},{"1":"0.606575463","2":"4.303136e-01","3":"0.606575463"},{"1":"0.930825037","2":"9.834618e-01","3":"0.930825037"},{"1":"0.015934974","2":"2.184181e-03","3":"0.015934974"},{"1":"0.994291963","2":"9.998755e-01","3":"0.994291963"},{"1":"0.082565252","2":"2.107804e-01","3":"0.082565252"},{"1":"0.481460146","2":"8.650368e-01","3":"0.481460146"},{"1":"0.998647242","2":"9.999999e-01","3":"0.998647242"},{"1":"0.835981180","2":"8.087243e-01","3":"0.835981180"},{"1":"0.610168099","2":"5.839727e-01","3":"0.610168099"},{"1":"0.795116725","2":"7.952371e-01","3":"0.795116725"},{"1":"0.986350670","2":"9.981052e-01","3":"0.986350670"},{"1":"0.445174594","2":"5.521448e-01","3":"0.445174594"},{"1":"0.615091047","2":"6.013826e-01","3":"0.615091047"},{"1":"0.343516230","2":"1.912215e-01","3":"0.343516230"},{"1":"0.999892524","2":"9.999998e-01","3":"0.999892524"},{"1":"0.921984549","2":"9.741943e-01","3":"0.921984549"},{"1":"0.838078839","2":"9.177694e-01","3":"0.838078839"},{"1":"0.939349968","2":"9.961652e-01","3":"0.939349968"},{"1":"0.985046474","2":"9.979526e-01","3":"0.985046474"},{"1":"0.742075096","2":"8.088200e-01","3":"0.742075096"},{"1":"0.981783544","2":"9.973828e-01","3":"0.981783544"},{"1":"0.930286185","2":"9.736065e-01","3":"0.930286185"},{"1":"0.872837718","2":"9.630970e-01","3":"0.872837718"},{"1":"0.694768503","2":"8.227699e-01","3":"0.694768503"},{"1":"0.567679997","2":"6.527810e-01","3":"0.567679997"},{"1":"0.971903448","2":"9.841599e-01","3":"0.971903448"},{"1":"0.889373693","2":"9.234294e-01","3":"0.889373693"},{"1":"0.999631212","2":"9.999965e-01","3":"0.999631212"},{"1":"0.999601380","2":"1.000000e+00","3":"0.999601380"},{"1":"0.976572294","2":"9.983121e-01","3":"0.976572294"},{"1":"0.927447232","2":"9.667540e-01","3":"0.927447232"},{"1":"0.729328039","2":"9.513290e-01","3":"0.729328039"},{"1":"0.931365577","2":"9.805097e-01","3":"0.931365577"},{"1":"0.053169235","2":"2.529214e-02","3":"0.053169235"},{"1":"0.019156590","2":"1.394010e-02","3":"0.019156590"},{"1":"0.008643909","2":"5.358336e-04","3":"0.008643909"},{"1":"0.202800935","2":"2.145127e-01","3":"0.202800935"},{"1":"0.235817525","2":"1.800819e-01","3":"0.235817525"},{"1":"0.003119831","2":"1.041066e-04","3":"0.003119831"},{"1":"0.038664051","2":"8.174218e-03","3":"0.038664051"},{"1":"0.426659669","2":"5.840089e-01","3":"0.426659669"},{"1":"0.202260574","2":"1.113924e-01","3":"0.202260574"},{"1":"0.851870288","2":"9.569753e-01","3":"0.851870288"},{"1":"0.777407281","2":"4.750101e-01","3":"0.777407281"},{"1":"0.042591692","2":"2.372111e-02","3":"0.042591692"},{"1":"0.012865915","2":"1.360689e-03","3":"0.012865915"},{"1":"0.043990371","2":"4.261442e-03","3":"0.043990371"},{"1":"0.008040256","2":"1.427465e-03","3":"0.008040256"},{"1":"0.004313139","2":"1.898022e-04","3":"0.004313139"},{"1":"0.013779939","2":"3.259950e-03","3":"0.013779939"},{"1":"0.100856147","2":"5.223538e-02","3":"0.100856147"},{"1":"0.038745507","2":"8.844466e-03","3":"0.038745507"},{"1":"0.059290772","2":"5.041245e-02","3":"0.059290772"},{"1":"0.067559957","2":"1.679691e-02","3":"0.067559957"},{"1":"0.087501247","2":"1.516109e-02","3":"0.087501247"},{"1":"0.003886422","2":"2.783187e-04","3":"0.003886422"},{"1":"0.185802169","2":"1.746864e-01","3":"0.185802169"},{"1":"0.085016072","2":"4.170875e-02","3":"0.085016072"},{"1":"0.284029129","2":"1.565925e-01","3":"0.284029129"},{"1":"0.247904625","2":"2.408117e-01","3":"0.247904625"},{"1":"0.058073187","2":"1.655535e-02","3":"0.058073187"},{"1":"0.120990936","2":"4.688627e-02","3":"0.120990936"},{"1":"0.699219616","2":"7.121585e-01","3":"0.699219616"},{"1":"0.193364235","2":"1.445838e-01","3":"0.193364235"},{"1":"0.094739222","2":"2.947978e-02","3":"0.094739222"},{"1":"0.009270289","2":"1.173052e-03","3":"0.009270289"},{"1":"0.016026393","2":"3.284348e-03","3":"0.016026393"},{"1":"0.063827316","2":"2.253927e-02","3":"0.063827316"},{"1":"0.048466253","2":"2.520942e-02","3":"0.048466253"},{"1":"0.053384283","2":"3.089887e-02","3":"0.053384283"},{"1":"0.039176720","2":"1.560189e-02","3":"0.039176720"},{"1":"0.268801956","2":"1.438822e-01","3":"0.268801956"},{"1":"0.386930171","2":"1.843593e-01","3":"0.386930171"},{"1":"0.650042557","2":"6.652158e-01","3":"0.650042557"},{"1":"0.170222106","2":"1.885984e-01","3":"0.170222106"},{"1":"0.903486539","2":"9.524074e-01","3":"0.903486539"},{"1":"0.013623701","2":"2.658297e-03","3":"0.013623701"},{"1":"0.663143989","2":"6.177469e-01","3":"0.663143989"},{"1":"0.009170851","2":"5.752739e-04","3":"0.009170851"},{"1":"0.075715875","2":"3.753166e-03","3":"0.075715875"},{"1":"0.003270359","2":"5.493790e-05","3":"0.003270359"},{"1":"0.074363672","2":"1.875125e-02","3":"0.074363672"},{"1":"0.079408617","2":"5.549550e-03","3":"0.079408617"},{"1":"0.004128938","2":"2.004240e-04","3":"0.004128938"},{"1":"0.006844816","2":"3.748869e-04","3":"0.006844816"},{"1":"0.002963558","2":"4.476262e-05","3":"0.002963558"},{"1":"0.678393189","2":"8.216664e-01","3":"0.678393189"},{"1":"0.410100771","2":"1.157274e-01","3":"0.410100771"},{"1":"0.265627059","2":"2.434851e-01","3":"0.265627059"},{"1":"0.934883811","2":"9.920813e-01","3":"0.934883811"},{"1":"0.274500545","2":"2.230535e-01","3":"0.274500545"},{"1":"0.999999950","2":"1.000000e+00","3":"0.999999950"},{"1":"0.985616049","2":"9.997147e-01","3":"0.985616049"},{"1":"0.701122099","2":"7.811142e-01","3":"0.701122099"},{"1":"0.036059816","2":"1.263601e-02","3":"0.036059816"},{"1":"0.999785305","2":"9.999999e-01","3":"0.999785305"},{"1":"0.142474286","2":"8.191316e-01","3":"0.142474286"},{"1":"0.111563693","2":"1.395584e-01","3":"0.111563693"},{"1":"0.943492982","2":"9.897243e-01","3":"0.943492982"},{"1":"0.712026421","2":"7.983258e-01","3":"0.712026421"},{"1":"0.775259159","2":"8.834287e-01","3":"0.775259159"},{"1":"0.484146071","2":"5.284762e-01","3":"0.484146071"},{"1":"0.994081461","2":"9.997270e-01","3":"0.994081461"},{"1":"0.653908182","2":"8.048018e-01","3":"0.653908182"},{"1":"0.587413754","2":"6.847418e-01","3":"0.587413754"},{"1":"0.631542350","2":"7.221509e-01","3":"0.631542350"},{"1":"0.999872348","2":"9.999998e-01","3":"0.999872348"},{"1":"0.930479083","2":"9.866741e-01","3":"0.930479083"},{"1":"0.821090395","2":"9.557413e-01","3":"0.821090395"},{"1":"0.715038954","2":"6.354991e-01","3":"0.715038954"},{"1":"0.833187915","2":"9.118389e-01","3":"0.833187915"},{"1":"0.467150420","2":"5.148600e-01","3":"0.467150420"},{"1":"0.989046176","2":"9.992183e-01","3":"0.989046176"},{"1":"0.723599154","2":"8.394887e-01","3":"0.723599154"},{"1":"0.997606647","2":"9.999986e-01","3":"0.997606647"},{"1":"0.712221020","2":"9.042161e-01","3":"0.712221020"},{"1":"0.690865927","2":"9.283444e-01","3":"0.690865927"},{"1":"0.982751677","2":"9.946292e-01","3":"0.982751677"},{"1":"0.728723489","2":"8.300993e-01","3":"0.728723489"},{"1":"0.998202700","2":"9.999988e-01","3":"0.998202700"},{"1":"0.988412293","2":"9.994224e-01","3":"0.988412293"},{"1":"0.991722531","2":"9.946026e-01","3":"0.991722531"},{"1":"0.842413908","2":"9.146413e-01","3":"0.842413908"},{"1":"0.416161178","2":"3.844607e-01","3":"0.416161178"},{"1":"0.998280923","2":"9.999991e-01","3":"0.998280923"},{"1":"0.288529768","2":"3.036456e-01","3":"0.288529768"},{"1":"0.491904260","2":"4.758152e-01","3":"0.491904260"},{"1":"0.050125420","2":"1.725394e-01","3":"0.050125420"},{"1":"0.255175134","2":"6.976065e-02","3":"0.255175134"},{"1":"0.153943795","2":"6.534746e-02","3":"0.153943795"},{"1":"0.037361135","2":"1.132185e-02","3":"0.037361135"},{"1":"0.078004101","2":"5.335526e-02","3":"0.078004101"},{"1":"0.041281893","2":"3.495044e-02","3":"0.041281893"},{"1":"0.041320707","2":"1.484524e-02","3":"0.041320707"},{"1":"0.046022645","2":"1.184845e-02","3":"0.046022645"},{"1":"0.018733667","2":"7.973372e-04","3":"0.018733667"},{"1":"0.012409106","2":"1.251986e-03","3":"0.012409106"},{"1":"0.069887222","2":"1.298077e-02","3":"0.069887222"},{"1":"0.116079708","2":"3.769983e-02","3":"0.116079708"},{"1":"0.024650025","2":"3.420632e-03","3":"0.024650025"},{"1":"0.085536509","2":"1.987145e-02","3":"0.085536509"},{"1":"0.427712384","2":"5.841562e-01","3":"0.427712384"},{"1":"0.011407900","2":"1.924190e-03","3":"0.011407900"},{"1":"0.022592467","2":"2.326906e-03","3":"0.022592467"},{"1":"0.040361832","2":"1.937459e-02","3":"0.040361832"},{"1":"0.064131030","2":"1.315417e-02","3":"0.064131030"},{"1":"0.032536861","2":"1.261695e-03","3":"0.032536861"},{"1":"0.012841888","2":"3.756635e-04","3":"0.012841888"},{"1":"0.151558242","2":"7.152285e-02","3":"0.151558242"},{"1":"0.147684666","2":"5.099245e-02","3":"0.147684666"},{"1":"0.010291427","2":"5.316367e-04","3":"0.010291427"},{"1":"0.041460998","2":"2.505151e-02","3":"0.041460998"},{"1":"0.020344053","2":"1.897891e-03","3":"0.020344053"},{"1":"0.179215608","2":"7.895278e-02","3":"0.179215608"},{"1":"0.005396364","2":"2.731211e-04","3":"0.005396364"},{"1":"0.013175070","2":"1.514885e-03","3":"0.013175070"},{"1":"0.054181772","2":"3.482547e-02","3":"0.054181772"},{"1":"0.433798947","2":"2.660439e-01","3":"0.433798947"},{"1":"0.061316398","2":"1.283597e-02","3":"0.061316398"},{"1":"0.011045226","2":"6.141674e-04","3":"0.011045226"},{"1":"0.110099486","2":"4.503861e-02","3":"0.110099486"},{"1":"0.139308262","2":"8.958108e-02","3":"0.139308262"},{"1":"0.038682323","2":"1.288054e-02","3":"0.038682323"},{"1":"0.025273229","2":"1.957784e-03","3":"0.025273229"},{"1":"0.688968412","2":"8.131783e-01","3":"0.688968412"},{"1":"0.631720376","2":"6.616985e-01","3":"0.631720376"},{"1":"0.078863829","2":"1.749277e-02","3":"0.078863829"},{"1":"0.087381474","2":"4.653413e-02","3":"0.087381474"},{"1":"0.369617342","2":"5.593191e-02","3":"0.369617342"},{"1":"0.094210052","2":"8.018907e-02","3":"0.094210052"},{"1":"0.022350663","2":"3.248133e-03","3":"0.022350663"},{"1":"0.083919252","2":"9.754749e-02","3":"0.083919252"},{"1":"0.061500644","2":"2.731140e-02","3":"0.061500644"},{"1":"0.221949820","2":"1.091851e-01","3":"0.221949820"},{"1":"0.008491669","2":"1.230561e-03","3":"0.008491669"},{"1":"0.048360052","2":"2.766290e-03","3":"0.048360052"},{"1":"0.181838643","2":"4.558502e-02","3":"0.181838643"},{"1":"0.244584074","2":"8.691780e-02","3":"0.244584074"},{"1":"0.024342722","2":"1.655765e-03","3":"0.024342722"},{"1":"0.182880197","2":"3.544480e-02","3":"0.182880197"},{"1":"0.061705811","2":"2.831221e-02","3":"0.061705811"},{"1":"0.998631375","2":"9.999230e-01","3":"0.998631375"},{"1":"0.987066284","2":"9.981346e-01","3":"0.987066284"},{"1":"0.996128872","2":"9.992321e-01","3":"0.996128872"},{"1":"0.999145996","2":"9.998185e-01","3":"0.999145996"},{"1":"0.972108608","2":"9.709037e-01","3":"0.972108608"},{"1":"0.997342301","2":"9.995179e-01","3":"0.997342301"},{"1":"0.957506404","2":"9.904154e-01","3":"0.957506404"},{"1":"0.973425002","2":"9.941799e-01","3":"0.973425002"},{"1":"0.989917605","2":"9.996911e-01","3":"0.989917605"},{"1":"0.462388691","2":"7.298289e-01","3":"0.462388691"},{"1":"0.834618050","2":"9.512418e-01","3":"0.834618050"},{"1":"0.985131675","2":"9.936195e-01","3":"0.985131675"},{"1":"0.884017676","2":"9.346883e-01","3":"0.884017676"},{"1":"0.999735885","2":"9.999947e-01","3":"0.999735885"},{"1":"0.418882466","2":"2.519638e-01","3":"0.418882466"},{"1":"0.999678085","2":"9.983588e-01","3":"0.999678085"},{"1":"0.983056634","2":"9.953327e-01","3":"0.983056634"},{"1":"0.929777770","2":"9.255621e-01","3":"0.929777770"},{"1":"0.989315214","2":"9.995946e-01","3":"0.989315214"},{"1":"0.998550010","2":"9.998625e-01","3":"0.998550010"},{"1":"0.885810257","2":"9.592231e-01","3":"0.885810257"},{"1":"0.902205638","2":"9.585383e-01","3":"0.902205638"},{"1":"0.157083315","2":"2.054907e-01","3":"0.157083315"},{"1":"0.997840699","2":"9.996600e-01","3":"0.997840699"},{"1":"0.991805515","2":"9.995135e-01","3":"0.991805515"},{"1":"0.984226025","2":"9.940132e-01","3":"0.984226025"},{"1":"0.999882737","2":"9.999914e-01","3":"0.999882737"},{"1":"0.983698729","2":"9.934718e-01","3":"0.983698729"},{"1":"0.993610066","2":"9.981851e-01","3":"0.993610066"},{"1":"0.986652334","2":"9.923583e-01","3":"0.986652334"},{"1":"0.949741092","2":"9.614936e-01","3":"0.949741092"},{"1":"0.999996889","2":"9.999999e-01","3":"0.999996889"},{"1":"0.996241518","2":"9.991984e-01","3":"0.996241518"},{"1":"0.999682208","2":"9.999836e-01","3":"0.999682208"},{"1":"0.999886938","2":"9.999987e-01","3":"0.999886938"},{"1":"0.962295783","2":"9.799125e-01","3":"0.962295783"},{"1":"0.698252981","2":"7.674810e-01","3":"0.698252981"},{"1":"0.893056764","2":"9.675188e-01","3":"0.893056764"},{"1":"0.994505415","2":"9.929117e-01","3":"0.994505415"},{"1":"0.996826406","2":"9.988346e-01","3":"0.996826406"},{"1":"0.996618894","2":"9.998944e-01","3":"0.996618894"},{"1":"0.998865172","2":"9.998406e-01","3":"0.998865172"},{"1":"0.348101955","2":"6.538201e-01","3":"0.348101955"},{"1":"0.671868673","2":"7.813378e-01","3":"0.671868673"},{"1":"0.972104917","2":"9.893025e-01","3":"0.972104917"},{"1":"0.929629131","2":"9.912316e-01","3":"0.929629131"},{"1":"0.594127655","2":"4.932209e-01","3":"0.594127655"},{"1":"0.998994966","2":"9.999866e-01","3":"0.998994966"},{"1":"0.979621612","2":"9.889067e-01","3":"0.979621612"},{"1":"0.774596492","2":"8.267548e-01","3":"0.774596492"},{"1":"0.991193181","2":"9.953362e-01","3":"0.991193181"},{"1":"0.999935045","2":"9.999999e-01","3":"0.999935045"},{"1":"0.997886792","2":"9.956699e-01","3":"0.997886792"},{"1":"0.931272702","2":"9.596685e-01","3":"0.931272702"},{"1":"0.487558666","2":"5.177945e-01","3":"0.487558666"},{"1":"0.970254107","2":"9.994083e-01","3":"0.970254107"},{"1":"0.559460987","2":"4.714586e-01","3":"0.559460987"},{"1":"0.024307366","2":"4.503210e-03","3":"0.024307366"},{"1":"0.278956787","2":"1.479589e-01","3":"0.278956787"},{"1":"0.111298130","2":"2.394941e-02","3":"0.111298130"},{"1":"0.030743582","2":"6.462629e-03","3":"0.030743582"},{"1":"0.068594575","2":"5.193441e-02","3":"0.068594575"},{"1":"0.059570977","2":"8.562750e-03","3":"0.059570977"},{"1":"0.057119837","2":"1.463801e-02","3":"0.057119837"},{"1":"0.053072798","2":"1.827426e-02","3":"0.053072798"},{"1":"0.025980021","2":"1.708289e-03","3":"0.025980021"},{"1":"0.080345088","2":"2.721679e-02","3":"0.080345088"},{"1":"0.063011065","2":"2.228982e-02","3":"0.063011065"},{"1":"0.119864990","2":"5.009363e-02","3":"0.119864990"},{"1":"0.030095495","2":"5.791118e-03","3":"0.030095495"},{"1":"0.134840944","2":"4.094460e-02","3":"0.134840944"},{"1":"0.684926658","2":"7.757378e-01","3":"0.684926658"},{"1":"0.016429085","2":"2.880254e-03","3":"0.016429085"},{"1":"0.029071112","2":"2.239660e-03","3":"0.029071112"},{"1":"0.089359565","2":"4.560431e-02","3":"0.089359565"},{"1":"0.172807766","2":"2.428755e-02","3":"0.172807766"},{"1":"0.058519208","2":"2.822199e-03","3":"0.058519208"},{"1":"0.070565019","2":"5.302243e-03","3":"0.070565019"},{"1":"0.037487626","2":"4.071146e-03","3":"0.037487626"},{"1":"0.320303571","2":"2.054755e-01","3":"0.320303571"},{"1":"0.005771080","2":"2.397362e-04","3":"0.005771080"},{"1":"0.013416474","2":"5.091375e-03","3":"0.013416474"},{"1":"0.026433234","2":"1.470628e-03","3":"0.026433234"},{"1":"0.138031458","2":"4.263969e-02","3":"0.138031458"},{"1":"0.009195812","2":"6.857232e-04","3":"0.009195812"},{"1":"0.012037306","2":"1.790083e-03","3":"0.012037306"},{"1":"0.077901991","2":"1.914312e-02","3":"0.077901991"},{"1":"0.369669681","2":"2.827755e-01","3":"0.369669681"},{"1":"0.180117190","2":"2.149583e-02","3":"0.180117190"},{"1":"0.002900153","2":"1.331942e-04","3":"0.002900153"},{"1":"0.051216286","2":"9.764929e-03","3":"0.051216286"},{"1":"0.216224154","2":"1.461587e-01","3":"0.216224154"},{"1":"0.027468003","2":"4.796986e-03","3":"0.027468003"},{"1":"0.065671881","2":"1.026796e-02","3":"0.065671881"},{"1":"0.152985817","2":"1.123927e-01","3":"0.152985817"},{"1":"0.402843378","2":"3.305368e-01","3":"0.402843378"},{"1":"0.063998411","2":"1.618037e-02","3":"0.063998411"},{"1":"0.097264821","2":"4.541429e-02","3":"0.097264821"},{"1":"0.275815298","2":"2.643897e-02","3":"0.275815298"},{"1":"0.202634400","2":"1.101119e-01","3":"0.202634400"},{"1":"0.008392649","2":"6.485237e-04","3":"0.008392649"},{"1":"0.035362266","2":"9.004322e-02","3":"0.035362266"},{"1":"0.033329403","2":"9.102317e-03","3":"0.033329403"},{"1":"0.153075637","2":"5.259301e-02","3":"0.153075637"},{"1":"0.026747160","2":"5.554073e-03","3":"0.026747160"},{"1":"0.035880752","2":"1.367802e-03","3":"0.035880752"},{"1":"0.098711738","2":"1.096340e-02","3":"0.098711738"},{"1":"0.096948597","2":"2.912164e-02","3":"0.096948597"},{"1":"0.025153646","2":"2.410441e-03","3":"0.025153646"},{"1":"0.230242966","2":"5.201269e-02","3":"0.230242966"},{"1":"0.038575152","2":"9.809794e-03","3":"0.038575152"},{"1":"0.998897920","2":"9.999762e-01","3":"0.998897920"},{"1":"0.984823959","2":"9.930878e-01","3":"0.984823959"},{"1":"0.997039770","2":"9.993392e-01","3":"0.997039770"},{"1":"0.993238521","2":"9.966656e-01","3":"0.993238521"},{"1":"0.989602707","2":"9.891929e-01","3":"0.989602707"},{"1":"0.993336131","2":"9.979515e-01","3":"0.993336131"},{"1":"0.988778603","2":"9.976646e-01","3":"0.988778603"},{"1":"0.997973175","2":"9.999403e-01","3":"0.997973175"},{"1":"0.996813334","2":"9.996354e-01","3":"0.996813334"},{"1":"0.305120635","2":"4.546698e-01","3":"0.305120635"},{"1":"0.781513645","2":"9.341198e-01","3":"0.781513645"},{"1":"0.992127183","2":"9.944062e-01","3":"0.992127183"},{"1":"0.891513041","2":"9.289068e-01","3":"0.891513041"},{"1":"0.950131869","2":"9.866264e-01","3":"0.950131869"},{"1":"0.906624528","2":"9.785393e-01","3":"0.906624528"},{"1":"0.999201544","2":"9.964966e-01","3":"0.999201544"},{"1":"0.931965485","2":"9.740717e-01","3":"0.931965485"},{"1":"0.971671595","2":"9.900362e-01","3":"0.971671595"},{"1":"0.980449747","2":"9.991255e-01","3":"0.980449747"},{"1":"0.998863751","2":"9.998490e-01","3":"0.998863751"},{"1":"0.970049673","2":"9.973801e-01","3":"0.970049673"},{"1":"0.998261648","2":"9.998639e-01","3":"0.998261648"},{"1":"0.200691325","2":"3.931424e-01","3":"0.200691325"},{"1":"0.999080441","2":"9.996868e-01","3":"0.999080441"},{"1":"0.999933581","2":"9.999854e-01","3":"0.999933581"},{"1":"0.994670547","2":"9.979614e-01","3":"0.994670547"},{"1":"0.999772218","2":"9.999887e-01","3":"0.999772218"},{"1":"0.992578156","2":"9.965278e-01","3":"0.992578156"},{"1":"0.997586761","2":"9.998390e-01","3":"0.997586761"},{"1":"0.987961325","2":"9.937102e-01","3":"0.987961325"},{"1":"0.960484944","2":"9.578462e-01","3":"0.960484944"},{"1":"0.999998697","2":"1.000000e+00","3":"0.999998697"},{"1":"0.999812421","2":"9.999989e-01","3":"0.999812421"},{"1":"0.999830326","2":"9.999890e-01","3":"0.999830326"},{"1":"0.997976423","2":"9.996269e-01","3":"0.997976423"},{"1":"0.956076828","2":"9.674646e-01","3":"0.956076828"},{"1":"0.724118663","2":"7.500581e-01","3":"0.724118663"},{"1":"0.990995416","2":"9.997337e-01","3":"0.990995416"},{"1":"0.875687549","2":"8.722332e-01","3":"0.875687549"},{"1":"0.994159069","2":"9.986822e-01","3":"0.994159069"},{"1":"0.986712443","2":"9.967641e-01","3":"0.986712443"},{"1":"0.997882420","2":"8.471222e-01","3":"0.997882420"},{"1":"0.587042775","2":"9.066659e-01","3":"0.587042775"},{"1":"0.980230761","2":"9.941179e-01","3":"0.980230761"},{"1":"0.999850938","2":"9.999053e-01","3":"0.999850938"},{"1":"0.990685120","2":"9.992244e-01","3":"0.990685120"},{"1":"0.874594883","2":"8.697567e-01","3":"0.874594883"},{"1":"0.999989374","2":"1.000000e+00","3":"0.999989374"},{"1":"0.998312822","2":"9.965749e-01","3":"0.998312822"},{"1":"0.934227931","2":"9.714905e-01","3":"0.934227931"},{"1":"0.999962932","2":"9.999913e-01","3":"0.999962932"},{"1":"0.999348913","2":"9.999809e-01","3":"0.999348913"},{"1":"0.999108392","2":"9.981795e-01","3":"0.999108392"},{"1":"0.713516991","2":"7.059912e-01","3":"0.713516991"},{"1":"0.695939333","2":"5.757786e-01","3":"0.695939333"},{"1":"0.986693374","2":"7.605917e-01","3":"0.986693374"},{"1":"0.506893814","2":"3.814055e-01","3":"0.506893814"},{"1":"0.025877588","2":"3.332486e-03","3":"0.025877588"},{"1":"0.115293595","2":"2.464722e-02","3":"0.115293595"},{"1":"0.066383011","2":"1.133051e-02","3":"0.066383011"},{"1":"0.026167590","2":"2.778441e-03","3":"0.026167590"},{"1":"0.031479053","2":"4.568477e-03","3":"0.031479053"},{"1":"0.027735364","2":"3.190530e-03","3":"0.027735364"},{"1":"0.043943493","2":"8.614148e-03","3":"0.043943493"},{"1":"0.310155873","2":"3.739266e-01","3":"0.310155873"},{"1":"0.013759872","2":"4.859325e-04","3":"0.013759872"},{"1":"0.043359031","2":"8.346459e-03","3":"0.043359031"},{"1":"0.036264637","2":"5.486070e-03","3":"0.036264637"},{"1":"0.145640668","2":"4.213105e-02","3":"0.145640668"},{"1":"0.024460746","2":"3.356794e-03","3":"0.024460746"},{"1":"0.062986168","2":"7.877648e-03","3":"0.062986168"},{"1":"0.596872776","2":"6.853686e-01","3":"0.596872776"},{"1":"0.012279247","2":"1.827002e-03","3":"0.012279247"},{"1":"0.027266501","2":"1.515252e-03","3":"0.027266501"},{"1":"0.074530006","2":"2.676949e-02","3":"0.074530006"},{"1":"0.025610841","2":"2.478224e-03","3":"0.025610841"},{"1":"0.064414686","2":"3.769526e-03","3":"0.064414686"},{"1":"0.003586532","2":"5.555559e-05","3":"0.003586532"},{"1":"0.048589258","2":"1.146815e-02","3":"0.048589258"},{"1":"0.139470903","2":"3.026405e-02","3":"0.139470903"},{"1":"0.010573303","2":"1.065173e-03","3":"0.010573303"},{"1":"0.007824845","2":"1.529735e-03","3":"0.007824845"},{"1":"0.009754653","2":"5.748453e-04","3":"0.009754653"},{"1":"0.055340907","2":"9.323895e-03","3":"0.055340907"},{"1":"0.013381949","2":"9.326819e-04","3":"0.013381949"},{"1":"0.008416861","2":"1.080321e-03","3":"0.008416861"},{"1":"0.056634595","2":"1.444654e-02","3":"0.056634595"},{"1":"0.405479205","2":"3.465234e-01","3":"0.405479205"},{"1":"0.092314952","2":"3.423341e-03","3":"0.092314952"},{"1":"0.003302992","2":"8.698724e-05","3":"0.003302992"},{"1":"0.027838463","2":"2.846003e-03","3":"0.027838463"},{"1":"0.060201040","2":"2.127572e-02","3":"0.060201040"},{"1":"0.010759907","2":"8.316858e-04","3":"0.010759907"},{"1":"0.032183428","2":"2.492299e-03","3":"0.032183428"},{"1":"0.105334178","2":"5.634072e-02","3":"0.105334178"},{"1":"0.610579085","2":"5.093128e-01","3":"0.610579085"},{"1":"0.023278639","2":"2.701903e-03","3":"0.023278639"},{"1":"0.099234799","2":"2.791893e-02","3":"0.099234799"},{"1":"0.317735448","2":"2.857599e-02","3":"0.317735448"},{"1":"0.061456082","2":"1.694626e-02","3":"0.061456082"},{"1":"0.007977096","2":"2.920907e-04","3":"0.007977096"},{"1":"0.386625936","2":"5.585229e-01","3":"0.386625936"},{"1":"0.032940180","2":"6.662684e-03","3":"0.032940180"},{"1":"0.169638597","2":"5.179691e-02","3":"0.169638597"},{"1":"0.017145162","2":"2.242579e-03","3":"0.017145162"},{"1":"0.007154152","2":"9.098263e-05","3":"0.007154152"},{"1":"0.061335357","2":"5.917516e-03","3":"0.061335357"},{"1":"0.053948721","2":"7.568538e-03","3":"0.053948721"},{"1":"0.015414573","2":"6.814983e-04","3":"0.015414573"},{"1":"0.071138533","2":"8.230000e-03","3":"0.071138533"},{"1":"0.019138664","2":"2.169446e-03","3":"0.019138664"},{"1":"0.997252909","2":"9.996406e-01","3":"0.997252909"},{"1":"0.949615725","2":"9.925768e-01","3":"0.949615725"},{"1":"0.988449149","2":"9.930548e-01","3":"0.988449149"},{"1":"0.990868234","2":"9.955600e-01","3":"0.990868234"},{"1":"0.968053128","2":"8.959122e-01","3":"0.968053128"},{"1":"0.996824093","2":"9.990872e-01","3":"0.996824093"},{"1":"0.968298762","2":"9.834506e-01","3":"0.968298762"},{"1":"0.979662655","2":"9.898748e-01","3":"0.979662655"},{"1":"0.999361634","2":"9.998720e-01","3":"0.999361634"},{"1":"0.117746416","2":"9.913452e-02","3":"0.117746416"},{"1":"0.988409088","2":"9.988969e-01","3":"0.988409088"},{"1":"0.989991264","2":"9.969898e-01","3":"0.989991264"},{"1":"0.758480065","2":"7.037089e-01","3":"0.758480065"},{"1":"0.966188756","2":"9.722909e-01","3":"0.966188756"},{"1":"0.997072211","2":"9.985725e-01","3":"0.997072211"},{"1":"0.999923836","2":"9.999982e-01","3":"0.999923836"},{"1":"0.944744260","2":"9.663077e-01","3":"0.944744260"},{"1":"0.952741006","2":"9.743120e-01","3":"0.952741006"},{"1":"0.942154196","2":"9.946888e-01","3":"0.942154196"},{"1":"0.999917863","2":"9.999994e-01","3":"0.999917863"},{"1":"0.924998615","2":"9.504411e-01","3":"0.924998615"},{"1":"0.955025734","2":"9.897428e-01","3":"0.955025734"},{"1":"0.296990421","2":"4.276154e-01","3":"0.296990421"},{"1":"0.999877582","2":"9.999716e-01","3":"0.999877582"},{"1":"0.999899066","2":"9.999448e-01","3":"0.999899066"},{"1":"0.985954203","2":"9.912502e-01","3":"0.985954203"},{"1":"0.996284452","2":"9.992851e-01","3":"0.996284452"},{"1":"0.980180569","2":"9.831024e-01","3":"0.980180569"},{"1":"0.999892164","2":"9.999478e-01","3":"0.999892164"},{"1":"0.996892901","2":"9.974904e-01","3":"0.996892901"},{"1":"0.945293782","2":"9.340923e-01","3":"0.945293782"},{"1":"0.999998695","2":"1.000000e+00","3":"0.999998695"},{"1":"0.998612005","2":"9.998519e-01","3":"0.998612005"},{"1":"0.999997784","2":"9.999984e-01","3":"0.999997784"},{"1":"0.993463117","2":"9.981729e-01","3":"0.993463117"},{"1":"0.988369889","2":"9.889025e-01","3":"0.988369889"},{"1":"0.961311017","2":"9.880683e-01","3":"0.961311017"},{"1":"0.946819719","2":"9.579816e-01","3":"0.946819719"},{"1":"0.940497041","2":"9.439913e-01","3":"0.940497041"},{"1":"0.988184358","2":"9.964790e-01","3":"0.988184358"},{"1":"0.979358134","2":"9.955514e-01","3":"0.979358134"},{"1":"0.974902146","2":"9.405810e-01","3":"0.974902146"},{"1":"0.950908077","2":"9.604302e-01","3":"0.950908077"},{"1":"0.982822306","2":"9.892696e-01","3":"0.982822306"},{"1":"0.996821463","2":"9.889804e-01","3":"0.996821463"},{"1":"0.825794584","2":"8.706888e-01","3":"0.825794584"},{"1":"0.851571377","2":"7.755303e-01","3":"0.851571377"},{"1":"0.999982678","2":"9.999997e-01","3":"0.999982678"},{"1":"0.998190830","2":"9.969343e-01","3":"0.998190830"},{"1":"0.971864457","2":"9.867216e-01","3":"0.971864457"},{"1":"0.999655175","2":"9.999707e-01","3":"0.999655175"},{"1":"0.998492559","2":"9.999217e-01","3":"0.998492559"},{"1":"0.999219274","2":"9.984561e-01","3":"0.999219274"},{"1":"0.588301390","2":"4.538594e-01","3":"0.588301390"},{"1":"0.976717126","2":"9.925391e-01","3":"0.976717126"},{"1":"0.999901812","2":"9.996509e-01","3":"0.999901812"},{"1":"0.016530876","2":"1.784883e-02","3":"0.016530876"},{"1":"0.140721905","2":"8.951247e-02","3":"0.140721905"},{"1":"0.085726347","2":"1.518836e-02","3":"0.085726347"},{"1":"0.089751447","2":"5.363130e-02","3":"0.089751447"},{"1":"0.011762981","2":"1.375174e-03","3":"0.011762981"},{"1":"0.071033512","2":"2.308984e-02","3":"0.071033512"},{"1":"0.348110006","2":"1.273561e-01","3":"0.348110006"},{"1":"0.024274749","2":"8.819521e-03","3":"0.024274749"},{"1":"0.224344585","2":"2.762299e-01","3":"0.224344585"},{"1":"0.173115395","2":"3.123632e-02","3":"0.173115395"},{"1":"0.277635382","2":"4.874311e-01","3":"0.277635382"},{"1":"0.230457423","2":"3.689658e-01","3":"0.230457423"},{"1":"0.042586868","2":"1.504903e-02","3":"0.042586868"},{"1":"0.016468251","2":"3.996084e-03","3":"0.016468251"},{"1":"0.019854708","2":"1.034444e-02","3":"0.019854708"},{"1":"0.080199109","2":"2.424417e-02","3":"0.080199109"},{"1":"0.125870148","2":"5.701207e-02","3":"0.125870148"},{"1":"0.143809741","2":"7.881086e-02","3":"0.143809741"},{"1":"0.029621067","2":"1.889964e-02","3":"0.029621067"},{"1":"0.098180609","2":"3.816243e-02","3":"0.098180609"},{"1":"0.035182356","2":"9.342401e-03","3":"0.035182356"},{"1":"0.120827186","2":"4.074609e-02","3":"0.120827186"},{"1":"0.091811695","2":"3.936573e-02","3":"0.091811695"},{"1":"0.026457367","2":"3.809690e-02","3":"0.026457367"},{"1":"0.005230192","2":"8.064283e-04","3":"0.005230192"},{"1":"0.116539297","2":"1.400335e-01","3":"0.116539297"},{"1":"0.031055839","2":"1.881909e-02","3":"0.031055839"},{"1":"0.063557232","2":"9.179514e-03","3":"0.063557232"},{"1":"0.087806939","2":"7.757097e-02","3":"0.087806939"},{"1":"0.267130468","2":"2.835924e-01","3":"0.267130468"},{"1":"0.046779985","2":"1.075759e-02","3":"0.046779985"},{"1":"0.039211479","2":"4.683462e-02","3":"0.039211479"},{"1":"0.229873598","2":"1.414042e-01","3":"0.229873598"},{"1":"0.020951583","2":"2.019843e-03","3":"0.020951583"},{"1":"0.067171848","2":"3.446061e-02","3":"0.067171848"},{"1":"0.050356185","2":"1.012930e-01","3":"0.050356185"},{"1":"0.046371502","2":"2.554782e-02","3":"0.046371502"},{"1":"0.042473456","2":"1.310703e-02","3":"0.042473456"},{"1":"0.016809396","2":"9.632553e-03","3":"0.016809396"},{"1":"0.107922400","2":"8.813645e-02","3":"0.107922400"},{"1":"0.094301255","2":"3.619714e-02","3":"0.094301255"},{"1":"0.275306564","2":"1.521741e-01","3":"0.275306564"},{"1":"0.133223850","2":"1.277935e-01","3":"0.133223850"},{"1":"0.094935190","2":"1.335316e-01","3":"0.094935190"},{"1":"0.071327176","2":"2.047978e-01","3":"0.071327176"},{"1":"0.013685147","2":"3.140401e-03","3":"0.013685147"},{"1":"0.064314442","2":"9.525454e-02","3":"0.064314442"},{"1":"0.031714389","2":"1.271045e-01","3":"0.031714389"},{"1":"0.047568810","2":"3.414201e-03","3":"0.047568810"},{"1":"0.957979744","2":"9.943378e-01","3":"0.957979744"},{"1":"0.993769212","2":"9.998212e-01","3":"0.993769212"},{"1":"0.928079979","2":"9.825695e-01","3":"0.928079979"},{"1":"0.970832509","2":"9.916713e-01","3":"0.970832509"},{"1":"0.623689415","2":"8.663807e-01","3":"0.623689415"},{"1":"0.999153871","2":"9.999592e-01","3":"0.999153871"},{"1":"0.988381712","2":"9.974764e-01","3":"0.988381712"},{"1":"0.974308109","2":"9.981576e-01","3":"0.974308109"},{"1":"0.999389562","2":"9.999835e-01","3":"0.999389562"},{"1":"0.999435110","2":"9.999788e-01","3":"0.999435110"},{"1":"0.826848311","2":"9.485848e-01","3":"0.826848311"},{"1":"0.996842209","2":"9.999018e-01","3":"0.996842209"},{"1":"0.995622070","2":"9.999469e-01","3":"0.995622070"},{"1":"0.864053613","2":"9.644042e-01","3":"0.864053613"},{"1":"0.971617343","2":"9.981124e-01","3":"0.971617343"},{"1":"0.138731508","2":"4.963429e-02","3":"0.138731508"},{"1":"0.579477563","2":"8.195499e-01","3":"0.579477563"},{"1":"0.994574278","2":"9.996395e-01","3":"0.994574278"},{"1":"0.612367728","2":"8.449055e-01","3":"0.612367728"},{"1":"0.974149902","2":"9.947293e-01","3":"0.974149902"},{"1":"0.998586314","2":"9.999831e-01","3":"0.998586314"},{"1":"0.997987208","2":"9.999670e-01","3":"0.997987208"},{"1":"0.997116479","2":"9.999636e-01","3":"0.997116479"},{"1":"0.418756226","2":"7.747981e-01","3":"0.418756226"},{"1":"0.774533447","2":"8.081170e-01","3":"0.774533447"},{"1":"0.971485991","2":"9.922288e-01","3":"0.971485991"},{"1":"0.642269925","2":"7.410775e-01","3":"0.642269925"},{"1":"0.943869290","2":"9.913190e-01","3":"0.943869290"},{"1":"0.988950033","2":"9.992894e-01","3":"0.988950033"},{"1":"0.975112242","2":"9.994557e-01","3":"0.975112242"},{"1":"0.618197554","2":"6.215254e-01","3":"0.618197554"},{"1":"0.933149966","2":"9.857974e-01","3":"0.933149966"},{"1":"0.888087183","2":"9.645329e-01","3":"0.888087183"},{"1":"0.719262991","2":"8.708389e-01","3":"0.719262991"},{"1":"0.382453723","2":"2.314917e-01","3":"0.382453723"},{"1":"0.982807387","2":"9.990361e-01","3":"0.982807387"},{"1":"0.830178886","2":"9.547767e-01","3":"0.830178886"},{"1":"0.963389172","2":"9.939979e-01","3":"0.963389172"},{"1":"0.169963875","2":"1.993374e-01","3":"0.169963875"},{"1":"0.593007435","2":"8.186653e-01","3":"0.593007435"},{"1":"0.996576096","2":"9.996791e-01","3":"0.996576096"},{"1":"0.999257614","2":"9.999917e-01","3":"0.999257614"},{"1":"0.971784970","2":"9.964279e-01","3":"0.971784970"},{"1":"0.999779628","2":"9.999977e-01","3":"0.999779628"},{"1":"0.916746153","2":"9.663711e-01","3":"0.916746153"},{"1":"0.996664284","2":"9.997209e-01","3":"0.996664284"},{"1":"0.900536148","2":"9.672104e-01","3":"0.900536148"},{"1":"0.999521711","2":"9.999546e-01","3":"0.999521711"},{"1":"0.539860315","2":"6.942106e-01","3":"0.539860315"},{"1":"0.937636953","2":"9.953907e-01","3":"0.937636953"},{"1":"0.016106451","2":"7.771752e-03","3":"0.016106451"},{"1":"0.049881233","2":"1.038493e-02","3":"0.049881233"},{"1":"0.196077254","2":"1.147594e-01","3":"0.196077254"},{"1":"0.045557613","2":"1.095989e-02","3":"0.045557613"},{"1":"0.015174703","2":"2.395948e-03","3":"0.015174703"},{"1":"0.033305120","2":"5.298298e-03","3":"0.033305120"},{"1":"0.852473030","2":"8.427370e-01","3":"0.852473030"},{"1":"0.014269001","2":"3.382221e-03","3":"0.014269001"},{"1":"0.188313799","2":"2.164185e-01","3":"0.188313799"},{"1":"0.214576232","2":"5.809331e-02","3":"0.214576232"},{"1":"0.050327076","2":"4.535074e-02","3":"0.050327076"},{"1":"0.154408777","2":"2.324171e-01","3":"0.154408777"},{"1":"0.035997752","2":"3.168332e-03","3":"0.035997752"},{"1":"0.015035123","2":"6.362563e-03","3":"0.015035123"},{"1":"0.013377222","2":"4.133522e-03","3":"0.013377222"},{"1":"0.219175332","2":"1.279041e-01","3":"0.219175332"},{"1":"0.038181786","2":"2.949406e-02","3":"0.038181786"},{"1":"0.358023057","2":"3.581711e-01","3":"0.358023057"},{"1":"0.024246599","2":"2.308817e-02","3":"0.024246599"},{"1":"0.176779757","2":"4.813244e-03","3":"0.176779757"},{"1":"0.015414705","2":"4.972261e-03","3":"0.015414705"},{"1":"0.105720602","2":"5.354826e-02","3":"0.105720602"},{"1":"0.048936820","2":"1.835616e-02","3":"0.048936820"},{"1":"0.125334243","2":"2.795972e-01","3":"0.125334243"},{"1":"0.005051576","2":"8.800008e-04","3":"0.005051576"},{"1":"0.098801775","2":"1.431830e-01","3":"0.098801775"},{"1":"0.027292765","2":"1.664955e-02","3":"0.027292765"},{"1":"0.032342360","2":"3.081216e-03","3":"0.032342360"},{"1":"0.087940575","2":"9.938962e-02","3":"0.087940575"},{"1":"0.231748069","2":"2.635830e-01","3":"0.231748069"},{"1":"0.037120559","2":"6.738947e-03","3":"0.037120559"},{"1":"0.047769225","2":"1.229260e-02","3":"0.047769225"},{"1":"0.188296110","2":"1.166252e-01","3":"0.188296110"},{"1":"0.049210979","2":"5.526368e-03","3":"0.049210979"},{"1":"0.046377456","2":"2.471106e-02","3":"0.046377456"},{"1":"0.070055947","2":"7.662608e-02","3":"0.070055947"},{"1":"0.036449470","2":"3.941550e-02","3":"0.036449470"},{"1":"0.044101454","2":"9.100867e-03","3":"0.044101454"},{"1":"0.010959771","2":"5.855139e-03","3":"0.010959771"},{"1":"0.098480856","2":"5.648794e-02","3":"0.098480856"},{"1":"0.136639196","2":"5.477460e-02","3":"0.136639196"},{"1":"0.177501355","2":"7.892373e-02","3":"0.177501355"},{"1":"0.184296694","2":"2.203536e-01","3":"0.184296694"},{"1":"0.123086928","2":"2.230599e-01","3":"0.123086928"},{"1":"0.042744038","2":"2.265783e-02","3":"0.042744038"},{"1":"0.035080986","2":"2.658971e-02","3":"0.035080986"},{"1":"0.033594318","2":"3.132848e-02","3":"0.033594318"},{"1":"0.026587589","2":"1.097429e-01","3":"0.026587589"},{"1":"0.036712139","2":"1.366582e-03","3":"0.036712139"},{"1":"0.993748696","2":"9.996337e-01","3":"0.993748696"},{"1":"0.997501707","2":"9.999418e-01","3":"0.997501707"},{"1":"0.823885327","2":"9.326524e-01","3":"0.823885327"},{"1":"0.994496489","2":"9.992802e-01","3":"0.994496489"},{"1":"0.756703801","2":"9.496983e-01","3":"0.756703801"},{"1":"0.966294366","2":"9.973141e-01","3":"0.966294366"},{"1":"0.975675859","2":"9.938661e-01","3":"0.975675859"},{"1":"0.932043725","2":"9.936138e-01","3":"0.932043725"},{"1":"0.984270429","2":"9.974743e-01","3":"0.984270429"},{"1":"0.998691491","2":"9.999734e-01","3":"0.998691491"},{"1":"0.951019365","2":"9.919160e-01","3":"0.951019365"},{"1":"0.982290322","2":"9.990518e-01","3":"0.982290322"},{"1":"0.994665919","2":"9.999380e-01","3":"0.994665919"},{"1":"0.954863133","2":"9.936804e-01","3":"0.954863133"},{"1":"0.949367491","2":"9.952822e-01","3":"0.949367491"},{"1":"0.221356875","2":"1.112064e-01","3":"0.221356875"},{"1":"0.514082349","2":"6.727065e-01","3":"0.514082349"},{"1":"0.984118843","2":"9.984094e-01","3":"0.984118843"},{"1":"0.838931372","2":"9.425149e-01","3":"0.838931372"},{"1":"0.943741813","2":"9.785913e-01","3":"0.943741813"},{"1":"0.992714729","2":"9.997923e-01","3":"0.992714729"},{"1":"0.981410396","2":"9.994752e-01","3":"0.981410396"},{"1":"0.999500635","2":"9.999970e-01","3":"0.999500635"},{"1":"0.620541979","2":"9.128754e-01","3":"0.620541979"},{"1":"0.664103667","2":"7.336851e-01","3":"0.664103667"},{"1":"0.980978287","2":"9.969736e-01","3":"0.980978287"},{"1":"0.701559629","2":"7.929584e-01","3":"0.701559629"},{"1":"0.968703795","2":"9.946135e-01","3":"0.968703795"},{"1":"0.907487313","2":"9.908180e-01","3":"0.907487313"},{"1":"0.988556027","2":"9.994589e-01","3":"0.988556027"},{"1":"0.707048008","2":"7.578567e-01","3":"0.707048008"},{"1":"0.995148498","2":"9.996029e-01","3":"0.995148498"},{"1":"0.744705888","2":"8.594003e-01","3":"0.744705888"},{"1":"0.762136215","2":"9.377508e-01","3":"0.762136215"},{"1":"0.294287009","2":"1.619456e-01","3":"0.294287009"},{"1":"0.948027431","2":"9.985284e-01","3":"0.948027431"},{"1":"0.375405543","2":"6.669745e-01","3":"0.375405543"},{"1":"0.971739134","2":"9.973083e-01","3":"0.971739134"},{"1":"0.796013821","2":"9.659330e-01","3":"0.796013821"},{"1":"0.761470263","2":"9.441335e-01","3":"0.761470263"},{"1":"0.963901764","2":"9.846419e-01","3":"0.963901764"},{"1":"0.998057563","2":"9.999694e-01","3":"0.998057563"},{"1":"0.980852552","2":"9.978770e-01","3":"0.980852552"},{"1":"0.999505709","2":"9.999950e-01","3":"0.999505709"},{"1":"0.593147051","2":"6.662837e-01","3":"0.593147051"},{"1":"0.997524455","2":"9.997991e-01","3":"0.997524455"},{"1":"0.770300666","2":"8.822272e-01","3":"0.770300666"},{"1":"0.999628693","2":"9.999856e-01","3":"0.999628693"},{"1":"0.694495303","2":"8.384820e-01","3":"0.694495303"},{"1":"0.879127566","2":"9.847812e-01","3":"0.879127566"},{"1":"0.026294149","2":"2.949501e-02","3":"0.026294149"},{"1":"0.143221915","2":"6.576018e-02","3":"0.143221915"},{"1":"0.211049679","2":"1.198274e-01","3":"0.211049679"},{"1":"0.056689588","2":"1.141566e-02","3":"0.056689588"},{"1":"0.012420684","2":"1.177154e-03","3":"0.012420684"},{"1":"0.036687850","2":"7.967258e-03","3":"0.036687850"},{"1":"0.292492113","2":"1.179472e-01","3":"0.292492113"},{"1":"0.012450150","2":"9.119679e-04","3":"0.012450150"},{"1":"0.315086901","2":"5.628573e-01","3":"0.315086901"},{"1":"0.245290694","2":"5.826434e-02","3":"0.245290694"},{"1":"0.061258536","2":"6.259794e-02","3":"0.061258536"},{"1":"0.142529709","2":"2.643337e-01","3":"0.142529709"},{"1":"0.106283313","2":"3.541916e-02","3":"0.106283313"},{"1":"0.012221410","2":"5.397079e-03","3":"0.012221410"},{"1":"0.051405524","2":"3.052210e-02","3":"0.051405524"},{"1":"0.237660302","2":"1.050627e-01","3":"0.237660302"},{"1":"0.054339960","2":"4.107561e-02","3":"0.054339960"},{"1":"0.271029639","2":"1.626431e-01","3":"0.271029639"},{"1":"0.034381489","2":"1.893540e-02","3":"0.034381489"},{"1":"0.196559748","2":"1.273304e-01","3":"0.196559748"},{"1":"0.012571216","2":"5.442690e-03","3":"0.012571216"},{"1":"0.139021922","2":"5.246617e-02","3":"0.139021922"},{"1":"0.184713487","2":"1.794567e-01","3":"0.184713487"},{"1":"0.154077946","2":"2.249402e-01","3":"0.154077946"},{"1":"0.011269982","2":"2.492205e-03","3":"0.011269982"},{"1":"0.119606770","2":"1.130466e-01","3":"0.119606770"},{"1":"0.088193168","2":"8.274057e-02","3":"0.088193168"},{"1":"0.061582374","2":"7.475529e-03","3":"0.061582374"},{"1":"0.050454903","2":"3.700097e-02","3":"0.050454903"},{"1":"0.565014250","2":"6.696842e-01","3":"0.565014250"},{"1":"0.023875683","2":"2.033862e-03","3":"0.023875683"},{"1":"0.055431414","2":"2.681694e-02","3":"0.055431414"},{"1":"0.089302977","2":"3.433686e-02","3":"0.089302977"},{"1":"0.109872457","2":"2.278356e-02","3":"0.109872457"},{"1":"0.155291184","2":"1.280657e-01","3":"0.155291184"},{"1":"0.025195604","2":"1.546084e-02","3":"0.025195604"},{"1":"0.057536180","2":"4.839424e-02","3":"0.057536180"},{"1":"0.065085783","2":"4.254850e-02","3":"0.065085783"},{"1":"0.011858094","2":"5.121186e-03","3":"0.011858094"},{"1":"0.091613697","2":"4.298491e-02","3":"0.091613697"},{"1":"0.315985385","2":"2.122381e-01","3":"0.315985385"},{"1":"0.154318624","2":"4.396254e-02","3":"0.154318624"},{"1":"0.157391289","2":"1.904327e-01","3":"0.157391289"},{"1":"0.084867318","2":"1.407691e-01","3":"0.084867318"},{"1":"0.072688173","2":"1.009103e-01","3":"0.072688173"},{"1":"0.030098117","2":"2.310818e-02","3":"0.030098117"},{"1":"0.034632478","2":"9.068117e-03","3":"0.034632478"},{"1":"0.044150561","2":"3.924137e-02","3":"0.044150561"},{"1":"0.025193183","2":"1.193956e-03","3":"0.025193183"},{"1":"0.995686038","2":"9.997985e-01","3":"0.995686038"},{"1":"0.996767961","2":"9.998231e-01","3":"0.996767961"},{"1":"0.926665391","2":"9.793265e-01","3":"0.926665391"},{"1":"0.997955521","2":"9.998928e-01","3":"0.997955521"},{"1":"0.922759090","2":"9.878091e-01","3":"0.922759090"},{"1":"0.984337855","2":"9.983885e-01","3":"0.984337855"},{"1":"0.955912450","2":"9.867056e-01","3":"0.955912450"},{"1":"0.991750979","2":"9.996218e-01","3":"0.991750979"},{"1":"0.993580995","2":"9.991313e-01","3":"0.993580995"},{"1":"0.991910764","2":"9.994466e-01","3":"0.991910764"},{"1":"0.806288340","2":"9.190754e-01","3":"0.806288340"},{"1":"0.994169207","2":"9.998236e-01","3":"0.994169207"},{"1":"0.991056832","2":"9.997313e-01","3":"0.991056832"},{"1":"0.969656872","2":"9.938680e-01","3":"0.969656872"},{"1":"0.939051612","2":"9.928119e-01","3":"0.939051612"},{"1":"0.534998063","2":"4.841581e-01","3":"0.534998063"},{"1":"0.513768856","2":"6.125466e-01","3":"0.513768856"},{"1":"0.978321025","2":"9.961331e-01","3":"0.978321025"},{"1":"0.897287709","2":"9.881254e-01","3":"0.897287709"},{"1":"0.936424384","2":"9.851103e-01","3":"0.936424384"},{"1":"0.981889041","2":"9.991557e-01","3":"0.981889041"},{"1":"0.994599007","2":"9.999242e-01","3":"0.994599007"},{"1":"0.998294518","2":"9.999799e-01","3":"0.998294518"},{"1":"0.657159534","2":"9.214247e-01","3":"0.657159534"},{"1":"0.828340500","2":"8.837905e-01","3":"0.828340500"},{"1":"0.948345032","2":"9.668004e-01","3":"0.948345032"},{"1":"0.379895338","2":"2.309787e-01","3":"0.379895338"},{"1":"0.993973280","2":"9.989395e-01","3":"0.993973280"},{"1":"0.782891731","2":"9.609244e-01","3":"0.782891731"},{"1":"0.995396996","2":"9.999778e-01","3":"0.995396996"},{"1":"0.897597952","2":"9.421255e-01","3":"0.897597952"},{"1":"0.984150608","2":"9.976359e-01","3":"0.984150608"},{"1":"0.932512332","2":"9.740399e-01","3":"0.932512332"},{"1":"0.740808943","2":"8.842903e-01","3":"0.740808943"},{"1":"0.789945767","2":"7.786704e-01","3":"0.789945767"},{"1":"0.990367095","2":"9.998102e-01","3":"0.990367095"},{"1":"0.696872940","2":"8.924181e-01","3":"0.696872940"},{"1":"0.821031369","2":"9.092623e-01","3":"0.821031369"},{"1":"0.864315551","2":"9.814950e-01","3":"0.864315551"},{"1":"0.973275965","2":"9.975358e-01","3":"0.973275965"},{"1":"0.997197915","2":"9.996311e-01","3":"0.997197915"},{"1":"0.998738046","2":"9.999821e-01","3":"0.998738046"},{"1":"0.989474917","2":"9.989294e-01","3":"0.989474917"},{"1":"0.999563921","2":"9.999946e-01","3":"0.999563921"},{"1":"0.830392634","2":"9.207855e-01","3":"0.830392634"},{"1":"0.994262091","2":"9.995455e-01","3":"0.994262091"},{"1":"0.789651241","2":"8.979939e-01","3":"0.789651241"},{"1":"0.999594806","2":"9.999877e-01","3":"0.999594806"},{"1":"0.722901636","2":"8.654585e-01","3":"0.722901636"},{"1":"0.973311114","2":"9.989406e-01","3":"0.973311114"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for ROCR</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>labels_desbois <span class="ot">&lt;-</span> don_desbois<span class="sc">$</span>Y</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># naive score</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>predictions_naive_score <span class="ot">&lt;-</span> naive_score<span class="sc">$</span>Dim<span class="fl">.1</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>naive_score_group <span class="ot">&lt;-</span> naive_score <span class="sc">%&gt;%</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(Dim<span class="fl">.1</span>), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>cutoff_naive <span class="ot">&lt;-</span> <span class="fu">mean</span>(naive_score_group<span class="sc">$</span>mean_score)</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predictions_naive_score, labels_desbois)</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"darkolivegreen"</span>, </span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(cutoff_naive), </span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"                s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#add a 45 degree line</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="co"># lda</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>predictions_lda <span class="ot">&lt;-</span> <span class="fu">predict</span>(lda_desbois)<span class="sc">$</span>x</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>lda_score_group <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(don_desbois, predictions_lda) <span class="sc">%&gt;%</span></span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(LD1), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>cutoff_lda <span class="ot">&lt;-</span> <span class="fu">mean</span>(lda_score_group<span class="sc">$</span>mean_score)</span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predictions_lda, labels_desbois)</span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"plum4"</span>,</span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(cutoff_lda), </span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"                s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a><span class="co"># glm</span></span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a>predictions_glm <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm_desbois, <span class="at">type=</span><span class="st">'response'</span>)</span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a>glm_score_group <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(don_desbois, <span class="fu">tibble</span>(<span class="at">pred_glm =</span>predictions_glm)) <span class="sc">%&gt;%</span></span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(pred_glm), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb106-43"><a href="#cb106-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-44"><a href="#cb106-44" aria-hidden="true" tabindex="-1"></a>cutoff_glm <span class="ot">&lt;-</span> <span class="fu">mean</span>(glm_score_group<span class="sc">$</span>mean_score)</span>
<span id="cb106-45"><a href="#cb106-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-46"><a href="#cb106-46" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predictions_glm, labels_desbois)</span>
<span id="cb106-47"><a href="#cb106-47" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb106-48"><a href="#cb106-48" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb106-49"><a href="#cb106-49" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"dodgerblue"</span>,</span>
<span id="cb106-50"><a href="#cb106-50" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(cutoff_glm), </span>
<span id="cb106-51"><a href="#cb106-51" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"                s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb106-52"><a href="#cb106-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-53"><a href="#cb106-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-54"><a href="#cb106-54" aria-hidden="true" tabindex="-1"></a><span class="co"># glm - lasso</span></span>
<span id="cb106-55"><a href="#cb106-55" aria-hidden="true" tabindex="-1"></a>predictions_lasso <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(desbois_lasso_cv, <span class="at">newdata =</span> don_desbois, <span class="at">s =</span> desbois_lasso_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb106-56"><a href="#cb106-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-57"><a href="#cb106-57" aria-hidden="true" tabindex="-1"></a>lasso_score_group <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(don_desbois, <span class="fu">tibble</span>(<span class="at">pred_lasso =</span>predictions_lasso)) <span class="sc">%&gt;%</span></span>
<span id="cb106-58"><a href="#cb106-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Y) <span class="sc">%&gt;%</span></span>
<span id="cb106-59"><a href="#cb106-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_score =</span> <span class="fu">mean</span>(pred_lasso), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb106-60"><a href="#cb106-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-61"><a href="#cb106-61" aria-hidden="true" tabindex="-1"></a>cutoff_lasso <span class="ot">&lt;-</span> <span class="fu">mean</span>(lasso_score_group<span class="sc">$</span>mean_score)</span>
<span id="cb106-62"><a href="#cb106-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-63"><a href="#cb106-63" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(predictions_lasso, labels_desbois)</span>
<span id="cb106-64"><a href="#cb106-64" aria-hidden="true" tabindex="-1"></a>perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb106-65"><a href="#cb106-65" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb106-66"><a href="#cb106-66" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>,</span>
<span id="cb106-67"><a href="#cb106-67" aria-hidden="true" tabindex="-1"></a>     <span class="at">print.cutoffs.at =</span> <span class="fu">c</span>(cutoff_lasso), </span>
<span id="cb106-68"><a href="#cb106-68" aria-hidden="true" tabindex="-1"></a>     <span class="at">cutoff.label.function =</span> <span class="cf">function</span>(x) {<span class="fu">paste0</span>(<span class="st">"                s = "</span>,<span class="fu">round</span>(x,<span class="dv">2</span>))})</span>
<span id="cb106-69"><a href="#cb106-69" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.6</span>,<span class="fl">0.6</span>,</span>
<span id="cb106-70"><a href="#cb106-70" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">'naive - PCA'</span>, <span class="st">'LDA'</span>, <span class="st">'Logistic'</span>, <span class="st">'Lasso'</span>),</span>
<span id="cb106-71"><a href="#cb106-71" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"darkolivegreen"</span>, <span class="st">"plum4"</span>, <span class="st">"dodgerblue"</span>, <span class="st">"darkorange"</span>),<span class="at">lwd=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="model-assessment" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="model-assessment"><span class="header-section-number">3.6</span> Model assessment</h3>
<section id="hold-out" class="level4" data-number="3.6.1">
<h4 data-number="3.6.1" class="anchored" data-anchor-id="hold-out"><span class="header-section-number">3.6.1</span> Hold-out</h4>
<p>Perform a simple Hold-out approach (train/test split) and evaluate ROC / AUC for some <code>glm()</code> model specification of your choice (ie choose manually a subset of variables), you might take inspiration from this <a href="https://bradleyboehmke.github.io/HOML/process.html">book chapter</a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We choose 70%/30% split of the data set (training and testing set). Here the data set is balanced and train/test split using a simple random sampling shows a similar distribution of default:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using base R</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1987</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>index_1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(don_desbois), <span class="fu">round</span>(<span class="fu">nrow</span>(don_desbois) <span class="sc">*</span> <span class="fl">0.7</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>train_1 <span class="ot">&lt;-</span> don_desbois[index_1, ]</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>test_1  <span class="ot">&lt;-</span> don_desbois[<span class="sc">-</span>index_1, ]</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co"># table(don_desbois$Y) %&gt;% prop.table()</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        0        1 </span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.518254 0.481746</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="co"># table(train_1$Y) %&gt;% prop.table()</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5136054 0.4863946 </span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="co"># table(test_1$Y) %&gt;% prop.table()</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5291005 0.4708995 </span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Using rsample package</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1987</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>split_1  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(don_desbois, <span class="at">prop =</span> <span class="fl">0.7</span>)</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>train_2  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(split_1)</span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>test_2   <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(split_1)</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a><span class="co"># table(train_2$Y) %&gt;% prop.table()</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5136054 0.4863946 </span></span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a><span class="co"># table(test_2$Y) %&gt;% prop.table()</span></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5291005 0.4708995 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In case we want to avoid the split of an already imbalanced data set to further skew distributions we may want to use <a href="https://rsample.tidymodels.org/articles/Common_Patterns.html#stratified-resampling">Stratified sampling</a>:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1987</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>split_strat  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(don_desbois, <span class="at">prop =</span> <span class="fl">0.7</span>, </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">strata =</span> <span class="st">"Y"</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>train_strat  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(split_strat)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>test_strat   <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(split_strat)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># table(don_desbois$Y) %&gt;% prop.table()</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        0        1 </span></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.518254 0.481746</span></span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a><span class="co"># table(train_strat$Y) %&gt;% prop.table()</span></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5187287 0.4812713  </span></span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="co"># table(test_strat$Y) %&gt;% prop.table()</span></span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5171504 0.4828496 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We obtain the AUC and plot the ROC curves for training (for information only) and testing sets (the one we are interested in to assess models):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit logistic regression model</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>model_desbois <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> STATUS <span class="sc">+</span> HECTARE <span class="sc">+</span> r1 <span class="sc">+</span> r3 <span class="sc">+</span> r17 <span class="sc">+</span> r24 <span class="sc">+</span> r28 <span class="sc">+</span> r36,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> train_strat,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot ROC / compute AUC for the training set</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>pred_train <span class="ot">&lt;-</span> ROCR<span class="sc">::</span><span class="fu">prediction</span>(model_desbois<span class="sc">$</span>fitted.values, train_strat<span class="sc">$</span>Y)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>perf_train <span class="ot">&lt;-</span> ROCR<span class="sc">::</span><span class="fu">performance</span>(pred_train, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf_train, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>)</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#add a 45 degree line</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>auc_train <span class="ot">&lt;-</span> ROCR<span class="sc">::</span><span class="fu">performance</span>(pred_train, <span class="at">measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>auc_train <span class="ot">&lt;-</span> auc_train<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>auc_train </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9630589</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># auc_train</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.9630589</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># use fitted model to predict value on testing set</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>test_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_desbois, <span class="at">newdata=</span>test_strat, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot ROC / compute AUC for the training set</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>pred_test <span class="ot">&lt;-</span> ROCR<span class="sc">::</span><span class="fu">prediction</span>(test_predict, test_strat<span class="sc">$</span>Y)</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>perf_test <span class="ot">&lt;-</span> ROCR<span class="sc">::</span><span class="fu">performance</span>(pred_test, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf_test, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"dodgerblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>auc_test <span class="ot">&lt;-</span> ROCR<span class="sc">::</span><span class="fu">performance</span>(pred_test, <span class="at">measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>auc_test <span class="ot">&lt;-</span> auc_test<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>auc_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9642021</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># auc_test</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.9642021</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># As in the Desbois article, the AUC figures are around 0.96 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="k-fold-cross-validation" class="level4" data-number="3.6.2">
<h4 data-number="3.6.2" class="anchored" data-anchor-id="k-fold-cross-validation"><span class="header-section-number">3.6.2</span> K-fold cross validation</h4>
<p>Perform k-fold cross validation and for each fold evaluate ROC / AUC for the same models as before</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>First leveraging <code>rsample</code>, the <code>tidyverse</code> and stackoverflow, efficient and compact but difficult to understand or tweak:</p>
<p>Splitting the data set into 10 folds or blocks:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1987</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>folds_10  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(train_strat, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>cvfun <span class="ot">&lt;-</span> <span class="cf">function</span>(split, ...){</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> STATUS <span class="sc">+</span> HECTARE <span class="sc">+</span> r1 <span class="sc">+</span> r3 <span class="sc">+</span> r17 <span class="sc">+</span> r24 <span class="sc">+</span> r28 <span class="sc">+</span> r36,</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>rsample<span class="sc">::</span><span class="fu">analysis</span>(split),</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">family=</span>binomial)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">newdata=</span>rsample<span class="sc">::</span><span class="fu">assessment</span>(split), <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">fit =</span> fit, <span class="at">y =</span> <span class="fu">model.response</span>(<span class="fu">model.frame</span>(<span class="fu">formula</span>(mod), <span class="at">data=</span>rsample<span class="sc">::</span><span class="fu">assessment</span>(split))))</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>cv_out <span class="ot">&lt;-</span> folds_10 <span class="sc">%&gt;%</span> </span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fit =</span> purrr<span class="sc">::</span><span class="fu">map</span>(splits, cvfun)) <span class="sc">%&gt;%</span> </span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(fit) <span class="sc">%&gt;%</span> </span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">auc =</span> pROC<span class="sc">::</span><span class="fu">roc</span>(y, fit, <span class="at">plot=</span><span class="cn">FALSE</span>)<span class="sc">$</span>auc[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/66000977/roc-with-cross-validation-for-linear-regression-in-r</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>cv_out_plot <span class="ot">&lt;-</span> folds_10 <span class="sc">%&gt;%</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(splits, cvfun)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(fit) <span class="sc">%&gt;%</span> </span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sens =</span> pROC<span class="sc">::</span><span class="fu">roc</span>(y, fit, <span class="at">plot=</span><span class="cn">FALSE</span>)<span class="sc">$</span>sensitivities, </span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">spec =</span> pROC<span class="sc">::</span><span class="fu">roc</span>(y, fit, <span class="at">plot=</span><span class="cn">FALSE</span>)<span class="sc">$</span>specificities, </span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">obs =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sens))</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>ave <span class="ot">&lt;-</span> cv_out_plot <span class="sc">%&gt;%</span> </span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(obs) <span class="sc">%&gt;%</span> </span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sens =</span> <span class="fu">mean</span>(sens), </span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">spec =</span> <span class="fu">mean</span>(spec), </span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">id =</span> <span class="st">"Average"</span>)</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>cv_out_plot <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cv_out_plot, ave) <span class="sc">%&gt;%</span> </span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="st">"Average"</span>, <span class="st">"Average"</span>, <span class="st">"Individual"</span>), </span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Individual"</span>, <span class="st">"Average"</span>)))</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cv_out_plot , <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>sens, <span class="at">y=</span>spec, <span class="at">group=</span>id, <span class="at">colour=</span>col)) <span class="sc">+</span> </span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">size=</span>col, <span class="at">alpha=</span>col)) <span class="sc">+</span> </span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)) <span class="sc">+</span> </span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values=</span><span class="fu">c</span>(.<span class="dv">5</span>,<span class="fl">1.25</span>)) <span class="sc">+</span> </span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values=</span><span class="fu">c</span>(.<span class="dv">3</span>, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"1-Sensitivity"</span>, <span class="at">y=</span><span class="st">"Specificity"</span>, <span class="at">colour=</span><span class="st">""</span>, <span class="at">alpha=</span><span class="st">""</span>, <span class="at">size=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="0_warmup_desbois_solution_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We implement k-fold cross validation (using AUC as metric) from scratch.</p>
<p>It is a less efficient and lengthy code than before, but it is also easier to understand and adapt to your needs. We commented the code below as it takes time to run, launching five times a 10-fold Cross Validation for 10 different models, (alternatively you can diminish the repeat and fold number):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set to TRUE to run, can be very slow</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>RUN <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1987</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(RUN){</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  res_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we repeat the k-fold cross validation nb_iter times</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  nb_iter <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># Usually 5 x 10 fold validation, set to 1 if too slow</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nb_iter) {</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we split randomly the dataset into 10 folds</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>        nb_blocks <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># number of folds/blocks, set to 5 if too low</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>        blocks <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nb_blocks,<span class="fu">nrow</span>(don_desbois))[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(don_desbois)])</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>        result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">dim</span>(don_desbois),<span class="at">ncol=</span><span class="dv">10</span>))</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>       <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nb_blocks) {</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">print</span>(i)</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>             <span class="co"># we sequentially use each fold as a testing set / the complement being used as training set</span></span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>             XX_train <span class="ot">&lt;-</span> don_desbois[blocks<span class="sc">!=</span>i,]</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>             XX_test <span class="ot">&lt;-</span> don_desbois[blocks<span class="sc">==</span>i,]</span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>             <span class="co"># we then fit different models we want to assess</span></span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>             <span class="co"># glm full (ie a logistic regression with all variables)</span></span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>             class1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> .,</span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data=</span>XX_train,</span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family=</span>binomial)</span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a>             <span class="co"># glm desbois (ie a logistic regression with the variables selected by Desbois)</span></span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a>             class2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14 <span class="sc">+</span> r17 <span class="sc">+</span> r36 <span class="sc">+</span> r12,</span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data=</span>XX_train,</span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family=</span>binomial)</span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a>             <span class="co"># stepwise methods</span></span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a>             <span class="co"># the forward methods need to start with a simple model, here with only the intercept</span></span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a>             intercept_only <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>XX_train, <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a>             <span class="co"># forward aic</span></span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a>             class3 <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(class1),</span>
<span id="cb119-46"><a href="#cb119-46" aria-hidden="true" tabindex="-1"></a>                            <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-47"><a href="#cb119-47" aria-hidden="true" tabindex="-1"></a>             <span class="co"># forward bic</span></span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a>             class4 <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(class1),</span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a>                            <span class="at">k=</span><span class="fu">log</span>(<span class="fu">nrow</span>(don_desbois)), <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-50"><a href="#cb119-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-51"><a href="#cb119-51" aria-hidden="true" tabindex="-1"></a>             <span class="co"># backward methods start usually from a full model</span></span>
<span id="cb119-52"><a href="#cb119-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-53"><a href="#cb119-53" aria-hidden="true" tabindex="-1"></a>             <span class="co"># backward aic</span></span>
<span id="cb119-54"><a href="#cb119-54" aria-hidden="true" tabindex="-1"></a>             class5 <span class="ot">&lt;-</span> <span class="fu">step</span>(class1, <span class="at">direction=</span><span class="st">'backward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(class1),</span>
<span id="cb119-55"><a href="#cb119-55" aria-hidden="true" tabindex="-1"></a>                            <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-56"><a href="#cb119-56" aria-hidden="true" tabindex="-1"></a>             <span class="co"># backward bic</span></span>
<span id="cb119-57"><a href="#cb119-57" aria-hidden="true" tabindex="-1"></a>             class6 <span class="ot">&lt;-</span> <span class="fu">step</span>(class1, <span class="at">direction=</span><span class="st">'backward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(class1),</span>
<span id="cb119-58"><a href="#cb119-58" aria-hidden="true" tabindex="-1"></a>                            <span class="at">k=</span><span class="fu">log</span>(<span class="fu">nrow</span>(don_desbois)), <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-59"><a href="#cb119-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-60"><a href="#cb119-60" aria-hidden="true" tabindex="-1"></a>             <span class="co"># we test here penalized logistic regression approaches,</span></span>
<span id="cb119-61"><a href="#cb119-61" aria-hidden="true" tabindex="-1"></a>             <span class="co"># selecting the best penalization parameters lambda in terms of AUC using glmnet cv.glmnet function</span></span>
<span id="cb119-62"><a href="#cb119-62" aria-hidden="true" tabindex="-1"></a>             <span class="co"># this function implementing a k-fold cross-validation for glmnet, and producing two 'optimal' values of lambda</span></span>
<span id="cb119-63"><a href="#cb119-63" aria-hidden="true" tabindex="-1"></a>             <span class="co"># lambda.min (value of lambda that gives minimum metric (here AUC so maximum) and</span></span>
<span id="cb119-64"><a href="#cb119-64" aria-hidden="true" tabindex="-1"></a>             <span class="co"># lambda.1se (largest value of lambda such that metric is within 1 standard error of the minimum (here AUC so maximum) metric)</span></span>
<span id="cb119-65"><a href="#cb119-65" aria-hidden="true" tabindex="-1"></a>             <span class="co"># the lambda.1se is used by the predict function of glmnet</span></span>
<span id="cb119-66"><a href="#cb119-66" aria-hidden="true" tabindex="-1"></a>             <span class="co"># using lambda.1se is an heuristic so you can challenge it, below the justification of the authors for the use of 1se:</span></span>
<span id="cb119-67"><a href="#cb119-67" aria-hidden="true" tabindex="-1"></a>             <span class="co"># "We often use the “one-standard-error” rule when selecting the best model; this acknowledges the fact that the risk curves</span></span>
<span id="cb119-68"><a href="#cb119-68" aria-hidden="true" tabindex="-1"></a>             <span class="co"># are estimated with error, so errs on the side of parsimony."</span></span>
<span id="cb119-69"><a href="#cb119-69" aria-hidden="true" tabindex="-1"></a>             <span class="co"># see also here https://stats.stackexchange.com/questions/138569/why-is-lambda-within-one-standard-error-from-the-minimum-is-a-recommended-valu</span></span>
<span id="cb119-70"><a href="#cb119-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-71"><a href="#cb119-71" aria-hidden="true" tabindex="-1"></a>             <span class="co"># more details on glmnet here https://glmnet.stanford.edu/articles/glmnet.html or in the Elements of Statistical learning</span></span>
<span id="cb119-72"><a href="#cb119-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-73"><a href="#cb119-73" aria-hidden="true" tabindex="-1"></a>             <span class="co"># penalized regression</span></span>
<span id="cb119-74"><a href="#cb119-74" aria-hidden="true" tabindex="-1"></a>             <span class="co"># ridge</span></span>
<span id="cb119-75"><a href="#cb119-75" aria-hidden="true" tabindex="-1"></a>             <span class="co"># class7 &lt;- cv.glmnet(as.matrix(XX_train[,-which(names(XX_train)=="maxO3")]),XX_train$maxO3,alpha=0)</span></span>
<span id="cb119-76"><a href="#cb119-76" aria-hidden="true" tabindex="-1"></a>             class7  <span class="ot">&lt;-</span> glmnetUtils<span class="sc">::</span><span class="fu">cv.glmnet</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>XX_train, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">alpha=</span><span class="dv">0</span>, <span class="at">type.measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb119-77"><a href="#cb119-77" aria-hidden="true" tabindex="-1"></a>             <span class="co"># lasso</span></span>
<span id="cb119-78"><a href="#cb119-78" aria-hidden="true" tabindex="-1"></a>             <span class="co"># class8 &lt;- cv.glmnet(as.matrix(XX_train[,-which(names(XX_train)=="maxO3")]),XX_train$maxO3,alpha=1)</span></span>
<span id="cb119-79"><a href="#cb119-79" aria-hidden="true" tabindex="-1"></a>             class8  <span class="ot">&lt;-</span> glmnetUtils<span class="sc">::</span><span class="fu">cv.glmnet</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>XX_train, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">type.measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb119-80"><a href="#cb119-80" aria-hidden="true" tabindex="-1"></a>             <span class="co"># elastic-net</span></span>
<span id="cb119-81"><a href="#cb119-81" aria-hidden="true" tabindex="-1"></a>             <span class="co"># class9 &lt;- cv.glmnet(as.matrix(XX_train[,-which(names(XX_train)=="maxO3")]),XX_train$maxO3,alpha=0.5)</span></span>
<span id="cb119-82"><a href="#cb119-82" aria-hidden="true" tabindex="-1"></a>             class9  <span class="ot">&lt;-</span> glmnetUtils<span class="sc">::</span><span class="fu">cv.glmnet</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>XX_train, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">type.measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb119-83"><a href="#cb119-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-84"><a href="#cb119-84" aria-hidden="true" tabindex="-1"></a>             <span class="co"># cart</span></span>
<span id="cb119-85"><a href="#cb119-85" aria-hidden="true" tabindex="-1"></a>             class10 <span class="ot">&lt;-</span> rpart<span class="sc">::</span><span class="fu">rpart</span>(Y<span class="sc">~</span>., <span class="at">data =</span> XX_train, <span class="at">method =</span> <span class="st">"class"</span>)</span>
<span id="cb119-86"><a href="#cb119-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-87"><a href="#cb119-87" aria-hidden="true" tabindex="-1"></a>             <span class="co"># we save predictions on test set for later use (for example plotting ROC curves or computing AUC or any other metric)</span></span>
<span id="cb119-88"><a href="#cb119-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-89"><a href="#cb119-89" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">predict</span>(class1, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb119-90"><a href="#cb119-90" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">predict</span>(class2, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb119-91"><a href="#cb119-91" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">3</span>] <span class="ot">=</span> <span class="fu">predict</span>(class3, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb119-92"><a href="#cb119-92" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">4</span>] <span class="ot">=</span> <span class="fu">predict</span>(class4, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb119-93"><a href="#cb119-93" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">5</span>] <span class="ot">=</span> <span class="fu">predict</span>(class5, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb119-94"><a href="#cb119-94" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">6</span>] <span class="ot">=</span> <span class="fu">predict</span>(class6, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb119-95"><a href="#cb119-95" aria-hidden="true" tabindex="-1"></a>             <span class="co"># penalized - glmnet</span></span>
<span id="cb119-96"><a href="#cb119-96" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">7</span>] <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(class7, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb119-97"><a href="#cb119-97" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">8</span>] <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(class8, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb119-98"><a href="#cb119-98" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">9</span>] <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">predict</span>(class9, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"response"</span>))</span>
<span id="cb119-99"><a href="#cb119-99" aria-hidden="true" tabindex="-1"></a>             <span class="co"># cart</span></span>
<span id="cb119-100"><a href="#cb119-100" aria-hidden="true" tabindex="-1"></a>             result[blocks<span class="sc">==</span>i,<span class="dv">10</span>] <span class="ot">=</span> <span class="fu">predict</span>(class10, <span class="at">newdata=</span>XX_test, <span class="at">type =</span> <span class="st">"prob"</span>)[, <span class="dv">2</span>]</span>
<span id="cb119-101"><a href="#cb119-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-102"><a href="#cb119-102" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb119-103"><a href="#cb119-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-104"><a href="#cb119-104" aria-hidden="true" tabindex="-1"></a>      <span class="co"># we give names to the result columns corresponding to the models assessed</span></span>
<span id="cb119-105"><a href="#cb119-105" aria-hidden="true" tabindex="-1"></a>       <span class="fu">names</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"glm full"</span>,</span>
<span id="cb119-106"><a href="#cb119-106" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"glm desbois"</span>,</span>
<span id="cb119-107"><a href="#cb119-107" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"forward aic"</span>,</span>
<span id="cb119-108"><a href="#cb119-108" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"forward bic"</span>,</span>
<span id="cb119-109"><a href="#cb119-109" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"backward aic"</span>,</span>
<span id="cb119-110"><a href="#cb119-110" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"backward bic"</span>,</span>
<span id="cb119-111"><a href="#cb119-111" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"ridge"</span>,</span>
<span id="cb119-112"><a href="#cb119-112" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"lasso"</span>,</span>
<span id="cb119-113"><a href="#cb119-113" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"elastic-net"</span>,</span>
<span id="cb119-114"><a href="#cb119-114" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"cart"</span>)</span>
<span id="cb119-115"><a href="#cb119-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-116"><a href="#cb119-116" aria-hidden="true" tabindex="-1"></a>       <span class="co"># as the AUC is the metric requested, we define a function to compute the AUC given a Scoring/Probabilities vector X and a output/response vector of true</span></span>
<span id="cb119-117"><a href="#cb119-117" aria-hidden="true" tabindex="-1"></a>       <span class="co"># values Y</span></span>
<span id="cb119-118"><a href="#cb119-118" aria-hidden="true" tabindex="-1"></a>       auc <span class="ot">&lt;-</span> <span class="cf">function</span>(X,Y){</span>
<span id="cb119-119"><a href="#cb119-119" aria-hidden="true" tabindex="-1"></a>              pred <span class="ot">&lt;-</span> ROCR<span class="sc">::</span><span class="fu">prediction</span>(X, Y)</span>
<span id="cb119-120"><a href="#cb119-120" aria-hidden="true" tabindex="-1"></a>              auc <span class="ot">&lt;-</span> ROCR<span class="sc">::</span><span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb119-121"><a href="#cb119-121" aria-hidden="true" tabindex="-1"></a>              auc <span class="ot">&lt;-</span> auc<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb119-122"><a href="#cb119-122" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb119-123"><a href="#cb119-123" aria-hidden="true" tabindex="-1"></a>       <span class="co"># we compute the AUC to each of the fitted models</span></span>
<span id="cb119-124"><a href="#cb119-124" aria-hidden="true" tabindex="-1"></a>       res_list[[j]] <span class="ot">=</span> <span class="fu">list</span>(<span class="at">auc =</span> <span class="fu">apply</span>(result, <span class="dv">2</span>, auc, <span class="at">Y=</span>don_desbois<span class="sc">$</span>Y), <span class="at">result =</span> result)</span>
<span id="cb119-125"><a href="#cb119-125" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb119-126"><a href="#cb119-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-127"><a href="#cb119-127" aria-hidden="true" tabindex="-1"></a>  <span class="co"># saving/persisting to rds for latter use</span></span>
<span id="cb119-128"><a href="#cb119-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(res_list, <span class="st">"res_list.rds"</span>)</span>
<span id="cb119-129"><a href="#cb119-129" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Uncomment to run, can be slow</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(1987)</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co">#res_list &lt;- list()</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # we repeat the k-fold cross validation nb_iter times</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co"># nb_iter &lt;- 5 # Usually 5 x 10 fold validation, set to 1 if too low</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="co"># for (j in 1:nb_iter) {</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="co"># # we split randomly the dataset into 10 folds</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="co">#      nb_blocks &lt;- 10 # number of folds/blocks, set to 5 if too low</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="co">#      blocks &lt;- sample(rep(1:nb_blocks,nrow(don_desbois))[1:nrow(don_desbois)])</span></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co">#      result &lt;- data.frame(matrix(nrow=dim(don_desbois),ncol=10))</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="co">#      for (i in 1:nb_blocks) {</span></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="co">#            print(i)</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a><span class="co">#            # we sequentially use each fold as a testing set / the complement being used as training set</span></span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a><span class="co">#            XX_train &lt;- don_desbois[blocks!=i,]</span></span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a><span class="co">#            XX_test &lt;- don_desbois[blocks==i,]</span></span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a><span class="co">#            # we then fit different models we want to assess</span></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a><span class="co">#            # glm full (ie a logistic regression with all variables)</span></span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a><span class="co">#            class1 &lt;- glm(Y ~ .,</span></span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                          data=XX_train,</span></span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a><span class="co">#                          family=binomial)</span></span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a><span class="co">#            # glm desbois (ie a logistic regression with the variables selected by Desbois)</span></span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a><span class="co">#            class2 &lt;- glm(Y ~ r1 + r32 + r14 + r17 + r36 + r12,</span></span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                          data=XX_train,</span></span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                          family=binomial)</span></span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a><span class="co">#            # stepwise methods</span></span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a><span class="co">#            # the forward methods need to start with a simple model, here with only the intercept</span></span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a><span class="co">#            intercept_only &lt;- glm(Y ~ 1, data=XX_train, family="binomial")</span></span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a><span class="co">#            # forward aic</span></span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a><span class="co">#            class3 &lt;- step(intercept_only, direction='forward', test = 'LRT', scope=formula(class1),</span></span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a><span class="co">#                           k=2, trace = FALSE)</span></span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a><span class="co">#            # forward bic</span></span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a><span class="co">#            class4 &lt;- step(intercept_only, direction='forward', test = 'LRT', scope=formula(class1),</span></span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a><span class="co">#                           k=log(nrow(don_desbois)), trace = FALSE)</span></span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a><span class="co">#            # backward methods start usually from a full model</span></span>
<span id="cb120-50"><a href="#cb120-50" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-51"><a href="#cb120-51" aria-hidden="true" tabindex="-1"></a><span class="co">#            # backward aic</span></span>
<span id="cb120-52"><a href="#cb120-52" aria-hidden="true" tabindex="-1"></a><span class="co">#            class5 &lt;- step(class1, direction='backward', test = 'LRT', scope=formula(class1),</span></span>
<span id="cb120-53"><a href="#cb120-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                           k=2, trace = FALSE)</span></span>
<span id="cb120-54"><a href="#cb120-54" aria-hidden="true" tabindex="-1"></a><span class="co">#            # backward bic</span></span>
<span id="cb120-55"><a href="#cb120-55" aria-hidden="true" tabindex="-1"></a><span class="co">#            class6 &lt;- step(class1, direction='backward', test = 'LRT', scope=formula(class1),</span></span>
<span id="cb120-56"><a href="#cb120-56" aria-hidden="true" tabindex="-1"></a><span class="co">#                           k=log(nrow(don_desbois)), trace = FALSE)</span></span>
<span id="cb120-57"><a href="#cb120-57" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-58"><a href="#cb120-58" aria-hidden="true" tabindex="-1"></a><span class="co">#            # we test here penalized logistic regression approaches, </span></span>
<span id="cb120-59"><a href="#cb120-59" aria-hidden="true" tabindex="-1"></a><span class="co">#            # selecting the best penalization parameters lambda in terms of AUC using glmnet cv.glmnet function</span></span>
<span id="cb120-60"><a href="#cb120-60" aria-hidden="true" tabindex="-1"></a><span class="co">#            # this function implementing a k-fold cross-validation for glmnet, and producing two 'optimal' values of lambda</span></span>
<span id="cb120-61"><a href="#cb120-61" aria-hidden="true" tabindex="-1"></a><span class="co">#            # lambda.min (value of lambda that gives minimum metric (here AUC so maximum) and </span></span>
<span id="cb120-62"><a href="#cb120-62" aria-hidden="true" tabindex="-1"></a><span class="co">#            # lambda.1se (largest value of lambda such that metric is within 1 standard error of the minimum (here AUC so maximum) metric)</span></span>
<span id="cb120-63"><a href="#cb120-63" aria-hidden="true" tabindex="-1"></a><span class="co">#            # the lambda.1se is used by the predict function of glmnet</span></span>
<span id="cb120-64"><a href="#cb120-64" aria-hidden="true" tabindex="-1"></a><span class="co">#            # using lambda.1se is an heuristic so you can challenge it, below the justification of the authors for the use of 1se:</span></span>
<span id="cb120-65"><a href="#cb120-65" aria-hidden="true" tabindex="-1"></a><span class="co">#            # "We often use the “one-standard-error” rule when selecting the best model; this acknowledges the fact that the risk curves </span></span>
<span id="cb120-66"><a href="#cb120-66" aria-hidden="true" tabindex="-1"></a><span class="co">#            # are estimated with error, so errs on the side of parsimony."</span></span>
<span id="cb120-67"><a href="#cb120-67" aria-hidden="true" tabindex="-1"></a><span class="co">#            # see also here https://stats.stackexchange.com/questions/138569/why-is-lambda-within-one-standard-error-from-the-minimum-is-a-recommended-valu</span></span>
<span id="cb120-68"><a href="#cb120-68" aria-hidden="true" tabindex="-1"></a><span class="co">#            </span></span>
<span id="cb120-69"><a href="#cb120-69" aria-hidden="true" tabindex="-1"></a><span class="co">#            # more details on glmnet here https://glmnet.stanford.edu/articles/glmnet.html or in the Elements of Statistical learning</span></span>
<span id="cb120-70"><a href="#cb120-70" aria-hidden="true" tabindex="-1"></a><span class="co">#            </span></span>
<span id="cb120-71"><a href="#cb120-71" aria-hidden="true" tabindex="-1"></a><span class="co">#            # penalized regression</span></span>
<span id="cb120-72"><a href="#cb120-72" aria-hidden="true" tabindex="-1"></a><span class="co">#            # ridge</span></span>
<span id="cb120-73"><a href="#cb120-73" aria-hidden="true" tabindex="-1"></a><span class="co">#            # class7 &lt;- cv.glmnet(as.matrix(XX_train[,-which(names(XX_train)=="maxO3")]),XX_train$maxO3,alpha=0)</span></span>
<span id="cb120-74"><a href="#cb120-74" aria-hidden="true" tabindex="-1"></a><span class="co">#            class7  &lt;- glmnetUtils::cv.glmnet(Y ~ ., data=XX_train, family="binomial", alpha=0, type.measure = "auc")</span></span>
<span id="cb120-75"><a href="#cb120-75" aria-hidden="true" tabindex="-1"></a><span class="co">#            # lasso</span></span>
<span id="cb120-76"><a href="#cb120-76" aria-hidden="true" tabindex="-1"></a><span class="co">#            # class8 &lt;- cv.glmnet(as.matrix(XX_train[,-which(names(XX_train)=="maxO3")]),XX_train$maxO3,alpha=1)</span></span>
<span id="cb120-77"><a href="#cb120-77" aria-hidden="true" tabindex="-1"></a><span class="co">#            class8  &lt;- glmnetUtils::cv.glmnet(Y ~ ., data=XX_train, family="binomial", alpha=1, type.measure = "auc")</span></span>
<span id="cb120-78"><a href="#cb120-78" aria-hidden="true" tabindex="-1"></a><span class="co">#            # elastic-net</span></span>
<span id="cb120-79"><a href="#cb120-79" aria-hidden="true" tabindex="-1"></a><span class="co">#            # class9 &lt;- cv.glmnet(as.matrix(XX_train[,-which(names(XX_train)=="maxO3")]),XX_train$maxO3,alpha=0.5)</span></span>
<span id="cb120-80"><a href="#cb120-80" aria-hidden="true" tabindex="-1"></a><span class="co">#            class9  &lt;- glmnetUtils::cv.glmnet(Y ~ ., data=XX_train, family="binomial", alpha=0.5, type.measure = "auc")</span></span>
<span id="cb120-81"><a href="#cb120-81" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-82"><a href="#cb120-82" aria-hidden="true" tabindex="-1"></a><span class="co">#            # cart</span></span>
<span id="cb120-83"><a href="#cb120-83" aria-hidden="true" tabindex="-1"></a><span class="co">#            class10 &lt;- rpart::rpart(Y~., data = XX_train, method = "class")</span></span>
<span id="cb120-84"><a href="#cb120-84" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-85"><a href="#cb120-85" aria-hidden="true" tabindex="-1"></a><span class="co">#            # we save predictions on test set for later use (for example plotting ROC curves or computing AUC or any other metric)</span></span>
<span id="cb120-86"><a href="#cb120-86" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-87"><a href="#cb120-87" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,1] = predict(class1, newdata=XX_test, type = "response")</span></span>
<span id="cb120-88"><a href="#cb120-88" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,2] = predict(class2, newdata=XX_test, type = "response")</span></span>
<span id="cb120-89"><a href="#cb120-89" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,3] = predict(class3, newdata=XX_test, type = "response")</span></span>
<span id="cb120-90"><a href="#cb120-90" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,4] = predict(class4, newdata=XX_test, type = "response")</span></span>
<span id="cb120-91"><a href="#cb120-91" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,5] = predict(class5, newdata=XX_test, type = "response")</span></span>
<span id="cb120-92"><a href="#cb120-92" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,6] = predict(class6, newdata=XX_test, type = "response")</span></span>
<span id="cb120-93"><a href="#cb120-93" aria-hidden="true" tabindex="-1"></a><span class="co">#            # penalized - glmnet</span></span>
<span id="cb120-94"><a href="#cb120-94" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,7] = as.vector(predict(class7, newdata=XX_test, type = "response"))</span></span>
<span id="cb120-95"><a href="#cb120-95" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,8] = as.vector(predict(class8, newdata=XX_test, type = "response"))</span></span>
<span id="cb120-96"><a href="#cb120-96" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,9] = as.vector(predict(class9, newdata=XX_test, type = "response"))</span></span>
<span id="cb120-97"><a href="#cb120-97" aria-hidden="true" tabindex="-1"></a><span class="co">#            # cart</span></span>
<span id="cb120-98"><a href="#cb120-98" aria-hidden="true" tabindex="-1"></a><span class="co">#            result[blocks==i,10] = predict(class10, newdata=XX_test, type = "prob")[, 2]</span></span>
<span id="cb120-99"><a href="#cb120-99" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-100"><a href="#cb120-100" aria-hidden="true" tabindex="-1"></a><span class="co">#      }</span></span>
<span id="cb120-101"><a href="#cb120-101" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-102"><a href="#cb120-102" aria-hidden="true" tabindex="-1"></a><span class="co">#     # we give names to the result columns corresponding to the models assessed</span></span>
<span id="cb120-103"><a href="#cb120-103" aria-hidden="true" tabindex="-1"></a><span class="co">#      names(result) &lt;- c("glm full",</span></span>
<span id="cb120-104"><a href="#cb120-104" aria-hidden="true" tabindex="-1"></a><span class="co">#                         "glm desbois",</span></span>
<span id="cb120-105"><a href="#cb120-105" aria-hidden="true" tabindex="-1"></a><span class="co">#                         "forward aic",</span></span>
<span id="cb120-106"><a href="#cb120-106" aria-hidden="true" tabindex="-1"></a><span class="co">#                         "forward bic",</span></span>
<span id="cb120-107"><a href="#cb120-107" aria-hidden="true" tabindex="-1"></a><span class="co">#                         "backward aic",</span></span>
<span id="cb120-108"><a href="#cb120-108" aria-hidden="true" tabindex="-1"></a><span class="co">#                         "backward bic",</span></span>
<span id="cb120-109"><a href="#cb120-109" aria-hidden="true" tabindex="-1"></a><span class="co">#                         "ridge",</span></span>
<span id="cb120-110"><a href="#cb120-110" aria-hidden="true" tabindex="-1"></a><span class="co">#                         "lasso",</span></span>
<span id="cb120-111"><a href="#cb120-111" aria-hidden="true" tabindex="-1"></a><span class="co">#                         "elastic-net",</span></span>
<span id="cb120-112"><a href="#cb120-112" aria-hidden="true" tabindex="-1"></a><span class="co">#                         "cart")</span></span>
<span id="cb120-113"><a href="#cb120-113" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-114"><a href="#cb120-114" aria-hidden="true" tabindex="-1"></a><span class="co">#      # as the AUC is the metric requested, we define a function to compute the AUC given a Scoring/Probabilities vector X and a output/response vector of true</span></span>
<span id="cb120-115"><a href="#cb120-115" aria-hidden="true" tabindex="-1"></a><span class="co">#      # values Y</span></span>
<span id="cb120-116"><a href="#cb120-116" aria-hidden="true" tabindex="-1"></a><span class="co">#      auc &lt;- function(X,Y){</span></span>
<span id="cb120-117"><a href="#cb120-117" aria-hidden="true" tabindex="-1"></a><span class="co">#             pred &lt;- ROCR::prediction(X, Y)</span></span>
<span id="cb120-118"><a href="#cb120-118" aria-hidden="true" tabindex="-1"></a><span class="co">#             auc &lt;- ROCR::performance(pred, measure = "auc")</span></span>
<span id="cb120-119"><a href="#cb120-119" aria-hidden="true" tabindex="-1"></a><span class="co">#             auc &lt;- auc@y.values[[1]]</span></span>
<span id="cb120-120"><a href="#cb120-120" aria-hidden="true" tabindex="-1"></a><span class="co">#      }</span></span>
<span id="cb120-121"><a href="#cb120-121" aria-hidden="true" tabindex="-1"></a><span class="co">#      # we compute the AUC to each of the fitted models</span></span>
<span id="cb120-122"><a href="#cb120-122" aria-hidden="true" tabindex="-1"></a><span class="co">#      res_list[[j]] = list(auc = apply(result, 2, auc, Y=don_desbois$Y), result = result)</span></span>
<span id="cb120-123"><a href="#cb120-123" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb120-124"><a href="#cb120-124" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb120-125"><a href="#cb120-125" aria-hidden="true" tabindex="-1"></a><span class="co"># # saving/persisting to rds for latter use</span></span>
<span id="cb120-126"><a href="#cb120-126" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(res_list, "res_list.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>res_list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"res_list.rds"</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>res_list[[<span class="dv">1</span>]]<span class="sc">$</span>auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    glm full  glm desbois  forward aic  forward bic backward aic backward bic 
   0.9660621    0.9528649    0.9680022    0.9656887    0.9677953    0.9636553 
       ridge        lasso  elastic-net         cart 
   0.9604689    0.9653506    0.9653380    0.9074932 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>res_list[[<span class="dv">2</span>]]<span class="sc">$</span>auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    glm full  glm desbois  forward aic  forward bic backward aic backward bic 
   0.9673235    0.9530516    0.9672100    0.9634988    0.9680375    0.9640539 
       ridge        lasso  elastic-net         cart 
   0.9598861    0.9655701    0.9655500    0.9016944 </code></pre>
</div>
</div>

</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-hastie2009" class="csl-entry" role="listitem">
Hastie, T., Tibshirani, R., &amp; Friedman, J. (2009). <em>The elements of statistical learning</em>. Springer New York.
</div>
<div id="ref-hosmer2013" class="csl-entry" role="listitem">
Hosmer, D. W., Lemeshow, S., &amp; Sturdivant, R. X. (2013). Applied logistic regression. In <em>Wiley Series in Probability and Statistics</em>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We won’t describe the procedure here. A SPSS script is given in the article. It is not straightforward to reproduce it with R. I tried scripting manually the procedure and it works but is not very interesting.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>